!function(){"use strict";function t(t,e){return t.splice(e,1)[0]}function e(e,i){const n=e.indexOf(i);return n>-1&&(t(e,n),!0)}function i(t,e,i){return typeof t===e||t instanceof i}function n(t){return i(t,"function",Function)}function s(t){return i(t,"string",String)}function a(t){return i(t,"boolean",Boolean)}function o(t){return i(t,"number",Number)}function r(t){return i(t,"object",Object)}function h(t){return t instanceof Array}function A(t){return t instanceof HTMLElement}function c(t){throw new Error("Unexpected object: "+t)}function l(t){return o(t)&&!Number.isNaN(t)}function u(t){return null==t}function d(t,e,i=!0){let n=function(t,e){let i=0,n=t.length,s=Math.floor((i+n)/2),a=!1;for(;i<n&&s<t.length;){const o=t[s];!u(o)&&e<o?n=s:(e===o&&(a=!0),i=s+1),s=Math.floor((i+n)/2)}return a||(s+=.5),s}(t,e);const s=n%1==0;return n|=0,s&&!i||t.splice(n,0,e),n}class g{constructor(){this.listeners=new Map,this.listenerOptions=new Map}addEventListener(t,e,i){if(n(e)){let n=this.listeners.get(t);n||(n=new Array,this.listeners.set(t,n)),n.find((t=>t===e))||(n.push(e),i&&this.listenerOptions.set(e,i))}}removeEventListener(t,e){if(n(e)){const i=this.listeners.get(t);i&&this.removeListener(i,e)}}removeListener(e,i){const n=e.findIndex((t=>t===i));n>=0&&(t(e,n),this.listenerOptions.has(i)&&this.listenerOptions.delete(i))}dispatchEvent(t){const e=this.listeners.get(t.type);if(e)for(const i of e){const n=this.listenerOptions.get(i);n&&n.once&&this.removeListener(e,i),i.call(this,t)}return!t.defaultPrevented}}class p extends Event{constructor(t){super(t)}}class m extends g{constructor(){super(...arguments),this.mappedCallbacks=new Map}addEventListener(t,e,i){let n=this.mappedCallbacks.get(e);null==n&&(n=t=>e(t),this.mappedCallbacks.set(e,n)),super.addEventListener(t,n,i)}removeEventListener(t,e){const i=this.mappedCallbacks.get(e);i&&super.removeEventListener(t,i)}}const f=["change","click","contextmenu","dblclick","mouseup","pointerup","reset","submit","touchend"];function v(){return Promise.resolve()}function w(t){return new Promise((e=>{const i=setInterval((()=>{t()&&(clearInterval(i),e())}),100)}))}class B{constructor(t,e,...i){this.key=t,this.value=e,this.tags=i.map((t=>t.toLocaleUpperCase())),Object.freeze(this)}apply(t){if(A(t)){0===this.tags.length||this.tags.indexOf(t.tagName)>-1?"style"===this.key?Object.assign(t.style,this.value):this.key in t?t[this.key]=this.value:!1===this.value?t.removeAttribute(this.key):!0===this.value?t.setAttribute(this.key,""):t.setAttribute(this.key,this.value):console.warn(`Element ${t.tagName} does not support Attribute ${this.key}`)}else t[this.key]=this.value}}function D(t){return new B("autoplay",t,"audio","video")}function y(t){return new B("className",t)}function C(t){return new B("disabled",t,"button","command","fieldset","input","keygen","optgroup","option","select","textarea")}function b(t){return new B("htmlFor",t,"label","output")}function I(t){return new B("height",t,"canvas","embed","iframe","img","input","object","video")}function P(t){return new B("href",t,"a","area","base","link")}function M(t){return new B("id",t)}function x(t){return new B("max",t,"input","meter","progress")}function E(t){return new B("min",t,"input","meter")}function F(t){return new B("muted",t,"audio","video")}function S(t){return new B("placeholder",t,"input","textarea")}function k(t){return new B("playsInline",t,"audio","video")}function L(t){return new B("src",t,"audio","embed","iframe","img","input","script","source","track","video")}function _(t){return new B("srcObject",t,"audio","video")}function T(t){return new B("step",t,"input")}function O(t){return new B("title",t)}function R(t){return new B("type",t,"button","input","command","embed","object","script","source","style","menu")}function U(t){return new B("value",t,"button","data","input","li","meter","option","progress","param")}function Q(t){return new B("width",t,"canvas","embed","iframe","img","input","object","video")}class N{constructor(...t){this.set=new Map;const e=(t,e)=>{e||a(e)?this.set.set(t,e):this.set.has(t)&&this.set.delete(t)};for(const i of t)if(i instanceof B){const{key:t,value:n}=i;e(t,n)}else for(const[t,n]of i.set.entries())e(t,n)}apply(t){const e=A(t)?t.style:t;for(const t of this.set.entries()){const[i,n]=t;e[i]=n}}}function H(...t){return new N(...t)}function z(t){return new B("backgroundColor",t)}function G(t){return new B("display",t)}function j(t){return new B("fontFamily",t)}function W(t){return new B("margin",t)}function V(t){return new B("zIndex",t)}j("'Droid Sans Mono', 'Consolas', 'Lucida Console', 'Courier New', 'Courier', monospace"),j("-apple-system, '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', sans-serif");function Z(t){return!u(t)&&!s(t)&&!o(t)&&!a(t)&&!function(t){return t instanceof Date}(t)&&"element"in t&&t.element instanceof Node}function Y(t,...e){let i=null;for(const t of e)if(t instanceof B&&"id"===t.key){i=document.getElementById(t.value);break}null==i&&(i=document.createElement(t));for(let t of e)null!=t&&(s(t)||o(t)||a(t)||t instanceof Date||t instanceof Node||Z(t)?(Z(t)?t=t.element:t instanceof Node||(t=document.createTextNode(t.toLocaleString())),i.appendChild(t)):(t instanceof Function&&(t=t(!0)),t.apply(i)));return i}function X(...t){return Y("a",...t)}function J(...t){return Y("audio",...t)}function K(...t){return function(...t){return Y("button",...t)}(...t,R("button"))}function q(...t){return Y("canvas",...t)}function $(...t){return Y("div",...t)}function tt(...t){return Y("h1",...t)}function et(...t){return Y("input",...t)}function it(...t){return Y("label",...t)}function nt(...t){return Y("li",...t)}function st(...t){return Y("option",...t)}function at(...t){return Y("p",...t)}function ot(...t){return Y("span",...t)}function rt(...t){return Y("ul",...t)}function ht(...t){return et(R("text"),...t)}function At(...t){return et(R("url"),...t)}function ct(...t){return $(H(W("auto")),...t)}function lt(t,e){return async i=>{await t(i),await e(i)}}function ut(t,e,i,n){null==n&&l(i)&&(n=i,i=void 0);const a=s(e),o=s(i),r=null!=n;return new Promise(((s,h)=>{if(a){const i=()=>{t.removeEventListener(e,s)};s=lt(i,s),h=lt(i,h)}if(o){const e=()=>{t.removeEventListener(i,h)};s=lt(e,s),h=lt(e,h)}if(r){const t=setTimeout(h,n,`'${e}' has timed out.`),i=()=>clearTimeout(t);s=lt(i,s),h=lt(i,h)}a&&t.addEventListener(e,s),o&&t.addEventListener(i,(()=>{h("Rejection event found")}))}))}const dt=[];function gt(t,e,i,n,s){if(!("window"in globalThis))throw new Error("Cannot open a window from a Worker.");{const a=window.open(t,"_blank",`left=${e},top=${i},width=${n},height=${s}`);a&&dt.push(a)}}"window"in globalThis&&window.addEventListener("unload",(()=>{for(const t of dt)t.close()}));const pt="OffscreenCanvas"in globalThis,mt="createImageBitmap"in globalThis,ft=pt&&function(){try{const t=new OffscreenCanvas(1,1);return null!=t.getContext("2d")}catch(t){return!1}}();const vt=mt&&function(){try{const t=pt?new OffscreenCanvas(1,1):q();return null!=t.getContext("bitmaprenderer")}catch(t){return!1}}()?function(t,e){const i=t.getContext("bitmaprenderer");if(u(i))throw new Error("Could not create bitmaprenderer context for canvas");i.transferFromImageBitmap(e)}:function(t,e){const i=t.getContext("2d");if(u(i))throw new Error("Could not create 2d context for canvas");i.drawImage(e,0,0)};function wt(t,e){return new OffscreenCanvas(t,e)}function Bt(t,e){return q(Q(t),I(e))}const Dt=ft?wt:Bt;const yt=ft?function(t){const e=wt(t.width,t.height);return vt(e,t),e}:function(t){const e=Bt(t.width,t.height);return vt(e,t),e};function Ct(t,e){const i=t.getContext("2d");if(u(i))throw new Error("Could not create 2d context for canvas");i.drawImage(e,0,0)}const bt=ft?function(t){const e=wt(t.width,t.height);return Ct(e,t),e}:function(t){const e=Bt(t.width,t.height);return Ct(e,t),e};function It(t,e,i,n=1){return e=Math.floor(e*n),i=Math.floor(i*n),(t.width!=e||t.height!=i)&&(t.width=e,t.height=i,!0)}function Pt(t,e,i,n=1){return function(t){return function(t){return null!=t.textBaseline}(t)||function(t){return null!=t.textBaseline}(t)}(t)?function(t,e,i,n=1){const s=t.imageSmoothingEnabled,a=t.textBaseline,o=t.textAlign,r=t.font,h=It(t.canvas,e,i,n);return h&&(t.imageSmoothingEnabled=s,t.textBaseline=a,t.textAlign=o,t.font=r),h}(t,e,i,n):It(t.canvas,e,i,n)}"HTMLCanvasElement"in globalThis&&(HTMLCanvasElement.prototype.view=function(){gt(this.toDataURL(),0,0,this.width+10,this.height+100)}),pt&&(OffscreenCanvas.prototype.view=async function(){const t=await this.convertToBlob();gt(URL.createObjectURL(t),0,0,this.width+10,this.height+100)});const Mt=2*Math.PI;function xt(t,e){let i;if(o(e)){i=new Array(e);for(let t=0;t<i.length;++t)i[t]=1/e}else i=e;let n=0;for(let t=0;t<i.length;++t)n+=i[t];const s=new Array(i.length),a=new Array(i.length),r=performance.now(),h=(e,a,o,h)=>{if(t){s[e]=a/o;let A=0;for(let t=0;t<i.length;++t)A+=s[t]*i[t];const c=performance.now();t(A,n,h,r-c+(c-r)*n/A)}};for(let t=0;t<i.length;++t)s[t]=0,a[t]=(e,i,n)=>h(t,e,i,n);return a}async function Et(t,e,i){const n=xt(t,e.length),s=e.map(((t,e)=>i(t,n[e])));return await Promise.all(s)}function Ft(t,e,i){return Math.min(i,Math.max(e,t))}function St(t,e,i,n){const{width:s,height:a,data:o}=t,r=(t,e)=>4*(e*s+t),h=2*i,A=s-1,c=a-1,l=new Array(4),u=new Array(4);return(t,s,a)=>{const d=Math.floor(t),g=Math.floor(s),p=d-i+1,m=g-i+1;for(let e=0;e<h;e++)l[e]=n(t-(p+e)),u[e]=n(s-(m+e));for(let t=0;t<3;t++){let i=0;for(let e=0;e<h;e++){const n=Ft(m+e,0,c);let s=0;for(let e=0;e<h;e++){const i=r(Ft(p+e,0,A),n);s+=o[i+t]*l[e]}i+=s*u[e]}e.data[a+t]=Math.round(i)}}}var kt;!function(t){t.PositiveZ="pz",t.NegativeZ="nz",t.PositiveX="px",t.NegativeX="nx",t.PositiveY="py",t.NegativeY="ny"}(kt||(kt={}));const Lt=[kt.PositiveZ,kt.NegativeZ,kt.PositiveY,kt.NegativeY,kt.NegativeX,kt.PositiveX];var _t;!function(t){t.Bilinear="bilinear",t.Bicubic="bicubic",t.Lanczos="lanczos",t.Nearest="nearest"}(_t||(_t={}));const Tt=new Map;Tt.set(kt.PositiveY,3),Tt.set(kt.NegativeY,1);const Ot=new Map([[kt.PositiveZ,(t,e)=>({x:-1,y:-t,z:-e})],[kt.NegativeZ,(t,e)=>({x:1,y:t,z:-e})],[kt.PositiveX,(t,e)=>({x:t,y:-1,z:-e})],[kt.NegativeX,(t,e)=>({x:-t,y:1,z:-e})],[kt.PositiveY,(t,e)=>({x:-e,y:-t,z:1})],[kt.NegativeY,(t,e)=>({x:e,y:-t,z:-1})]]),Rt=new Map([[_t.Bilinear,function(t,e){const{width:i,height:n,data:s}=t,a=(t,e)=>4*(e*i+t);return(t,o,r)=>{const h=Ft(Math.floor(t),0,i-1),A=Ft(Math.ceil(t),0,i-1),c=t-h,l=Ft(Math.floor(o),0,n-1),u=Ft(Math.ceil(o),0,n-1),d=o-l,g=a(h,l),p=a(A,l),m=a(h,u),f=a(A,u);for(let t=0;t<3;t++){const i=s[g+t]*(1-c)+s[p+t]*c,n=s[m+t]*(1-c)+s[f+t]*c;e.data[r+t]=Math.ceil(i*(1-d)+n*d)}}}],[_t.Bicubic,function(t,e){const i=-.5;return St(t,e,2,(t=>{const e=(t=Math.abs(t))*t,n=t*t*t;return t<=1?1.5*n-2.5*e+1:i*n-5*i*e+-4*t- -2}))}],[_t.Lanczos,function(t,e){return St(t,e,5,(t=>{if(0===t)return 1;{const e=Math.PI*t;return 5*Math.sin(e)*Math.sin(e/5)/(e*e)}}))}],[_t.Nearest,function(t,e){const{width:i,height:n,data:s}=t;return(t,a,o)=>{const r=(h=Ft(Math.round(t),0,i-1),4*(Ft(Math.round(a),0,n-1)*i+h));var h;for(let t=0;t<3;t++)e.data[o+t]=s[r+t]}}]]);async function Ut(t,e,i,s,a){const o=Ot.get(e);if(!o)throw new Error("Invalid face name: "+e);const r=Rt.get(i);if(!r)throw new Error("Invalid interpolation type: "+i);const h=Math.min(s||Number.MAX_VALUE,t.width/2),A=h,c=new ImageData(h,A);Rt.has(i)||(i=_t.Nearest);const l=r(t,c);for(let i=0;i<A;i++){n(a)&&a(i,A,e);for(let e=0;e<h;e++){const n=4*(i*h+e);c.data[n+3]=255;const s=o(2*(e+.5)/h-1,2*(i+.5)/A-1),a=Math.sqrt(s.x*s.x+s.y*s.y+s.z*s.z),r=(Math.atan2(s.y,s.x)%Mt+Mt)%Mt,u=Math.acos(s.z/a);l(t.width*r/Math.PI/2-.5,t.height*u/Math.PI-.5,n)}}const u=Dt(h,A),d=u.getContext("2d");if(!d)throw new Error("Couldn't create a 2D canvas context");if(d.putImageData(c,0,0),Tt.has(e)){const t=Tt.get(e),i=h/2,n=A/2;d.translate(i,n),d.rotate(t*Math.PI/2),d.translate(-i,-n),d.drawImage(u,0,0)}return n(a)&&a(A,A,e),u}async function Qt(t,e,i,n,s){const a=await Ut(t,e,i,n,s);return await createImageBitmap(a)}function Nt(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function Ht(t,e,i,n,s,a,o,r){const h=Dt(a,o),A=h.getContext("2d");if(!A)throw new Error("Couldn't create a 2D canvas context");const c=a/2,l=o/2;return r>0&&(r%2==0?A.translate(c,l):A.translate(l,c),A.rotate(r*Math.PI/2),A.translate(-c,-l)),A.drawImage(t,e,i,n,s,0,0,a,o),h}var zt;!function(t){t[t.None=-1]="None",t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Up=2]="Up",t[t.Down=3]="Down",t[t.Back=4]="Back",t[t.Front=5]="Front"}(zt||(zt={}));const Gt={rows:3,columns:4,indices:[[zt.None,zt.Up,zt.None,zt.None],[zt.Left,zt.Front,zt.Right,zt.Back],[zt.None,zt.Down,zt.None,zt.None]],rotations:[[0,2,0,0],[0,0,0,0],[0,2,0,0]]};function jt(t){const e=t.width/Gt.columns,i=t.height/Gt.rows,n=Nt(e),s=Nt(i),a=new Array(6);for(let o=0;o<Gt.rows;++o){const r=Gt.indices[o],h=Gt.rotations[o];for(let A=0;A<Gt.columns;++A){const c=r[A];c>-1&&(a[c]=Ht(t,A*e,o*i,e,i,n,s,h[A]))}}return a}function Wt(t){const e=function(...t){return Y("script",...t)}(L(t));document.body.appendChild(e)}function Vt(t){var e;r(e=t)&&"dispose"in e&&n(e.dispose)?t.dispose():function(t){return r(t)&&"close"in t&&n(t.close)}(t)&&t.close()}function Zt(t,e){try{return e(t)}finally{Vt(t)}}class Yt{constructor(){this._getCanvas=mt?this.getCanvasViaImageBitmap:this.getCanvasViaImage,this._getImageData=mt?this.getImageDataViaImageBitmap:this.getImageDataViaImage,this._getCubes=mt?this.getCubesViaImageBitmaps:this.getCubesViaImage,this._getEquiMaps=mt?this.getEquiMapViaImageBitmaps:this.getEquiMapViaImage}async getCanvas(t,e){return await this._getCanvas(t,e)}async getImageData(t,e){return await this._getImageData(t,e)}async getCubes(t,e){return await this._getCubes(t,e)}async getEquiMaps(t,e,i,n){return await this._getEquiMaps(t,e,i,n)}async readRequestResponse(t,e){const i=await e;if(!i.ok)throw new Error(`[${i.status}] - ${i.statusText}. Path ${t}`);return i}async getResponse(t){return await this.readRequestResponse(t,fetch(t))}async postObjectForResponse(t,e){return await this.readRequestResponse(t,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}))}async readResponseBuffer(t,e,i){const n=e.headers.get("Content-Type");if(!n)throw new Error("Server did not provide a content type");let s=1;const a=e.headers.get("Content-Length");a?(s=parseInt(a,10),l(s)||(console.warn(`Server did not provide a valid content length header. Value: ${a}, Path: ${t}`),s=1)):console.warn(`Server did not provide a content length header. Path: ${t}`);if(l(s)||(s=1),!e.body)throw new Error("No response body!");const o=e.body.getReader(),r=[];let h=0;for(;;){const{done:e,value:n}=await o.read();if(e)break;n&&(r.push(n),h+=n.length,i&&i(h,Math.max(h,s),t))}const A=new ArrayBuffer(h),c=new Uint8Array(A);h=0;for(const t of r)c.set(t,h),h+=t.length;return i&&i(1,1,t),{buffer:A,contentType:n}}async getBuffer(t,e){const i=await this.getResponse(t);return await this.readResponseBuffer(t,i,e)}async postObjectForBuffer(t,e,i){const n=await this.postObjectForResponse(t,e);return await this.readResponseBuffer(t,n,i)}async getBlob(t,e){const{buffer:i,contentType:n}=await this.getBuffer(t,e);return new Blob([i],{type:n})}async postObjectForBlob(t,e,i){const{buffer:n,contentType:s}=await this.postObjectForBuffer(t,e,i);return new Blob([n],{type:s})}async getFile(t,e){const i=await this.getBlob(t,e);return URL.createObjectURL(i)}async postObjectForFile(t,e,i){const n=await this.postObjectForBlob(t,e,i);return URL.createObjectURL(n)}async readFileImage(t){const e=new Image;return e.src=t,e.complete||await ut(e,"load","error"),e}async getImageBitmap(t,e){const i=await this.getBlob(t,e);return await createImageBitmap(i)}async getImage(t,e){const i=await this.getFile(t,e);return await this.readFileImage(i)}async postObjectForImageBitmap(t,e,i){const n=await this.postObjectForBlob(t,e,i);return await createImageBitmap(n)}async postObjectForImage(t,e,i){const n=await this.postObjectForFile(t,e,i);return await this.readFileImage(n)}async getCanvasViaImageBitmap(t,e){return Zt(await this.getImageBitmap(t,e),(t=>yt(t)))}async getCanvasViaImage(t,e){const i=await this.getImage(t,e);return bt(i)}readImageData(t){const e=Dt(t.width,t.height),i=e.getContext("2d");if(!i)throw new Error("Couldn't create a 2D canvas context");return i.drawImage(t,0,0),i.getImageData(0,0,e.width,e.height)}async getImageDataViaImageBitmap(t,e){return Zt(await this.getImageBitmap(t,e),(t=>this.readImageData(t)))}async getImageDataViaImage(t,e){const i=await this.getImage(t,e);return this.readImageData(i)}async getCubesViaImageBitmaps(t,e){const i=jt(await this.getImageBitmap(t,e));return await Promise.all(i.map((t=>createImageBitmap(t))))}async getCubesViaImage(t,e){return jt(await this.getImage(t,e))}async getEquiMapViaImageBitmaps(t,e,i,n){const s=xt(n,[1,6]),a=await this.getImageDataViaImageBitmap(t,s.shift());return await async function(t,e,i,n,s){return await Et(s,Lt,((s,a)=>t(e,s,i,n,a)))}(Qt,a,e,i,s.shift())}async getEquiMapViaImage(t,e,i,n){const s=xt(n,[1,6]),a=await this.getImageDataViaImage(t,s.shift());return await async function(t,e,i,n,s){return await Et(s,Lt,((s,a)=>t(e,s,i,n,a)))}(Ut,a,e,i,s.shift())}readBufferText(t){return new TextDecoder("utf-8").decode(t)}async getText(t,e){const{buffer:i}=await this.getBuffer(t,e);return this.readBufferText(i)}async postObjectForText(t,e,i){const{buffer:n}=await this.postObjectForBuffer(t,e,i);return this.readBufferText(n)}async getObject(t,e){const i=await this.getText(t,e);return JSON.parse(i)}async postObjectForObject(t,e,i){const n=await this.postObjectForText(t,e,i);return JSON.parse(n)}async postObject(t,e){await this.postObjectForResponse(t,e)}readTextXml(t){return(new DOMParser).parseFromString(t,"text/xml").documentElement}async getXml(t,e){const i=await this.getText(t,e);return this.readTextXml(i)}async postObjectForXml(t,e,i){const n=await this.postObjectForText(t,e,i);return this.readTextXml(n)}async loadScript(t,e,i){if(e())i&&i(1,1,"skip");else{const n=w(e);Wt(await this.getFile(t,i)),await n}}async renderImageBitmapFace(t,e,i,n,s){return await Qt(t,e,i,n,s)}}class Xt extends Event{constructor(){super("audioActivity"),this.id=null,this.isActive=!1,Object.seal(this)}set(t,e){this.id=t,this.isActive=e}}function Jt(t){return t.splice(0)}class Kt{constructor(t){this.audioContext=t,this.gain=null,this.minDistance=1,this.maxDistance=10,this.rolloff=1,this.algorithm="logarithmic",this.transitionTime=.1,this.gain=t.createGain()}setAudioProperties(t,e,i,n,s){this.minDistance=t,this.maxDistance=e,this.rolloff=i,this.algorithm=n,this.transitionTime=s}dispose(){this.gain&&(this.gain.disconnect(),this.gain=null)}get volume(){return this.gain.gain.value}set volume(t){this.gain.gain.value=t}play(){return Promise.resolve()}stop(){}}class qt extends Kt{constructor(t,e,i){super(i),this.id=t,this.source=e,this.source instanceof AudioBufferSourceNode?this.playingSources=new Array:this.source.connect(this.gain)}dispose(){this.source&&(this.source.disconnect(),this.source=null),super.dispose()}get isPlaying(){return this.playingSources.length>0}async play(){if(this.source instanceof AudioBufferSourceNode){const t=this.source.context.createBufferSource();this.playingSources.push(t),t.buffer=this.source.buffer,t.loop=this.source.loop,t.connect(this.gain),t.start(),this.source.loop||(await ut(t,"ended"),this.playingSources.indexOf(t)>=0&&(t.stop(),t.disconnect(this.gain),e(this.playingSources,t)))}}stop(){if(this.source instanceof AudioBufferSourceNode){for(const t of this.playingSources)t.stop(),t.disconnect(this.gain);Jt(this.playingSources)}}}const $t=new Xt;function te(t,e,i){const n=e/2;return Ft(Math.round(t/n*i),0,i)}class ee extends m{constructor(t,e,i){if(super(),this.wasActive=!1,this.analyser=null,!l(i)||i<=0)throw new Error("Buffer size must be greater than 0");this.id=t.id,this.bufferSize=i,this.buffer=new Float32Array(this.bufferSize),this.wasActive=!1,this.activityCounter=0;const n=()=>{t.spatializer instanceof qt&&t.spatializer.source?(this.analyser=e.createAnalyser(),this.analyser.fftSize=2*this.bufferSize,this.analyser.smoothingTimeConstant=.2,t.spatializer.source.connect(this.analyser)):setTimeout(n,0)};n()}dispose(){this.analyser&&(this.analyser.disconnect(),this.analyser=null),this.buffer=null}update(){if(this.analyser){this.analyser.getFloatFrequencyData(this.buffer);const t=1.1+function(t,e,i,n,s){const a=t.context.sampleRate,o=te(i,a,s),r=te(n,a,s),h=r-o;let A=0;for(let t=o;t<r;++t)A+=e[t];return 0===h?0:A/h}(this.analyser,this.buffer,85,255,this.bufferSize)/100;t>=.5&&this.activityCounter<60?this.activityCounter++:t<.5&&this.activityCounter>0&&this.activityCounter--;const e=this.activityCounter>5;this.wasActive!==e&&(this.wasActive=e,$t.id=this.id,$t.isActive=e,this.dispatchEvent($t))}}}var ie="undefined"!=typeof Float32Array?Float32Array:Array;function ne(){var t=new ie(9);return ie!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function se(t,e,i,n,s,a,o,r,h,A){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=a,t[5]=o,t[6]=r,t[7]=h,t[8]=A,t}function ae(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function oe(){var t=new ie(16);return ie!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function re(t,e,i,n,s,a,o,r,h,A,c,l,u,d,g,p,m){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=a,t[5]=o,t[6]=r,t[7]=h,t[8]=A,t[9]=c,t[10]=l,t[11]=u,t[12]=d,t[13]=g,t[14]=p,t[15]=m,t}function he(){var t=new ie(3);return ie!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Ae(t){var e=t[0],i=t[1],n=t[2];return Math.hypot(e,i,n)}function ce(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function le(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t}function ue(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function de(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function ge(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function pe(t,e){var i=e[0],n=e[1],s=e[2],a=i*i+n*n+s*s;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function me(t,e,i){var n=e[0],s=e[1],a=e[2],o=i[0],r=i[1],h=i[2];return t[0]=s*h-a*r,t[1]=a*o-n*h,t[2]=n*r-s*o,t}function fe(t,e,i,n){var s=e[0],a=e[1],o=e[2];return t[0]=s+n*(i[0]-s),t[1]=a+n*(i[1]-a),t[2]=o+n*(i[2]-o),t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ve,we=de;ve=he();function Be(t,e,i){const n=i-e;return 0===n?0:(t-e)/n}class De{constructor(){this.t=0,this.p=he(),this.f=le(he(),0,0,-1),this.u=le(he(),0,1,0),Object.seal(this)}set(t,e,i,n,s,a,o,r,h){le(this.p,t,e,i),le(this.f,n,s,a),le(this.u,o,r,h)}copy(t){ce(this.p,t.p),ce(this.f,t.f),ce(this.u,t.u)}interpolate(t,e,i){if(i<=t.t)this.copy(t);else if(e.t<=i)this.copy(e);else if(t.t<i){const n=Be(i,t.t,e.t);this.copy(t),fe(this.p,this.p,e.p,n),fe(this.f,this.f,e.f,n),fe(this.u,this.u,e.u,n),pe(this.f,this.f),pe(this.u,this.u),this.t=i}}}const ye=he();class Ce{constructor(){this.start=new De,this.current=new De,this.end=new De,this.offset=he()}setOffset(t,e,i){le(ye,t,e,i),we(ye,ye,this.offset),ue(this.start.p,this.start.p,ye),ue(this.current.p,this.current.p,ye),ue(this.end.p,this.end.p,ye),ge(this.start.f,this.start.f,2),ue(this.start.f,this.start.f,ye),pe(this.start.f,this.start.f),ge(this.current.f,this.current.f,2),ue(this.current.f,this.current.f,ye),pe(this.current.f,this.current.f),ge(this.end.f,this.end.f,2),ue(this.end.f,this.end.f,ye),pe(this.end.f,this.end.f),le(this.offset,t,e,i)}setTarget(t,e,i,n,s,a,o,r,h,A,c){const l=this.offset[0],u=this.offset[1],d=this.offset[2];this.end.set(t+l,e+u,i+d,n,s,a,o,r,h),this.end.t=A+c,c>0?(this.start.copy(this.current),this.start.t=A):(this.start.copy(this.end),this.start.t=A,this.current.copy(this.end),this.current.t=A)}setTargetPosition(t,e,i,n,s){this.setTarget(t,e,i,this.end.f[0],this.end.f[1],this.end.f[2],this.end.u[0],this.end.u[1],this.end.u[2],n,s)}setTargetOrientation(t,e,i,n,s,a,o,r){this.setTarget(this.end.p[0],this.end.p[1],this.end.p[2],t,e,i,n,s,a,o,r)}update(t){this.current.interpolate(this.start,this.end,t)}}class be{constructor(t){this.id=t,this.pose=new Ce,this.streams=new Map,this._spatializer=null}get spatializer(){return this._spatializer}set spatializer(t){this.spatializer!==t&&(this._spatializer&&this._spatializer.dispose(),this._spatializer=t)}dispose(){this.spatializer=null}update(t){this.pose.update(t),this.spatializer&&this.spatializer.update(this.pose.current,t)}}const Ie=n(HTMLAudioElement.prototype.setSinkId);var Pe;!function(t){t.Ambisonic="ambisonic",t.Bypass="bypass",t.None="off"}(Pe||(Pe={}));const Me=[[[0,0,0,1,1,1],[.052336,.034899,.017452,.999848,.999391,.99863],[.104528,.069756,.034899,.999391,.997564,.994522],[.156434,.104528,.052336,.99863,.994522,.987688],[.207912,.139173,.069756,.997564,.990268,.978148],[.258819,.173648,.087156,.996195,.984808,.965926],[.309017,.207912,.104528,.994522,.978148,.951057],[.358368,.241922,.121869,.992546,.970296,.93358],[.406737,.275637,.139173,.990268,.961262,.913545],[.45399,.309017,.156434,.987688,.951057,.891007],[.5,.34202,.173648,.984808,.939693,.866025],[.544639,.374607,.190809,.981627,.927184,.838671],[.587785,.406737,.207912,.978148,.913545,.809017],[.62932,.438371,.224951,.97437,.898794,.777146],[.669131,.469472,.241922,.970296,.882948,.743145],[.707107,.5,.258819,.965926,.866025,.707107],[.743145,.529919,.275637,.961262,.848048,.669131],[.777146,.559193,.292372,.956305,.829038,.62932],[.809017,.587785,.309017,.951057,.809017,.587785],[.838671,.615661,.325568,.945519,.788011,.544639],[.866025,.642788,.34202,.939693,.766044,.5],[.891007,.669131,.358368,.93358,.743145,.45399],[.913545,.694658,.374607,.927184,.71934,.406737],[.93358,.71934,.390731,.920505,.694658,.358368],[.951057,.743145,.406737,.913545,.669131,.309017],[.965926,.766044,.422618,.906308,.642788,.258819],[.978148,.788011,.438371,.898794,.615661,.207912],[.987688,.809017,.45399,.891007,.587785,.156434],[.994522,.829038,.469472,.882948,.559193,.104528],[.99863,.848048,.48481,.87462,.529919,.052336],[1,.866025,.5,.866025,.5,0],[.99863,.882948,.515038,.857167,.469472,-.052336],[.994522,.898794,.529919,.848048,.438371,-.104528],[.987688,.913545,.544639,.838671,.406737,-.156434],[.978148,.927184,.559193,.829038,.374607,-.207912],[.965926,.939693,.573576,.819152,.34202,-.258819],[.951057,.951057,.587785,.809017,.309017,-.309017],[.93358,.961262,.601815,.798636,.275637,-.358368],[.913545,.970296,.615661,.788011,.241922,-.406737],[.891007,.978148,.62932,.777146,.207912,-.45399],[.866025,.984808,.642788,.766044,.173648,-.5],[.838671,.990268,.656059,.75471,.139173,-.544639],[.809017,.994522,.669131,.743145,.104528,-.587785],[.777146,.997564,.681998,.731354,.069756,-.62932],[.743145,.999391,.694658,.71934,.034899,-.669131],[.707107,1,.707107,.707107,0,-.707107],[.669131,.999391,.71934,.694658,-.034899,-.743145],[.62932,.997564,.731354,.681998,-.069756,-.777146],[.587785,.994522,.743145,.669131,-.104528,-.809017],[.544639,.990268,.75471,.656059,-.139173,-.838671],[.5,.984808,.766044,.642788,-.173648,-.866025],[.45399,.978148,.777146,.62932,-.207912,-.891007],[.406737,.970296,.788011,.615661,-.241922,-.913545],[.358368,.961262,.798636,.601815,-.275637,-.93358],[.309017,.951057,.809017,.587785,-.309017,-.951057],[.258819,.939693,.819152,.573576,-.34202,-.965926],[.207912,.927184,.829038,.559193,-.374607,-.978148],[.156434,.913545,.838671,.544639,-.406737,-.987688],[.104528,.898794,.848048,.529919,-.438371,-.994522],[.052336,.882948,.857167,.515038,-.469472,-.99863],[0,.866025,.866025,.5,-.5,-1],[-.052336,.848048,.87462,.48481,-.529919,-.99863],[-.104528,.829038,.882948,.469472,-.559193,-.994522],[-.156434,.809017,.891007,.45399,-.587785,-.987688],[-.207912,.788011,.898794,.438371,-.615661,-.978148],[-.258819,.766044,.906308,.422618,-.642788,-.965926],[-.309017,.743145,.913545,.406737,-.669131,-.951057],[-.358368,.71934,.920505,.390731,-.694658,-.93358],[-.406737,.694658,.927184,.374607,-.71934,-.913545],[-.45399,.669131,.93358,.358368,-.743145,-.891007],[-.5,.642788,.939693,.34202,-.766044,-.866025],[-.544639,.615661,.945519,.325568,-.788011,-.838671],[-.587785,.587785,.951057,.309017,-.809017,-.809017],[-.62932,.559193,.956305,.292372,-.829038,-.777146],[-.669131,.529919,.961262,.275637,-.848048,-.743145],[-.707107,.5,.965926,.258819,-.866025,-.707107],[-.743145,.469472,.970296,.241922,-.882948,-.669131],[-.777146,.438371,.97437,.224951,-.898794,-.62932],[-.809017,.406737,.978148,.207912,-.913545,-.587785],[-.838671,.374607,.981627,.190809,-.927184,-.544639],[-.866025,.34202,.984808,.173648,-.939693,-.5],[-.891007,.309017,.987688,.156434,-.951057,-.45399],[-.913545,.275637,.990268,.139173,-.961262,-.406737],[-.93358,.241922,.992546,.121869,-.970296,-.358368],[-.951057,.207912,.994522,.104528,-.978148,-.309017],[-.965926,.173648,.996195,.087156,-.984808,-.258819],[-.978148,.139173,.997564,.069756,-.990268,-.207912],[-.987688,.104528,.99863,.052336,-.994522,-.156434],[-.994522,.069756,.999391,.034899,-.997564,-.104528],[-.99863,.034899,.999848,.017452,-.999391,-.052336],[-1,0,1,0,-1,-0],[-.99863,-.034899,.999848,-.017452,-.999391,.052336],[-.994522,-.069756,.999391,-.034899,-.997564,.104528],[-.987688,-.104528,.99863,-.052336,-.994522,.156434],[-.978148,-.139173,.997564,-.069756,-.990268,.207912],[-.965926,-.173648,.996195,-.087156,-.984808,.258819],[-.951057,-.207912,.994522,-.104528,-.978148,.309017],[-.93358,-.241922,.992546,-.121869,-.970296,.358368],[-.913545,-.275637,.990268,-.139173,-.961262,.406737],[-.891007,-.309017,.987688,-.156434,-.951057,.45399],[-.866025,-.34202,.984808,-.173648,-.939693,.5],[-.838671,-.374607,.981627,-.190809,-.927184,.544639],[-.809017,-.406737,.978148,-.207912,-.913545,.587785],[-.777146,-.438371,.97437,-.224951,-.898794,.62932],[-.743145,-.469472,.970296,-.241922,-.882948,.669131],[-.707107,-.5,.965926,-.258819,-.866025,.707107],[-.669131,-.529919,.961262,-.275637,-.848048,.743145],[-.62932,-.559193,.956305,-.292372,-.829038,.777146],[-.587785,-.587785,.951057,-.309017,-.809017,.809017],[-.544639,-.615661,.945519,-.325568,-.788011,.838671],[-.5,-.642788,.939693,-.34202,-.766044,.866025],[-.45399,-.669131,.93358,-.358368,-.743145,.891007],[-.406737,-.694658,.927184,-.374607,-.71934,.913545],[-.358368,-.71934,.920505,-.390731,-.694658,.93358],[-.309017,-.743145,.913545,-.406737,-.669131,.951057],[-.258819,-.766044,.906308,-.422618,-.642788,.965926],[-.207912,-.788011,.898794,-.438371,-.615661,.978148],[-.156434,-.809017,.891007,-.45399,-.587785,.987688],[-.104528,-.829038,.882948,-.469472,-.559193,.994522],[-.052336,-.848048,.87462,-.48481,-.529919,.99863],[-0,-.866025,.866025,-.5,-.5,1],[.052336,-.882948,.857167,-.515038,-.469472,.99863],[.104528,-.898794,.848048,-.529919,-.438371,.994522],[.156434,-.913545,.838671,-.544639,-.406737,.987688],[.207912,-.927184,.829038,-.559193,-.374607,.978148],[.258819,-.939693,.819152,-.573576,-.34202,.965926],[.309017,-.951057,.809017,-.587785,-.309017,.951057],[.358368,-.961262,.798636,-.601815,-.275637,.93358],[.406737,-.970296,.788011,-.615661,-.241922,.913545],[.45399,-.978148,.777146,-.62932,-.207912,.891007],[.5,-.984808,.766044,-.642788,-.173648,.866025],[.544639,-.990268,.75471,-.656059,-.139173,.838671],[.587785,-.994522,.743145,-.669131,-.104528,.809017],[.62932,-.997564,.731354,-.681998,-.069756,.777146],[.669131,-.999391,.71934,-.694658,-.034899,.743145],[.707107,-1,.707107,-.707107,-0,.707107],[.743145,-.999391,.694658,-.71934,.034899,.669131],[.777146,-.997564,.681998,-.731354,.069756,.62932],[.809017,-.994522,.669131,-.743145,.104528,.587785],[.838671,-.990268,.656059,-.75471,.139173,.544639],[.866025,-.984808,.642788,-.766044,.173648,.5],[.891007,-.978148,.62932,-.777146,.207912,.45399],[.913545,-.970296,.615661,-.788011,.241922,.406737],[.93358,-.961262,.601815,-.798636,.275637,.358368],[.951057,-.951057,.587785,-.809017,.309017,.309017],[.965926,-.939693,.573576,-.819152,.34202,.258819],[.978148,-.927184,.559193,-.829038,.374607,.207912],[.987688,-.913545,.544639,-.838671,.406737,.156434],[.994522,-.898794,.529919,-.848048,.438371,.104528],[.99863,-.882948,.515038,-.857167,.469472,.052336],[1,-.866025,.5,-.866025,.5,0],[.99863,-.848048,.48481,-.87462,.529919,-.052336],[.994522,-.829038,.469472,-.882948,.559193,-.104528],[.987688,-.809017,.45399,-.891007,.587785,-.156434],[.978148,-.788011,.438371,-.898794,.615661,-.207912],[.965926,-.766044,.422618,-.906308,.642788,-.258819],[.951057,-.743145,.406737,-.913545,.669131,-.309017],[.93358,-.71934,.390731,-.920505,.694658,-.358368],[.913545,-.694658,.374607,-.927184,.71934,-.406737],[.891007,-.669131,.358368,-.93358,.743145,-.45399],[.866025,-.642788,.34202,-.939693,.766044,-.5],[.838671,-.615661,.325568,-.945519,.788011,-.544639],[.809017,-.587785,.309017,-.951057,.809017,-.587785],[.777146,-.559193,.292372,-.956305,.829038,-.62932],[.743145,-.529919,.275637,-.961262,.848048,-.669131],[.707107,-.5,.258819,-.965926,.866025,-.707107],[.669131,-.469472,.241922,-.970296,.882948,-.743145],[.62932,-.438371,.224951,-.97437,.898794,-.777146],[.587785,-.406737,.207912,-.978148,.913545,-.809017],[.544639,-.374607,.190809,-.981627,.927184,-.838671],[.5,-.34202,.173648,-.984808,.939693,-.866025],[.45399,-.309017,.156434,-.987688,.951057,-.891007],[.406737,-.275637,.139173,-.990268,.961262,-.913545],[.358368,-.241922,.121869,-.992546,.970296,-.93358],[.309017,-.207912,.104528,-.994522,.978148,-.951057],[.258819,-.173648,.087156,-.996195,.984808,-.965926],[.207912,-.139173,.069756,-.997564,.990268,-.978148],[.156434,-.104528,.052336,-.99863,.994522,-.987688],[.104528,-.069756,.034899,-.999391,.997564,-.994522],[.052336,-.034899,.017452,-.999848,.999391,-.99863],[0,-0,0,-1,1,-1],[-.052336,.034899,-.017452,-.999848,.999391,-.99863],[-.104528,.069756,-.034899,-.999391,.997564,-.994522],[-.156434,.104528,-.052336,-.99863,.994522,-.987688],[-.207912,.139173,-.069756,-.997564,.990268,-.978148],[-.258819,.173648,-.087156,-.996195,.984808,-.965926],[-.309017,.207912,-.104528,-.994522,.978148,-.951057],[-.358368,.241922,-.121869,-.992546,.970296,-.93358],[-.406737,.275637,-.139173,-.990268,.961262,-.913545],[-.45399,.309017,-.156434,-.987688,.951057,-.891007],[-.5,.34202,-.173648,-.984808,.939693,-.866025],[-.544639,.374607,-.190809,-.981627,.927184,-.838671],[-.587785,.406737,-.207912,-.978148,.913545,-.809017],[-.62932,.438371,-.224951,-.97437,.898794,-.777146],[-.669131,.469472,-.241922,-.970296,.882948,-.743145],[-.707107,.5,-.258819,-.965926,.866025,-.707107],[-.743145,.529919,-.275637,-.961262,.848048,-.669131],[-.777146,.559193,-.292372,-.956305,.829038,-.62932],[-.809017,.587785,-.309017,-.951057,.809017,-.587785],[-.838671,.615661,-.325568,-.945519,.788011,-.544639],[-.866025,.642788,-.34202,-.939693,.766044,-.5],[-.891007,.669131,-.358368,-.93358,.743145,-.45399],[-.913545,.694658,-.374607,-.927184,.71934,-.406737],[-.93358,.71934,-.390731,-.920505,.694658,-.358368],[-.951057,.743145,-.406737,-.913545,.669131,-.309017],[-.965926,.766044,-.422618,-.906308,.642788,-.258819],[-.978148,.788011,-.438371,-.898794,.615661,-.207912],[-.987688,.809017,-.45399,-.891007,.587785,-.156434],[-.994522,.829038,-.469472,-.882948,.559193,-.104528],[-.99863,.848048,-.48481,-.87462,.529919,-.052336],[-1,.866025,-.5,-.866025,.5,0],[-.99863,.882948,-.515038,-.857167,.469472,.052336],[-.994522,.898794,-.529919,-.848048,.438371,.104528],[-.987688,.913545,-.544639,-.838671,.406737,.156434],[-.978148,.927184,-.559193,-.829038,.374607,.207912],[-.965926,.939693,-.573576,-.819152,.34202,.258819],[-.951057,.951057,-.587785,-.809017,.309017,.309017],[-.93358,.961262,-.601815,-.798636,.275637,.358368],[-.913545,.970296,-.615661,-.788011,.241922,.406737],[-.891007,.978148,-.62932,-.777146,.207912,.45399],[-.866025,.984808,-.642788,-.766044,.173648,.5],[-.838671,.990268,-.656059,-.75471,.139173,.544639],[-.809017,.994522,-.669131,-.743145,.104528,.587785],[-.777146,.997564,-.681998,-.731354,.069756,.62932],[-.743145,.999391,-.694658,-.71934,.034899,.669131],[-.707107,1,-.707107,-.707107,0,.707107],[-.669131,.999391,-.71934,-.694658,-.034899,.743145],[-.62932,.997564,-.731354,-.681998,-.069756,.777146],[-.587785,.994522,-.743145,-.669131,-.104528,.809017],[-.544639,.990268,-.75471,-.656059,-.139173,.838671],[-.5,.984808,-.766044,-.642788,-.173648,.866025],[-.45399,.978148,-.777146,-.62932,-.207912,.891007],[-.406737,.970296,-.788011,-.615661,-.241922,.913545],[-.358368,.961262,-.798636,-.601815,-.275637,.93358],[-.309017,.951057,-.809017,-.587785,-.309017,.951057],[-.258819,.939693,-.819152,-.573576,-.34202,.965926],[-.207912,.927184,-.829038,-.559193,-.374607,.978148],[-.156434,.913545,-.838671,-.544639,-.406737,.987688],[-.104528,.898794,-.848048,-.529919,-.438371,.994522],[-.052336,.882948,-.857167,-.515038,-.469472,.99863],[-0,.866025,-.866025,-.5,-.5,1],[.052336,.848048,-.87462,-.48481,-.529919,.99863],[.104528,.829038,-.882948,-.469472,-.559193,.994522],[.156434,.809017,-.891007,-.45399,-.587785,.987688],[.207912,.788011,-.898794,-.438371,-.615661,.978148],[.258819,.766044,-.906308,-.422618,-.642788,.965926],[.309017,.743145,-.913545,-.406737,-.669131,.951057],[.358368,.71934,-.920505,-.390731,-.694658,.93358],[.406737,.694658,-.927184,-.374607,-.71934,.913545],[.45399,.669131,-.93358,-.358368,-.743145,.891007],[.5,.642788,-.939693,-.34202,-.766044,.866025],[.544639,.615661,-.945519,-.325568,-.788011,.838671],[.587785,.587785,-.951057,-.309017,-.809017,.809017],[.62932,.559193,-.956305,-.292372,-.829038,.777146],[.669131,.529919,-.961262,-.275637,-.848048,.743145],[.707107,.5,-.965926,-.258819,-.866025,.707107],[.743145,.469472,-.970296,-.241922,-.882948,.669131],[.777146,.438371,-.97437,-.224951,-.898794,.62932],[.809017,.406737,-.978148,-.207912,-.913545,.587785],[.838671,.374607,-.981627,-.190809,-.927184,.544639],[.866025,.34202,-.984808,-.173648,-.939693,.5],[.891007,.309017,-.987688,-.156434,-.951057,.45399],[.913545,.275637,-.990268,-.139173,-.961262,.406737],[.93358,.241922,-.992546,-.121869,-.970296,.358368],[.951057,.207912,-.994522,-.104528,-.978148,.309017],[.965926,.173648,-.996195,-.087156,-.984808,.258819],[.978148,.139173,-.997564,-.069756,-.990268,.207912],[.987688,.104528,-.99863,-.052336,-.994522,.156434],[.994522,.069756,-.999391,-.034899,-.997564,.104528],[.99863,.034899,-.999848,-.017452,-.999391,.052336],[1,0,-1,-0,-1,0],[.99863,-.034899,-.999848,.017452,-.999391,-.052336],[.994522,-.069756,-.999391,.034899,-.997564,-.104528],[.987688,-.104528,-.99863,.052336,-.994522,-.156434],[.978148,-.139173,-.997564,.069756,-.990268,-.207912],[.965926,-.173648,-.996195,.087156,-.984808,-.258819],[.951057,-.207912,-.994522,.104528,-.978148,-.309017],[.93358,-.241922,-.992546,.121869,-.970296,-.358368],[.913545,-.275637,-.990268,.139173,-.961262,-.406737],[.891007,-.309017,-.987688,.156434,-.951057,-.45399],[.866025,-.34202,-.984808,.173648,-.939693,-.5],[.838671,-.374607,-.981627,.190809,-.927184,-.544639],[.809017,-.406737,-.978148,.207912,-.913545,-.587785],[.777146,-.438371,-.97437,.224951,-.898794,-.62932],[.743145,-.469472,-.970296,.241922,-.882948,-.669131],[.707107,-.5,-.965926,.258819,-.866025,-.707107],[.669131,-.529919,-.961262,.275637,-.848048,-.743145],[.62932,-.559193,-.956305,.292372,-.829038,-.777146],[.587785,-.587785,-.951057,.309017,-.809017,-.809017],[.544639,-.615661,-.945519,.325568,-.788011,-.838671],[.5,-.642788,-.939693,.34202,-.766044,-.866025],[.45399,-.669131,-.93358,.358368,-.743145,-.891007],[.406737,-.694658,-.927184,.374607,-.71934,-.913545],[.358368,-.71934,-.920505,.390731,-.694658,-.93358],[.309017,-.743145,-.913545,.406737,-.669131,-.951057],[.258819,-.766044,-.906308,.422618,-.642788,-.965926],[.207912,-.788011,-.898794,.438371,-.615661,-.978148],[.156434,-.809017,-.891007,.45399,-.587785,-.987688],[.104528,-.829038,-.882948,.469472,-.559193,-.994522],[.052336,-.848048,-.87462,.48481,-.529919,-.99863],[0,-.866025,-.866025,.5,-.5,-1],[-.052336,-.882948,-.857167,.515038,-.469472,-.99863],[-.104528,-.898794,-.848048,.529919,-.438371,-.994522],[-.156434,-.913545,-.838671,.544639,-.406737,-.987688],[-.207912,-.927184,-.829038,.559193,-.374607,-.978148],[-.258819,-.939693,-.819152,.573576,-.34202,-.965926],[-.309017,-.951057,-.809017,.587785,-.309017,-.951057],[-.358368,-.961262,-.798636,.601815,-.275637,-.93358],[-.406737,-.970296,-.788011,.615661,-.241922,-.913545],[-.45399,-.978148,-.777146,.62932,-.207912,-.891007],[-.5,-.984808,-.766044,.642788,-.173648,-.866025],[-.544639,-.990268,-.75471,.656059,-.139173,-.838671],[-.587785,-.994522,-.743145,.669131,-.104528,-.809017],[-.62932,-.997564,-.731354,.681998,-.069756,-.777146],[-.669131,-.999391,-.71934,.694658,-.034899,-.743145],[-.707107,-1,-.707107,.707107,-0,-.707107],[-.743145,-.999391,-.694658,.71934,.034899,-.669131],[-.777146,-.997564,-.681998,.731354,.069756,-.62932],[-.809017,-.994522,-.669131,.743145,.104528,-.587785],[-.838671,-.990268,-.656059,.75471,.139173,-.544639],[-.866025,-.984808,-.642788,.766044,.173648,-.5],[-.891007,-.978148,-.62932,.777146,.207912,-.45399],[-.913545,-.970296,-.615661,.788011,.241922,-.406737],[-.93358,-.961262,-.601815,.798636,.275637,-.358368],[-.951057,-.951057,-.587785,.809017,.309017,-.309017],[-.965926,-.939693,-.573576,.819152,.34202,-.258819],[-.978148,-.927184,-.559193,.829038,.374607,-.207912],[-.987688,-.913545,-.544639,.838671,.406737,-.156434],[-.994522,-.898794,-.529919,.848048,.438371,-.104528],[-.99863,-.882948,-.515038,.857167,.469472,-.052336],[-1,-.866025,-.5,.866025,.5,-0],[-.99863,-.848048,-.48481,.87462,.529919,.052336],[-.994522,-.829038,-.469472,.882948,.559193,.104528],[-.987688,-.809017,-.45399,.891007,.587785,.156434],[-.978148,-.788011,-.438371,.898794,.615661,.207912],[-.965926,-.766044,-.422618,.906308,.642788,.258819],[-.951057,-.743145,-.406737,.913545,.669131,.309017],[-.93358,-.71934,-.390731,.920505,.694658,.358368],[-.913545,-.694658,-.374607,.927184,.71934,.406737],[-.891007,-.669131,-.358368,.93358,.743145,.45399],[-.866025,-.642788,-.34202,.939693,.766044,.5],[-.838671,-.615661,-.325568,.945519,.788011,.544639],[-.809017,-.587785,-.309017,.951057,.809017,.587785],[-.777146,-.559193,-.292372,.956305,.829038,.62932],[-.743145,-.529919,-.275637,.961262,.848048,.669131],[-.707107,-.5,-.258819,.965926,.866025,.707107],[-.669131,-.469472,-.241922,.970296,.882948,.743145],[-.62932,-.438371,-.224951,.97437,.898794,.777146],[-.587785,-.406737,-.207912,.978148,.913545,.809017],[-.544639,-.374607,-.190809,.981627,.927184,.838671],[-.5,-.34202,-.173648,.984808,.939693,.866025],[-.45399,-.309017,-.156434,.987688,.951057,.891007],[-.406737,-.275637,-.139173,.990268,.961262,.913545],[-.358368,-.241922,-.121869,.992546,.970296,.93358],[-.309017,-.207912,-.104528,.994522,.978148,.951057],[-.258819,-.173648,-.087156,.996195,.984808,.965926],[-.207912,-.139173,-.069756,.997564,.990268,.978148],[-.156434,-.104528,-.052336,.99863,.994522,.987688],[-.104528,-.069756,-.034899,.999391,.997564,.994522],[-.052336,-.034899,-.017452,.999848,.999391,.99863]],[[-1,-0,1,-0,0,-1,-0,0,-0],[-.999848,.017452,.999543,-.030224,264e-6,-.999086,.042733,-59e-5,4e-6],[-.999391,.034899,.998173,-.060411,.001055,-.996348,.085356,-.002357,34e-6],[-.99863,.052336,.995891,-.090524,.002372,-.991791,.127757,-.005297,113e-6],[-.997564,.069756,.992701,-.120527,.004214,-.985429,.169828,-.0094,268e-6],[-.996195,.087156,.988606,-.150384,.006578,-.977277,.21146,-.014654,523e-6],[-.994522,.104528,.983611,-.180057,.009462,-.967356,.252544,-.021043,903e-6],[-.992546,.121869,.977722,-.209511,.012862,-.955693,.292976,-.028547,.001431],[-.990268,.139173,.970946,-.238709,.016774,-.942316,.332649,-.037143,.002131],[-.987688,.156434,.963292,-.267617,.021193,-.927262,.371463,-.046806,.003026],[-.984808,.173648,.954769,-.296198,.026114,-.910569,.409317,-.057505,.00414],[-.981627,.190809,.945388,-.324419,.03153,-.892279,.446114,-.069209,.005492],[-.978148,.207912,.935159,-.352244,.037436,-.872441,.481759,-.08188,.007105],[-.97437,.224951,.924096,-.379641,.043823,-.851105,.516162,-.095481,.008999],[-.970296,.241922,.912211,-.406574,.050685,-.828326,.549233,-.109969,.011193],[-.965926,.258819,.899519,-.433013,.058013,-.804164,.580889,-.1253,.013707],[-.961262,.275637,.886036,-.458924,.065797,-.77868,.61105,-.141427,.016556],[-.956305,.292372,.871778,-.484275,.074029,-.75194,.639639,-.158301,.019758],[-.951057,.309017,.856763,-.509037,.082698,-.724012,.666583,-.175868,.023329],[-.945519,.325568,.841008,-.533178,.091794,-.694969,.691816,-.194075,.027281],[-.939693,.34202,.824533,-.55667,.101306,-.664885,.715274,-.212865,.03163],[-.93358,.358368,.807359,-.579484,.111222,-.633837,.736898,-.23218,.036385],[-.927184,.374607,.789505,-.601592,.121529,-.601904,.756637,-.25196,.041559],[-.920505,.390731,.770994,-.622967,.132217,-.569169,.774442,-.272143,.04716],[-.913545,.406737,.751848,-.643582,.143271,-.535715,.79027,-.292666,.053196],[-.906308,.422618,.732091,-.663414,.154678,-.501627,.804083,-.313464,.059674],[-.898794,.438371,.711746,-.682437,.166423,-.466993,.81585,-.334472,.066599],[-.891007,.45399,.690839,-.700629,.178494,-.431899,.825544,-.355623,.073974],[-.882948,.469472,.669395,-.717968,.190875,-.396436,.833145,-.376851,.081803],[-.87462,.48481,.647439,-.734431,.203551,-.360692,.838638,-.398086,.090085],[-.866025,.5,.625,-.75,.216506,-.32476,.842012,-.419263,.098821],[-.857167,.515038,.602104,-.764655,.229726,-.288728,.843265,-.440311,.108009],[-.848048,.529919,.578778,-.778378,.243192,-.252688,.842399,-.461164,.117644],[-.838671,.544639,.555052,-.791154,.256891,-.21673,.839422,-.481753,.127722],[-.829038,.559193,.530955,-.802965,.270803,-.180944,.834347,-.502011,.138237],[-.819152,.573576,.506515,-.813798,.284914,-.14542,.827194,-.521871,.149181],[-.809017,.587785,.481763,-.823639,.299204,-.110246,.817987,-.541266,.160545],[-.798636,.601815,.456728,-.832477,.313658,-.075508,.806757,-.560132,.172317],[-.788011,.615661,.431441,-.840301,.328257,-.041294,.793541,-.578405,.184487],[-.777146,.62932,.405934,-.847101,.342984,-.007686,.778379,-.596021,.19704],[-.766044,.642788,.380236,-.852869,.357821,.025233,.761319,-.612921,.209963],[-.75471,.656059,.35438,-.857597,.372749,.057383,.742412,-.629044,.223238],[-.743145,.669131,.328396,-.861281,.387751,.088686,.721714,-.644334,.23685],[-.731354,.681998,.302317,-.863916,.402807,.119068,.699288,-.658734,.250778],[-.71934,.694658,.276175,-.865498,.417901,.148454,.675199,-.67219,.265005],[-.707107,.707107,.25,-.866025,.433013,.176777,.649519,-.684653,.279508],[-.694658,.71934,.223825,-.865498,.448125,.203969,.622322,-.696073,.294267],[-.681998,.731354,.197683,-.863916,.463218,.229967,.593688,-.706405,.309259],[-.669131,.743145,.171604,-.861281,.478275,.254712,.5637,-.715605,.324459],[-.656059,.75471,.14562,-.857597,.493276,.278147,.532443,-.723633,.339844],[-.642788,.766044,.119764,-.852869,.508205,.300221,.500009,-.730451,.355387],[-.62932,.777146,.094066,-.847101,.523041,.320884,.46649,-.736025,.371063],[-.615661,.788011,.068559,-.840301,.537768,.340093,.431982,-.740324,.386845],[-.601815,.798636,.043272,-.832477,.552367,.357807,.396584,-.74332,.402704],[-.587785,.809017,.018237,-.823639,.566821,.373991,.360397,-.744989,.418613],[-.573576,.819152,-.006515,-.813798,.581112,.388612,.323524,-.745308,.434544],[-.559193,.829038,-.030955,-.802965,.595222,.401645,.286069,-.744262,.450467],[-.544639,.838671,-.055052,-.791154,.609135,.413066,.24814,-.741835,.466352],[-.529919,.848048,-.078778,-.778378,.622833,.422856,.209843,-.738017,.482171],[-.515038,.857167,-.102104,-.764655,.6363,.431004,.171288,-.732801,.497894],[-.5,.866025,-.125,-.75,.649519,.4375,.132583,-.726184,.51349],[-.48481,.87462,-.147439,-.734431,.662474,.44234,.093837,-.718167,.528929],[-.469472,.882948,-.169395,-.717968,.67515,.445524,.05516,-.708753,.544183],[-.45399,.891007,-.190839,-.700629,.687531,.447059,.016662,-.69795,.55922],[-.438371,.898794,-.211746,-.682437,.699602,.446953,-.02155,-.685769,.574011],[-.422618,.906308,-.232091,-.663414,.711348,.445222,-.059368,-.672226,.588528],[-.406737,.913545,-.251848,-.643582,.722755,.441884,-.096684,-.657339,.602741],[-.390731,.920505,-.270994,-.622967,.733809,.436964,-.133395,-.64113,.616621],[-.374607,.927184,-.289505,-.601592,.744496,.430488,-.169397,-.623624,.630141],[-.358368,.93358,-.307359,-.579484,.754804,.422491,-.204589,-.604851,.643273],[-.34202,.939693,-.324533,-.55667,.76472,.413008,-.238872,-.584843,.65599],[-.325568,.945519,-.341008,-.533178,.774231,.402081,-.27215,-.563635,.668267],[-.309017,.951057,-.356763,-.509037,.783327,.389754,-.304329,-.541266,.680078],[-.292372,.956305,-.371778,-.484275,.791997,.376077,-.335319,-.517778,.691399],[-.275637,.961262,-.386036,-.458924,.800228,.361102,-.365034,-.493216,.702207],[-.258819,.965926,-.399519,-.433013,.808013,.344885,-.393389,-.467627,.712478],[-.241922,.970296,-.412211,-.406574,.81534,.327486,-.420306,-.441061,.722191],[-.224951,.97437,-.424096,-.379641,.822202,.308969,-.445709,-.413572,.731327],[-.207912,.978148,-.435159,-.352244,.828589,.289399,-.469527,-.385215,.739866],[-.190809,.981627,-.445388,-.324419,.834495,.268846,-.491693,-.356047,.74779],[-.173648,.984808,-.454769,-.296198,.839912,.247382,-.512145,-.326129,.755082],[-.156434,.987688,-.463292,-.267617,.844832,.225081,-.530827,-.295521,.761728],[-.139173,.990268,-.470946,-.238709,.849251,.20202,-.547684,-.264287,.767712],[-.121869,.992546,-.477722,-.209511,.853163,.178279,-.562672,-.232494,.773023],[-.104528,.994522,-.483611,-.180057,.856563,.153937,-.575747,-.200207,.777648],[-.087156,.996195,-.488606,-.150384,.859447,.129078,-.586872,-.167494,.781579],[-.069756,.997564,-.492701,-.120527,.861811,.103786,-.596018,-.134426,.784806],[-.052336,.99863,-.495891,-.090524,.863653,.078146,-.603158,-.101071,.787324],[-.034899,.999391,-.498173,-.060411,.864971,.052243,-.608272,-.0675,.789126],[-.017452,.999848,-.499543,-.030224,.865762,.026165,-.611347,-.033786,.790208],[0,1,-.5,0,.866025,-0,-.612372,0,.790569],[.017452,.999848,-.499543,.030224,.865762,-.026165,-.611347,.033786,.790208],[.034899,.999391,-.498173,.060411,.864971,-.052243,-.608272,.0675,.789126],[.052336,.99863,-.495891,.090524,.863653,-.078146,-.603158,.101071,.787324],[.069756,.997564,-.492701,.120527,.861811,-.103786,-.596018,.134426,.784806],[.087156,.996195,-.488606,.150384,.859447,-.129078,-.586872,.167494,.781579],[.104528,.994522,-.483611,.180057,.856563,-.153937,-.575747,.200207,.777648],[.121869,.992546,-.477722,.209511,.853163,-.178279,-.562672,.232494,.773023],[.139173,.990268,-.470946,.238709,.849251,-.20202,-.547684,.264287,.767712],[.156434,.987688,-.463292,.267617,.844832,-.225081,-.530827,.295521,.761728],[.173648,.984808,-.454769,.296198,.839912,-.247382,-.512145,.326129,.755082],[.190809,.981627,-.445388,.324419,.834495,-.268846,-.491693,.356047,.74779],[.207912,.978148,-.435159,.352244,.828589,-.289399,-.469527,.385215,.739866],[.224951,.97437,-.424096,.379641,.822202,-.308969,-.445709,.413572,.731327],[.241922,.970296,-.412211,.406574,.81534,-.327486,-.420306,.441061,.722191],[.258819,.965926,-.399519,.433013,.808013,-.344885,-.393389,.467627,.712478],[.275637,.961262,-.386036,.458924,.800228,-.361102,-.365034,.493216,.702207],[.292372,.956305,-.371778,.484275,.791997,-.376077,-.335319,.517778,.691399],[.309017,.951057,-.356763,.509037,.783327,-.389754,-.304329,.541266,.680078],[.325568,.945519,-.341008,.533178,.774231,-.402081,-.27215,.563635,.668267],[.34202,.939693,-.324533,.55667,.76472,-.413008,-.238872,.584843,.65599],[.358368,.93358,-.307359,.579484,.754804,-.422491,-.204589,.604851,.643273],[.374607,.927184,-.289505,.601592,.744496,-.430488,-.169397,.623624,.630141],[.390731,.920505,-.270994,.622967,.733809,-.436964,-.133395,.64113,.616621],[.406737,.913545,-.251848,.643582,.722755,-.441884,-.096684,.657339,.602741],[.422618,.906308,-.232091,.663414,.711348,-.445222,-.059368,.672226,.588528],[.438371,.898794,-.211746,.682437,.699602,-.446953,-.02155,.685769,.574011],[.45399,.891007,-.190839,.700629,.687531,-.447059,.016662,.69795,.55922],[.469472,.882948,-.169395,.717968,.67515,-.445524,.05516,.708753,.544183],[.48481,.87462,-.147439,.734431,.662474,-.44234,.093837,.718167,.528929],[.5,.866025,-.125,.75,.649519,-.4375,.132583,.726184,.51349],[.515038,.857167,-.102104,.764655,.6363,-.431004,.171288,.732801,.497894],[.529919,.848048,-.078778,.778378,.622833,-.422856,.209843,.738017,.482171],[.544639,.838671,-.055052,.791154,.609135,-.413066,.24814,.741835,.466352],[.559193,.829038,-.030955,.802965,.595222,-.401645,.286069,.744262,.450467],[.573576,.819152,-.006515,.813798,.581112,-.388612,.323524,.745308,.434544],[.587785,.809017,.018237,.823639,.566821,-.373991,.360397,.744989,.418613],[.601815,.798636,.043272,.832477,.552367,-.357807,.396584,.74332,.402704],[.615661,.788011,.068559,.840301,.537768,-.340093,.431982,.740324,.386845],[.62932,.777146,.094066,.847101,.523041,-.320884,.46649,.736025,.371063],[.642788,.766044,.119764,.852869,.508205,-.300221,.500009,.730451,.355387],[.656059,.75471,.14562,.857597,.493276,-.278147,.532443,.723633,.339844],[.669131,.743145,.171604,.861281,.478275,-.254712,.5637,.715605,.324459],[.681998,.731354,.197683,.863916,.463218,-.229967,.593688,.706405,.309259],[.694658,.71934,.223825,.865498,.448125,-.203969,.622322,.696073,.294267],[.707107,.707107,.25,.866025,.433013,-.176777,.649519,.684653,.279508],[.71934,.694658,.276175,.865498,.417901,-.148454,.675199,.67219,.265005],[.731354,.681998,.302317,.863916,.402807,-.119068,.699288,.658734,.250778],[.743145,.669131,.328396,.861281,.387751,-.088686,.721714,.644334,.23685],[.75471,.656059,.35438,.857597,.372749,-.057383,.742412,.629044,.223238],[.766044,.642788,.380236,.852869,.357821,-.025233,.761319,.612921,.209963],[.777146,.62932,.405934,.847101,.342984,.007686,.778379,.596021,.19704],[.788011,.615661,.431441,.840301,.328257,.041294,.793541,.578405,.184487],[.798636,.601815,.456728,.832477,.313658,.075508,.806757,.560132,.172317],[.809017,.587785,.481763,.823639,.299204,.110246,.817987,.541266,.160545],[.819152,.573576,.506515,.813798,.284914,.14542,.827194,.521871,.149181],[.829038,.559193,.530955,.802965,.270803,.180944,.834347,.502011,.138237],[.838671,.544639,.555052,.791154,.256891,.21673,.839422,.481753,.127722],[.848048,.529919,.578778,.778378,.243192,.252688,.842399,.461164,.117644],[.857167,.515038,.602104,.764655,.229726,.288728,.843265,.440311,.108009],[.866025,.5,.625,.75,.216506,.32476,.842012,.419263,.098821],[.87462,.48481,.647439,.734431,.203551,.360692,.838638,.398086,.090085],[.882948,.469472,.669395,.717968,.190875,.396436,.833145,.376851,.081803],[.891007,.45399,.690839,.700629,.178494,.431899,.825544,.355623,.073974],[.898794,.438371,.711746,.682437,.166423,.466993,.81585,.334472,.066599],[.906308,.422618,.732091,.663414,.154678,.501627,.804083,.313464,.059674],[.913545,.406737,.751848,.643582,.143271,.535715,.79027,.292666,.053196],[.920505,.390731,.770994,.622967,.132217,.569169,.774442,.272143,.04716],[.927184,.374607,.789505,.601592,.121529,.601904,.756637,.25196,.041559],[.93358,.358368,.807359,.579484,.111222,.633837,.736898,.23218,.036385],[.939693,.34202,.824533,.55667,.101306,.664885,.715274,.212865,.03163],[.945519,.325568,.841008,.533178,.091794,.694969,.691816,.194075,.027281],[.951057,.309017,.856763,.509037,.082698,.724012,.666583,.175868,.023329],[.956305,.292372,.871778,.484275,.074029,.75194,.639639,.158301,.019758],[.961262,.275637,.886036,.458924,.065797,.77868,.61105,.141427,.016556],[.965926,.258819,.899519,.433013,.058013,.804164,.580889,.1253,.013707],[.970296,.241922,.912211,.406574,.050685,.828326,.549233,.109969,.011193],[.97437,.224951,.924096,.379641,.043823,.851105,.516162,.095481,.008999],[.978148,.207912,.935159,.352244,.037436,.872441,.481759,.08188,.007105],[.981627,.190809,.945388,.324419,.03153,.892279,.446114,.069209,.005492],[.984808,.173648,.954769,.296198,.026114,.910569,.409317,.057505,.00414],[.987688,.156434,.963292,.267617,.021193,.927262,.371463,.046806,.003026],[.990268,.139173,.970946,.238709,.016774,.942316,.332649,.037143,.002131],[.992546,.121869,.977722,.209511,.012862,.955693,.292976,.028547,.001431],[.994522,.104528,.983611,.180057,.009462,.967356,.252544,.021043,903e-6],[.996195,.087156,.988606,.150384,.006578,.977277,.21146,.014654,523e-6],[.997564,.069756,.992701,.120527,.004214,.985429,.169828,.0094,268e-6],[.99863,.052336,.995891,.090524,.002372,.991791,.127757,.005297,113e-6],[.999391,.034899,.998173,.060411,.001055,.996348,.085356,.002357,34e-6],[.999848,.017452,.999543,.030224,264e-6,.999086,.042733,59e-5,4e-6],[1,-0,1,-0,0,1,-0,0,-0]]],xe=(Me[0].length,Me[1].length,Me[0][0].length/2),Ee=[[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1.003236,1.002156,.999152,.990038],[1.03237,1.021194,.990433,.898572],[1.062694,1.040231,.979161,.799806],[1.093999,1.058954,.964976,.693603],[1.126003,1.077006,.947526,.57989],[1.158345,1.093982,.926474,.45869],[1.19059,1.109437,.901512,.330158],[1.222228,1.12289,.87237,.194621],[1.252684,1.133837,.838839,.052614],[1.281987,1.142358,.801199,0],[1.312073,1.150207,.760839,0],[1.343011,1.157424,.717799,0],[1.374649,1.163859,.671999,0],[1.406809,1.169354,.623371,0],[1.439286,1.173739,.571868,0],[1.471846,1.176837,.517465,0],[1.504226,1.178465,.460174,0],[1.536133,1.178438,.400043,0],[1.567253,1.176573,.337165,0],[1.597247,1.172695,.271688,0],[1.625766,1.166645,.203815,0],[1.652455,1.158285,.133806,0],[1.676966,1.147506,.061983,0],[1.699006,1.134261,0,0],[1.720224,1.119789,0,0],[1.741631,1.10481,0,0],[1.763183,1.08933,0,0],[1.784837,1.073356,0,0],[1.806548,1.056898,0,0],[1.828269,1.039968,0,0],[1.849952,1.02258,0,0],[1.871552,1.004752,0,0],[1.893018,.986504,0,0],[1.914305,.967857,0,0],[1.935366,.948837,0,0],[1.956154,.929471,0,0],[1.976625,.90979,0,0],[1.996736,.889823,0,0],[2.016448,.869607,0,0],[2.035721,.849175,0,0],[2.054522,.828565,0,0],[2.072818,.807816,0,0],[2.090581,.786964,0,0],[2.107785,.766051,0,0],[2.124411,.745115,0,0],[2.140439,.724196,0,0],[2.155856,.703332,0,0],[2.170653,.682561,0,0],[2.184823,.661921,0,0],[2.198364,.641445,0,0],[2.211275,.621169,0,0],[2.223562,.601125,0,0],[2.23523,.581341,0,0],[2.246289,.561847,0,0],[2.256751,.542667,0,0],[2.266631,.523826,0,0],[2.275943,.505344,0,0],[2.284707,.487239,0,0],[2.292939,.469528,0,0],[2.300661,.452225,0,0],[2.307892,.435342,0,0],[2.314654,.418888,0,0],[2.320969,.40287,0,0],[2.326858,.387294,0,0],[2.332343,.372164,0,0],[2.337445,.357481,0,0],[2.342186,.343246,0,0],[2.346585,.329458,0,0],[2.350664,.316113,0,0],[2.354442,.303208,0,0],[2.357937,.290738,0,0],[2.361168,.278698,0,0],[2.364152,.26708,0,0],[2.366906,.255878,0,0],[2.369446,.245082,0,0],[2.371786,.234685,0,0],[2.37394,.224677,0,0],[2.375923,.215048,0,0],[2.377745,.20579,0,0],[2.379421,.196891,0,0],[2.380959,.188342,0,0],[2.382372,.180132,0,0],[2.383667,.172251,0,0],[2.384856,.164689,0,0],[2.385945,.157435,0,0],[2.386943,.150479,0,0],[2.387857,.143811,0,0],[2.388694,.137421,0,0],[2.38946,.131299,0,0],[2.39016,.125435,0,0],[2.390801,.11982,0,0],[2.391386,.114445,0,0],[2.391921,.1093,0,0],[2.39241,.104376,0,0],[2.392857,.099666,0,0],[2.393265,.09516,0,0],[2.393637,.090851,0,0],[2.393977,.086731,0,0],[2.394288,.082791,0,0],[2.394571,.079025,0,0],[2.394829,.075426,0,0],[2.395064,.071986,0,0],[2.395279,.068699,0,0],[2.395475,.065558,0,0],[2.395653,.062558,0,0],[2.395816,.059693,0,0],[2.395964,.056955,0,0],[2.396099,.054341,0,0],[2.396222,.051845,0,0],[2.396334,.049462,0,0],[2.396436,.047186,0,0],[2.396529,.045013,0,0],[2.396613,.042939,0,0],[2.396691,.040959,0,0],[2.396761,.039069,0,0],[2.396825,.037266,0,0],[2.396883,.035544,0,0],[2.396936,.033901,0,0],[2.396984,.032334,0,0],[2.397028,.030838,0,0],[2.397068,.02941,0,0],[2.397104,.028048,0,0],[2.397137,.026749,0,0],[2.397167,.025509,0,0],[2.397194,.024326,0,0],[2.397219,.023198,0,0],[2.397242,.022122,0,0],[2.397262,.021095,0,0],[2.397281,.020116,0,0],[2.397298,.019181,0,0],[2.397314,.01829,0,0],[2.397328,.017441,0,0],[2.397341,.01663,0,0],[2.397352,.015857,0,0],[2.397363,.015119,0,0],[2.397372,.014416,0,0],[2.397381,.013745,0,0],[2.397389,.013106,0,0],[2.397396,.012496,0,0],[2.397403,.011914,0,0],[2.397409,.01136,0,0],[2.397414,.010831,0,0],[2.397419,.010326,0,0],[2.397424,.009845,0,0],[2.397428,.009387,0,0],[2.397432,.008949,0,0],[2.397435,.008532,0,0],[2.397438,.008135,0,0],[2.397441,.007755,0,0],[2.397443,.007394,0,0],[2.397446,.007049,0,0],[2.397448,.006721,0,0],[2.39745,.006407,0,0],[2.397451,.006108,0,0],[2.397453,.005824,0,0],[2.397454,.005552,0,0],[2.397456,.005293,0,0],[2.397457,.005046,0,0],[2.397458,.004811,0,0],[2.397459,.004586,0,0],[2.39746,.004372,0,0],[2.397461,.004168,0,0],[2.397461,.003974,0,0],[2.397462,.003788,0,0],[2.397463,.003611,0,0],[2.397463,.003443,0,0],[2.397464,.003282,0,0],[2.397464,.003129,0,0],[2.397465,.002983,0,0],[2.397465,.002844,0,0],[2.397465,.002711,0,0],[2.397466,.002584,0,0],[2.397466,.002464,0,0],[2.397466,.002349,0,0],[2.397466,.002239,0,0],[2.397467,.002135,0,0],[2.397467,.002035,0,0],[2.397467,.00194,0,0],[2.397467,.001849,0,0],[2.397467,.001763,0,0],[2.397467,.001681,0,0],[2.397468,.001602,0,0],[2.397468,.001527,0,0],[2.397468,.001456,0,0],[2.397468,.001388,0,0],[2.397468,.001323,0,0],[2.397468,.001261,0,0],[2.397468,.001202,0,0],[2.397468,.001146,0,0],[2.397468,.001093,0,0],[2.397468,.001042,0,0],[2.397468,993e-6,0,0],[2.397468,947e-6,0,0],[2.397468,902e-6,0,0],[2.397468,86e-5,0,0],[2.397468,82e-5,0,0],[2.397469,782e-6,0,0],[2.397469,745e-6,0,0],[2.397469,71e-5,0,0],[2.397469,677e-6,0,0],[2.397469,646e-6,0,0],[2.397469,616e-6,0,0],[2.397469,587e-6,0,0],[2.397469,559e-6,0,0],[2.397469,533e-6,0,0],[2.397469,508e-6,0,0],[2.397469,485e-6,0,0],[2.397469,462e-6,0,0],[2.397469,44e-5,0,0],[2.397469,42e-5,0,0],[2.397469,4e-4,0,0],[2.397469,381e-6,0,0],[2.397469,364e-6,0,0],[2.397469,347e-6,0,0],[2.397469,33e-5,0,0],[2.397469,315e-6,0,0],[2.397469,3e-4,0,0],[2.397469,286e-6,0,0],[2.397469,273e-6,0,0],[2.397469,26e-5,0,0],[2.397469,248e-6,0,0],[2.397469,236e-6,0,0],[2.397469,225e-6,0,0],[2.397469,215e-6,0,0],[2.397469,205e-6,0,0],[2.397469,195e-6,0,0],[2.397469,186e-6,0,0],[2.397469,177e-6,0,0],[2.397469,169e-6,0,0],[2.397469,161e-6,0,0],[2.397469,154e-6,0,0],[2.397469,147e-6,0,0],[2.397469,14e-5,0,0],[2.397469,133e-6,0,0],[2.397469,127e-6,0,0],[2.397469,121e-6,0,0],[2.397469,115e-6,0,0],[2.397469,11e-5,0,0],[2.397469,105e-6,0,0],[2.397469,1e-4,0,0],[2.397469,95e-6,0,0],[2.397469,91e-6,0,0],[2.397469,87e-6,0,0],[2.397469,83e-6,0,0],[2.397469,79e-6,0,0],[2.397469,75e-6,0,0],[2.397469,71e-6,0,0],[2.397469,68e-6,0,0],[2.397469,65e-6,0,0],[2.397469,62e-6,0,0],[2.397469,59e-6,0,0],[2.397469,56e-6,0,0],[2.397469,54e-6,0,0],[2.397469,51e-6,0,0],[2.397469,49e-6,0,0],[2.397469,46e-6,0,0],[2.397469,44e-6,0,0],[2.397469,42e-6,0,0],[2.397469,4e-5,0,0],[2.397469,38e-6,0,0],[2.397469,37e-6,0,0],[2.397469,35e-6,0,0],[2.397469,33e-6,0,0],[2.397469,32e-6,0,0],[2.397469,3e-5,0,0],[2.397469,29e-6,0,0],[2.397469,27e-6,0,0],[2.397469,26e-6,0,0],[2.397469,25e-6,0,0],[2.397469,24e-6,0,0],[2.397469,23e-6,0,0],[2.397469,22e-6,0,0],[2.397469,21e-6,0,0],[2.397469,2e-5,0,0],[2.397469,19e-6,0,0],[2.397469,18e-6,0,0],[2.397469,17e-6,0,0],[2.397469,16e-6,0,0],[2.397469,15e-6,0,0],[2.397469,15e-6,0,0],[2.397469,14e-6,0,0],[2.397469,13e-6,0,0],[2.397469,13e-6,0,0],[2.397469,12e-6,0,0],[2.397469,12e-6,0,0],[2.397469,11e-6,0,0],[2.397469,11e-6,0,0],[2.397469,1e-5,0,0],[2.397469,1e-5,0,0],[2.397469,9e-6,0,0],[2.397469,9e-6,0,0],[2.397469,8e-6,0,0],[2.397469,8e-6,0,0],[2.397469,8e-6,0,0],[2.397469,7e-6,0,0],[2.397469,7e-6,0,0],[2.397469,7e-6,0,0],[2.397469,6e-6,0,0],[2.397469,6e-6,0,0],[2.397469,6e-6,0,0],[2.397469,5e-6,0,0],[2.397469,5e-6,0,0],[2.397469,5e-6,0,0],[2.397469,5e-6,0,0],[2.397469,4e-6,0,0],[2.397469,4e-6,0,0],[2.397469,4e-6,0,0],[2.397469,4e-6,0,0],[2.397469,4e-6,0,0],[2.397469,4e-6,0,0],[2.397469,3e-6,0,0],[2.397469,3e-6,0,0],[2.397469,3e-6,0,0],[2.397469,3e-6,0,0],[2.397469,3e-6,0,0],[2.397469,3e-6,0,0],[2.397469,3e-6,0,0],[2.397469,2e-6,0,0],[2.397469,2e-6,0,0],[2.397469,2e-6,0,0],[2.397469,2e-6,0,0],[2.397469,2e-6,0,0],[2.397469,2e-6,0,0],[2.397469,2e-6,0,0],[2.397469,2e-6,0,0],[2.397469,2e-6,0,0],[2.397469,2e-6,0,0],[2.397469,1e-6,0,0],[2.397469,1e-6,0,0],[2.397469,1e-6,0,0]];var Fe,Se,ke;!function(t){t.Logarithmic="logarithmic",t.Linear="linear",t.None="none"}(Fe||(Fe={})),function(t){t.Width="width",t.Height="height",t.Depth="depth"}(Se||(Se={})),function(t){t.Left="left",t.Right="right",t.Front="front",t.Back="back",t.Down="down",t.Up="up"}(ke||(ke={}));const Le=((_e=he())[0]=0,_e[1]=0,_e[2]=0,_e);var _e;const Te=le(he(),0,0,-1),Oe=le(he(),0,1,0),Re=(le(he(),1,0,0),343),Ue=Fe.Logarithmic,Qe="ambisonic",Ne={[ke.Left]:0,[ke.Right]:0,[ke.Front]:0,[ke.Back]:0,[ke.Down]:0,[ke.Up]:0},He={[Se.Width]:0,[Se.Height]:0,[Se.Depth]:0},ze=[31.25,62.5,125,250,500,1e3,2e3,4e3,8e3],Ge=ze.length,je=new Float32Array(Ge);var We;!function(t){t.Transparent="transparent",t.AcousticCeilingTiles="acoustic-ceiling-tiles",t.BrickBare="brick-bare",t.BrickPainted="brick-painted",t.ConcreteBlockCoarse="concrete-block-coarse",t.ConcreteBlockPainted="concrete-block-painted",t.CurtainHeavy="curtain-heavy",t.FiberGlassInsulation="fiber-glass-insulation",t.GlassThin="glass-thin",t.GlassThick="glass-thick",t.Grass="grass",t.LinoleumOnConcrete="linoleum-on-concrete",t.Marble="marble",t.Metal="metal",t.ParquetOnConcrete="parquet-on-concrete",t.PlasterRough="plaster-rough",t.PlasterSmooth="plaster-smooth",t.PlywoodPanel="plywood-panel",t.PolishedConcreteOrTile="polished-concrete-or-tile",t.Sheetrock="sheetrock",t.WaterOrIceSurface="water-or-ice-surface",t.WoodCeiling="wood-ceiling",t.WoodPanel="wood-panel",t.Uniform="uniform"}(We||(We={}));const Ve={[We.Transparent]:[1,1,1,1,1,1,1,1,1],[We.AcousticCeilingTiles]:[.672,.675,.7,.66,.72,.92,.88,.75,1],[We.BrickBare]:[.03,.03,.03,.03,.03,.04,.05,.07,.14],[We.BrickPainted]:[.006,.007,.01,.01,.02,.02,.02,.03,.06],[We.ConcreteBlockCoarse]:[.36,.36,.36,.44,.31,.29,.39,.25,.5],[We.ConcreteBlockPainted]:[.092,.09,.1,.05,.06,.07,.09,.08,.16],[We.CurtainHeavy]:[.073,.106,.14,.35,.55,.72,.7,.65,1],[We.FiberGlassInsulation]:[.193,.22,.22,.82,.99,.99,.99,.99,1],[We.GlassThin]:[.18,.169,.18,.06,.04,.03,.02,.02,.04],[We.GlassThick]:[.35,.35,.35,.25,.18,.12,.07,.04,.08],[We.Grass]:[.05,.05,.15,.25,.4,.55,.6,.6,.6],[We.LinoleumOnConcrete]:[.02,.02,.02,.03,.03,.03,.03,.02,.04],[We.Marble]:[.01,.01,.01,.01,.01,.01,.02,.02,.04],[We.Metal]:[.03,.035,.04,.04,.05,.05,.05,.07,.09],[We.ParquetOnConcrete]:[.028,.03,.04,.04,.07,.06,.06,.07,.14],[We.PlasterRough]:[.017,.018,.02,.03,.04,.05,.04,.03,.06],[We.PlasterSmooth]:[.011,.012,.013,.015,.02,.03,.04,.05,.1],[We.PlywoodPanel]:[.4,.34,.28,.22,.17,.09,.1,.11,.22],[We.PolishedConcreteOrTile]:[.008,.008,.01,.01,.015,.02,.02,.02,.04],[We.Sheetrock]:[.29,.279,.29,.1,.05,.04,.07,.09,.18],[We.WaterOrIceSurface]:[.006,.006,.008,.008,.013,.015,.02,.025,.05],[We.WoodCeiling]:[.15,.147,.15,.11,.1,.07,.06,.07,.14],[We.WoodPanel]:[.28,.28,.28,.22,.17,.09,.1,.11,.22],[We.Uniform]:[.5,.5,.5,.5,.5,.5,.5,.5,.5]},Ze={[ke.Left]:We.Transparent,[ke.Right]:We.Transparent,[ke.Front]:We.Transparent,[ke.Back]:We.Transparent,[ke.Down]:We.Transparent,[ke.Up]:We.Transparent},Ye=[6e-4,6e-4,7e-4,8e-4,.001,.0015,.0026,.006,.0207],Xe=6.28318530717959,Je=57.29577951308232,Ke=1e-8,qe=function(...t){window.console.log.apply(window.console,["%c[ResonanceAudio]%c "+t.join(" ")+" %c(@"+performance.now().toFixed(2)+"ms)","background: #BBDEFB; color: #FF5722; font-weight: 700","font-weight: 400","color: #AAA"])},$e={[ke.Left]:Se.Width,[ke.Right]:Se.Width,[ke.Front]:Se.Depth,[ke.Back]:Se.Depth,[ke.Up]:Se.Height,[ke.Down]:Se.Height},ti={[ke.Left]:0,[ke.Right]:0,[ke.Front]:2,[ke.Back]:2,[ke.Up]:1,[ke.Down]:1},ei={[ke.Left]:1,[ke.Right]:-1,[ke.Front]:1,[ke.Back]:-1,[ke.Up]:-1,[ke.Down]:1};class ii{constructor(t,e){this.channelGain=new Array,this.merger=null,e=Object.assign({ambisonicOrder:1,azimuth:0,elevation:0,sourceWidth:0},e),this.context=t,this.input=t.createGain(),this.output=t.createGain(),this.setAmbisonicOrder(e.ambisonicOrder),this.azimuth=e.azimuth,this.elevation=e.elevation,this.setSourceWidth(e.sourceWidth)}static validateAmbisonicOrder(t){return isNaN(t)||null==t?(qe("Error: Invalid ambisonic order",t,"\nUsing ambisonicOrder=1 instead."),t=1):t<1?(qe("Error: Unable to render ambisonic order",t,"(Min order is 1)","\nUsing min order instead."),t=1):t>xe&&(qe("Error: Unable to render ambisonic order",t,"(Max order is",xe,")\nUsing max order instead."),t=xe),t}setAmbisonicOrder(t){this.ambisonicOrder=ii.validateAmbisonicOrder(t),this.input.disconnect();for(let t=0;t<this.channelGain.length;t++)this.channelGain[t].disconnect();null!=this.merger&&this.merger.disconnect();let e=(this.ambisonicOrder+1)*(this.ambisonicOrder+1);this.merger=this.context.createChannelMerger(e),this.channelGain=new Array(e);for(let t=0;t<e;t++)this.channelGain[t]=this.context.createGain(),this.input.connect(this.channelGain[t]),this.channelGain[t].connect(this.merger,0,t);this.merger.connect(this.output)}dispose(){this.merger.disconnect(this.output);let t=(this.ambisonicOrder+1)*(this.ambisonicOrder+1);for(let e=0;e<t;++e)this.channelGain[e].disconnect(this.merger,0,e),this.input.disconnect(this.channelGain[e])}setDirection(t,e){(null==t||isNaN(t))&&(t=0),(null==e||isNaN(e))&&(e=0),this.azimuth=t,this.elevation=e,(t=Math.round(t%360))<0&&(t+=360),e=Math.round(Math.min(90,Math.max(-90,e)))+90,this.channelGain[0].gain.value=Ee[this.spreadIndex][0];for(let i=1;i<=this.ambisonicOrder;i++){let n=Ee[this.spreadIndex][i];for(let s=-i;s<=i;s++){const a=i*i+i+s,o=i*(i+1)/2+Math.abs(s)-1;let r=Me[1][e][o];if(0!=s){let e=xe+s-1;s<0&&(e=xe+s),r*=Me[0][t][e]}this.channelGain[a].gain.value=r*n}}}setSourceWidth(t){this.spreadIndex=Math.min(359,Math.max(0,Math.round(t))),this.setDirection(this.azimuth,this.elevation)}}function ni(...t){const e=`[Omnitone] ${t.join(" ")}`;window.console.log(e)}var si;!function(t){t.BASE64="base64",t.URL="url"}(si||(si={}));class ai{constructor(t,e,i){this._context=t,this._options=Object.assign({},{dataType:si.BASE64,verbose:!1},i),this._bufferData=this._options.dataType===si.BASE64?e:e.slice(0)}async load(){try{const t=this._bufferData.map((async t=>{try{return await this._launchAsyncLoadTask(t)}catch(e){const i='BufferList: error while loading "'+t+'". ('+e.message+")";throw new Error(i)}}));return await Promise.all(t)}catch(t){const e='BufferList: error while loading ". ('+t.message+")";throw new Error(e)}}async _launchAsyncLoadTask(t){const e=await this._fetch(t);return await this._context.decodeAudioData(e)}async _fetch(t){if(this._options.dataType===si.BASE64)return function(t){const e=window.atob(t),i=new Uint8Array(e.length);for(let t=0;t<i.length;++t)i[t]=e.charCodeAt(t);return i.buffer}(t);{const e=await fetch(t);return await e.arrayBuffer()}}}class oi{constructor(t,e){this._context=t,this._active=!1,this._isBufferLoaded=!1,this._buildAudioGraph(),e&&this.setHRIRBufferList(e),this.enable()}_buildAudioGraph(){this._splitterWYZX=this._context.createChannelSplitter(4),this._mergerWY=this._context.createChannelMerger(2),this._mergerZX=this._context.createChannelMerger(2),this._convolverWY=this._context.createConvolver(),this._convolverZX=this._context.createConvolver(),this._splitterWY=this._context.createChannelSplitter(2),this._splitterZX=this._context.createChannelSplitter(2),this._inverter=this._context.createGain(),this._mergerBinaural=this._context.createChannelMerger(2),this._summingBus=this._context.createGain(),this._splitterWYZX.connect(this._mergerWY,0,0),this._splitterWYZX.connect(this._mergerWY,1,1),this._splitterWYZX.connect(this._mergerZX,2,0),this._splitterWYZX.connect(this._mergerZX,3,1),this._mergerWY.connect(this._convolverWY),this._mergerZX.connect(this._convolverZX),this._convolverWY.connect(this._splitterWY),this._convolverZX.connect(this._splitterZX),this._splitterWY.connect(this._mergerBinaural,0,0),this._splitterWY.connect(this._mergerBinaural,0,1),this._splitterWY.connect(this._mergerBinaural,1,0),this._splitterWY.connect(this._inverter,1,0),this._inverter.connect(this._mergerBinaural,0,1),this._splitterZX.connect(this._mergerBinaural,0,0),this._splitterZX.connect(this._mergerBinaural,0,1),this._splitterZX.connect(this._mergerBinaural,1,0),this._splitterZX.connect(this._mergerBinaural,1,1),this._convolverWY.normalize=!1,this._convolverZX.normalize=!1,this._inverter.gain.value=-1,this.input=this._splitterWYZX,this.output=this._summingBus}dispose(){this._active&&this.disable(),this._splitterWYZX.disconnect(this._mergerWY,0,0),this._splitterWYZX.disconnect(this._mergerWY,1,1),this._splitterWYZX.disconnect(this._mergerZX,2,0),this._splitterWYZX.disconnect(this._mergerZX,3,1),this._mergerWY.disconnect(this._convolverWY),this._mergerZX.disconnect(this._convolverZX),this._convolverWY.disconnect(this._splitterWY),this._convolverZX.disconnect(this._splitterZX),this._splitterWY.disconnect(this._mergerBinaural,0,0),this._splitterWY.disconnect(this._mergerBinaural,0,1),this._splitterWY.disconnect(this._mergerBinaural,1,0),this._splitterWY.disconnect(this._inverter,1,0),this._inverter.disconnect(this._mergerBinaural,0,1),this._splitterZX.disconnect(this._mergerBinaural,0,0),this._splitterZX.disconnect(this._mergerBinaural,0,1),this._splitterZX.disconnect(this._mergerBinaural,1,0),this._splitterZX.disconnect(this._mergerBinaural,1,1)}setHRIRBufferList(t){this._isBufferLoaded||(this._convolverWY.buffer=t[0],this._convolverZX.buffer=t[1],this._isBufferLoaded=!0)}enable(){this._mergerBinaural.connect(this._summingBus),this._active=!0}disable(){this._mergerBinaural.disconnect(),this._active=!1}}class ri{constructor(t){this._context=t,this._splitter=this._context.createChannelSplitter(4),this._inX=this._context.createGain(),this._inY=this._context.createGain(),this._inZ=this._context.createGain(),this._m0=this._context.createGain(),this._m1=this._context.createGain(),this._m2=this._context.createGain(),this._m3=this._context.createGain(),this._m4=this._context.createGain(),this._m5=this._context.createGain(),this._m6=this._context.createGain(),this._m7=this._context.createGain(),this._m8=this._context.createGain(),this._outX=this._context.createGain(),this._outY=this._context.createGain(),this._outZ=this._context.createGain(),this._merger=this._context.createChannelMerger(4),this._splitter.connect(this._inX,1),this._splitter.connect(this._inY,2),this._splitter.connect(this._inZ,3),this._inX.gain.value=-1,this._inY.gain.value=-1,this._inZ.gain.value=-1,this._inX.connect(this._m0),this._inX.connect(this._m1),this._inX.connect(this._m2),this._inY.connect(this._m3),this._inY.connect(this._m4),this._inY.connect(this._m5),this._inZ.connect(this._m6),this._inZ.connect(this._m7),this._inZ.connect(this._m8),this._m0.connect(this._outX),this._m1.connect(this._outY),this._m2.connect(this._outZ),this._m3.connect(this._outX),this._m4.connect(this._outY),this._m5.connect(this._outZ),this._m6.connect(this._outX),this._m7.connect(this._outY),this._m8.connect(this._outZ),this._splitter.connect(this._merger,0,0),this._outX.connect(this._merger,0,1),this._outY.connect(this._merger,0,2),this._outZ.connect(this._merger,0,3),this._outX.gain.value=-1,this._outY.gain.value=-1,this._outZ.gain.value=-1,this.setRotationMatrix3(ae(ne())),this.input=this._splitter,this.output=this._merger}dispose(){this._splitter.disconnect(this._inX,1),this._splitter.disconnect(this._inY,2),this._splitter.disconnect(this._inZ,3),this._inX.disconnect(this._m0),this._inX.disconnect(this._m1),this._inX.disconnect(this._m2),this._inY.disconnect(this._m3),this._inY.disconnect(this._m4),this._inY.disconnect(this._m5),this._inZ.disconnect(this._m6),this._inZ.disconnect(this._m7),this._inZ.disconnect(this._m8),this._m0.disconnect(this._outX),this._m1.disconnect(this._outY),this._m2.disconnect(this._outZ),this._m3.disconnect(this._outX),this._m4.disconnect(this._outY),this._m5.disconnect(this._outZ),this._m6.disconnect(this._outX),this._m7.disconnect(this._outY),this._m8.disconnect(this._outZ),this._splitter.disconnect(this._merger,0,0),this._outX.disconnect(this._merger,0,1),this._outY.disconnect(this._merger,0,2),this._outZ.disconnect(this._merger,0,3)}setRotationMatrix3(t){this._m0.gain.value=t[0],this._m1.gain.value=t[1],this._m2.gain.value=t[2],this._m3.gain.value=t[3],this._m4.gain.value=t[4],this._m5.gain.value=t[5],this._m6.gain.value=t[6],this._m7.gain.value=t[7],this._m8.gain.value=t[8]}setRotationMatrix4(t){this._m0.gain.value=t[0],this._m1.gain.value=t[1],this._m2.gain.value=t[2],this._m3.gain.value=t[4],this._m4.gain.value=t[5],this._m5.gain.value=t[6],this._m6.gain.value=t[8],this._m7.gain.value=t[9],this._m8.gain.value=t[10]}getRotationMatrix3(){return se(hi,this._m0.gain.value,this._m1.gain.value,this._m2.gain.value,this._m3.gain.value,this._m4.gain.value,this._m5.gain.value,this._m6.gain.value,this._m7.gain.value,this._m8.gain.value),hi}getRotationMatrix4(){return re(Ai,this._m0.gain.value,this._m1.gain.value,this._m2.gain.value,0,this._m3.gain.value,this._m4.gain.value,this._m5.gain.value,0,this._m6.gain.value,this._m7.gain.value,this._m8.gain.value,0,0,0,0,1),Ai}}const hi=ne(),Ai=oe();var ci;!function(t){t[t.Default=0]="Default",t[t.Safari=1]="Safari",t[t.FUMA=2]="FUMA"}(ci||(ci={}));const li={[ci.Default]:[0,1,2,3],[ci.Safari]:[2,0,1,3],[ci.FUMA]:[0,3,1,2]};class ui{constructor(t,e){this._context=t,this._splitter=this._context.createChannelSplitter(4),this._merger=this._context.createChannelMerger(4),this.input=this._splitter,this.output=this._merger,this.setChannelMap(e||ci.Default)}setChannelMap(t){this._channelMap=t instanceof Array?t:li[t],this._splitter.disconnect(),this._splitter.connect(this._merger,0,this._channelMap[0]),this._splitter.connect(this._merger,1,this._channelMap[1]),this._splitter.connect(this._merger,2,this._channelMap[2]),this._splitter.connect(this._merger,3,this._channelMap[3])}dispose(){this._splitter.disconnect(this._merger,0,this._channelMap[0]),this._splitter.disconnect(this._merger,1,this._channelMap[1]),this._splitter.disconnect(this._merger,2,this._channelMap[2]),this._splitter.disconnect(this._merger,3,this._channelMap[3])}}var di=["UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAD+/wIA9v8QAPv/CwD+/wcA/v8MAP//AQD7/wEACAAEAPj/+v8YABAA7v/n//v/9P/M/8D//f34/R38EvzxAfEBtA2lDTcBJQFJ9T71FP0D/cD1tfVo/Wv9uPTO9PPmOufc/U/+agL3Aisc/RxuGKEZBv3j/iYMzQ2gAzsEQQUABiQFrASzA5cB2QmyCy0AtgR4AeYGtfgAA2j5OQHP+scArPsMBJgEggIEBtz6+QVq/pj/aPg8BPP3gQEi+jEAof0fA1v9+/7S+8IBjvwd/xD4IADL/Pf9zvs+/l3+wgB7/+L+7fzFADH9kf6A+n3+DP6+/TP9xP68/pn+w/26/i39YgA0/u790Pt9/kD+7v1s/Wb+8f4C/1P+pf/x/cT+6/3p/Xz9ff5F/0f9G/4r/6v/4P5L/sL+ff7c/pj+Ov7X/UT+9P5G/oz+6v6A/2D+9/6P/8r/bP7m/ij+C//e/tj/Gf4e/9v+FwDP/lz/sP7F/2H+rv/G/s7/Hf7y/4P+NAD9/k0AK/6w/zP/hACh/sX/gf44AOP+dgCm/iUAk/5qAOD+PwC+/jEAWP4CAAr/bQBw/vv/zf5iACD/OgCS/uD/Cv9oAAb/CgDK/kwA//5tACH/TgCg/h4AHP9aABP/JADP/hEAYv9gAAj/3f8m/ysAYv8gACX/8/8k/ysAXv8bABH//v8j/ygAa/8qAAD/9f9g/1YAWf8JACH/AgB2/z4AXP/w/z3/FgB2/ykAX//9/z//EwCV/zUAS//n/1T/GACK/x4ATv/0/4P/QQB4//v/WP/2/3X/HAB8//P/V//3/2f/AQBh/9v/Tf/x/5P/IwCI/wMAf/8hAKP/JACZ/xUAiv8nAK//HgCr/yMAm/8uAMz/OACi/yQAqf87AMT/MwCY/yUAtP9FAMH/KgCu/ycAyP85AMv/IwCz/xoA1f8qAMn/FgC8/xQA4/8nAMX/CwDJ/xQA4f8ZAMH/BgDO/xQA4f8WAMP/BwDU/xQA4P8QAMH/AQDb/xQA3P8JAMP/AgDh/xIA2v8EAMj/AgDk/w0A1f/+/8v/AwDm/wwA0v/+/9H/BgDl/wkAzv/8/9T/BwDk/wcAzv/8/9r/CQDi/wQAzf/8/9//CADf////0P/9/+L/BwDd//7/0////+T/BgDb//z/1f8AAOf/BQDZ//v/2v8CAOb/AwDY//v/3v8EAOb/AgDY//3/4f8FAOX/AQDZ//7/5P8GAOP/AADb/wAA5/8GAOH////d/wIA5/8FAOD////f/wMA6P8FAOD////h/wQA6P8EAN7////h/wUA4v8DANv/AQDd/wQA3P8CANn/AgDb/wMA2/8CANv/AgDd/wIA3v8CAOH/AQDj/wEA","UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAAAAAAA/f8CAP//AQD//wEA//8BAP3/AAACAP7/+f8AAAIA/P8FAAQA8/8AABoA+f/V/wQAHQDO/xoAQQBO/ocA0Px1/ucHW/4UCm8HLO6kAjv8/fCRDdAAYfPiBIgFXveUCM0GBvh6/nz7rf0J/QcQSRVdBgoBSgFR62r9NP8m+LoEAvriBVAAiAPmABEGMf2l+SwBjva6/G4A//8P/CYDMgXm/R0CKAE6/fcBBwAtAND+kQA0A5UDhwFs/8IB8fydAEP/A/8v/e7/mP8j/2YBIwE3Av0AYv+uAOD8lgAg/wwAIf/L/n0Ae//OAJMB3P/XAF//XwCM/08AB/8NAEf/rf4jAT3/lgAJAP4AHgDpAO8AUf9L/07/Qf8KAOD/x/+D/3sATQCDAMoA0f79/+L/EQDt/7EAqv+S/7IAuv/o/wgAc//X//H/SwCm/+3/Yf/B/yoAAADI/7X/AwBg/5EATgCX/xYA/P+q/00AVACY/6v/BADD/zwALQCN/8z/KQDu/ygAEgCZ/6f/VQDC//T/KQCs/7P/UgAfAO7/NgC8/57/awAZAPP/+P/V/8z/bQBBAL//DgD0/+T/TABBAMz/CwAxAPz/SQBqALn/BgALAPz/EAA7AIz/3/8iAAUA//8kALf/y/9VABQA+v81AOj/0P9cAB4A+f8WAOr/vv83ABgAw/8JAOj/4f8nACIAsf/y/w4A3v8gACQAxP/n/ycA7P8WAC0Ayf/U/ycA9v/7/yUA0P/P/zUABADc/xUA5P/J/zcACwDS/xUA9P/m/zAACQDX/+3/9v/2/yQACgDZ/+P/AwAKABYA///b/9j/EQALABkADgD6/+7/GwD4/w4A8P/w//j/EgAEAAUA9f/1/wQAGgD4/wAA5////wAAGQD1////7f8FAAUAFQDv/wAA6v8LAAcAFQDs/wEA9P8SAAYACwDr//7/AQASAAYABQDv/wIAAwAWAAIAAgDv/wAABgATAAEA/f/u/wQABgAQAPr/+P/z/wUACQALAPj/9//4/wgABwAKAPT/+f/5/w4ABwAIAPT/+//9/w4AAwADAPH//f///w8A//8BAPP///8BAA0A/f/+//X/AgACAA0A+//8//b/BAADAAoA+f/7//n/BgADAAcA+P/7//v/BwABAAQA+P/8//3/CQABAAIA9//9////CQD/////+P///wAACAD9//7/+f8AAAAABwD8//3/+v8CAAAABgD7//z//P8EAAAABAD6//3//P8FAP//AgD6//7//v8FAP7/AQD7//////8GAP7/AAD7/wEA//8EAP3/AAD9/wEA/v8DAP3/AAD9/wIA/v8CAP3/AQD9/wIA/v8CAP7/AQD+/wEA"];class gi{constructor(t,e){if(this.context=t,this.config=Object.assign({channelMap:ci.Default,renderingMode:Pe.Ambisonic},e),this.config.channelMap instanceof Array&&4!==this.config.channelMap.length)throw new Error("FOARenderer: Invalid channel map. (got "+this.config.channelMap+")");if(this.config.hrirPathList&&2!==this.config.hrirPathList.length)throw new Error("FOARenderer: Invalid HRIR URLs. It must be an array with 2 URLs to HRIR files. (got "+this.config.hrirPathList+")");this.buildAudioGraph()}buildAudioGraph(){this.input=this.context.createGain(),this.output=this.context.createGain(),this.bypass=this.context.createGain(),this.router=new ui(this.context,this.config.channelMap),this.rotator=new ri(this.context),this.convolver=new oi(this.context),this.input.connect(this.router.input),this.input.connect(this.bypass),this.router.output.connect(this.rotator.input),this.rotator.output.connect(this.convolver.input),this.convolver.output.connect(this.output),this.input.channelCount=4,this.input.channelCountMode="explicit",this.input.channelInterpretation="discrete"}dispose(){this.getRenderingMode()===Pe.Bypass&&this.bypass.connect(this.output),this.input.disconnect(this.router.input),this.input.disconnect(this.bypass),this.router.output.disconnect(this.rotator.input),this.rotator.output.disconnect(this.convolver.input),this.convolver.output.disconnect(this.output),this.convolver.dispose(),this.rotator.dispose(),this.router.dispose()}async initialize(){const t=this.config.hrirPathList?new ai(this.context,this.config.hrirPathList,{dataType:si.URL}):new ai(this.context,di,{dataType:si.BASE64});try{const e=await t.load();this.convolver.setHRIRBufferList(e),this.setRenderingMode(this.config.renderingMode)}catch(t){const e=`FOARenderer: HRIR loading/decoding (mode: ${this.config.renderingMode}) failed. Reason: ${t.message}`;throw new Error(e)}}setChannelMap(t){t.toString()!==this.config.channelMap.toString()&&(ni("Remapping channels (["+this.config.channelMap.toString()+"] -> ["+t.toString()+"])."),this.config.channelMap=t instanceof Array?t.slice():t,this.router.setChannelMap(this.config.channelMap))}setRotationMatrix3(t){this.rotator.setRotationMatrix3(t)}setRotationMatrix4(t){this.rotator.setRotationMatrix4(t)}getRenderingMode(){return this.config.renderingMode}setRenderingMode(t){if(t!==this.config.renderingMode){switch(t){case Pe.Ambisonic:this.convolver.enable(),this.bypass.disconnect();break;case Pe.Bypass:this.convolver.disable(),this.bypass.connect(this.output);break;case Pe.None:this.convolver.disable(),this.bypass.disconnect();break;default:c(t)}this.config.renderingMode=t}}}class pi{constructor(t,e,i){this._active=!1,this._isBufferLoaded=!1,this._context=t,this._ambisonicOrder=e,this._numberOfChannels=(this._ambisonicOrder+1)*(this._ambisonicOrder+1),this._buildAudioGraph(),i&&this.setHRIRBufferList(i),this.enable()}_buildAudioGraph(){const t=Math.ceil(this._numberOfChannels/2);this._inputSplitter=this._context.createChannelSplitter(this._numberOfChannels),this._stereoMergers=[],this._convolvers=[],this._stereoSplitters=[],this._positiveIndexSphericalHarmonics=this._context.createGain(),this._negativeIndexSphericalHarmonics=this._context.createGain(),this._inverter=this._context.createGain(),this._binauralMerger=this._context.createChannelMerger(2),this._outputGain=this._context.createGain();for(let e=0;e<t;++e)this._stereoMergers[e]=this._context.createChannelMerger(2),this._convolvers[e]=this._context.createConvolver(),this._stereoSplitters[e]=this._context.createChannelSplitter(2),this._convolvers[e].normalize=!1;for(let t=0;t<=this._ambisonicOrder;++t)for(let e=-t;e<=t;e++){const i=t*t+t+e,n=Math.floor(i/2);this._inputSplitter.connect(this._stereoMergers[n],i,i%2),this._stereoMergers[n].connect(this._convolvers[n]),this._convolvers[n].connect(this._stereoSplitters[n]),e>=0?this._stereoSplitters[n].connect(this._positiveIndexSphericalHarmonics,i%2):this._stereoSplitters[n].connect(this._negativeIndexSphericalHarmonics,i%2)}this._positiveIndexSphericalHarmonics.connect(this._binauralMerger,0,0),this._positiveIndexSphericalHarmonics.connect(this._binauralMerger,0,1),this._negativeIndexSphericalHarmonics.connect(this._binauralMerger,0,0),this._negativeIndexSphericalHarmonics.connect(this._inverter),this._inverter.connect(this._binauralMerger,0,1),this._inverter.gain.value=-1,this.input=this._inputSplitter,this.output=this._outputGain}dispose(){this._active&&this.disable();for(let t=0;t<=this._ambisonicOrder;++t)for(let e=-t;e<=t;e++){const i=t*t+t+e,n=Math.floor(i/2);this._inputSplitter.disconnect(this._stereoMergers[n],i,i%2),this._stereoMergers[n].disconnect(this._convolvers[n]),this._convolvers[n].disconnect(this._stereoSplitters[n]),e>=0?this._stereoSplitters[n].disconnect(this._positiveIndexSphericalHarmonics,i%2):this._stereoSplitters[n].disconnect(this._negativeIndexSphericalHarmonics,i%2)}this._positiveIndexSphericalHarmonics.disconnect(this._binauralMerger,0,0),this._positiveIndexSphericalHarmonics.disconnect(this._binauralMerger,0,1),this._negativeIndexSphericalHarmonics.disconnect(this._binauralMerger,0,0),this._negativeIndexSphericalHarmonics.disconnect(this._inverter),this._inverter.disconnect(this._binauralMerger,0,1)}setHRIRBufferList(t){if(!this._isBufferLoaded){for(let e=0;e<t.length;++e)this._convolvers[e].buffer=t[e];this._isBufferLoaded=!0}}enable(){this._binauralMerger.connect(this._outputGain),this._active=!0}disable(){this._binauralMerger.disconnect(),this._active=!1}}function mi(t,e){return t===e?1:0}function fi(t,e,i){return(i+t)*(2*t+1)+(e+t)}function vi(t,e,i,n,s){const a=fi(e,i,n);t[e-1][a].gain.value=s}function wi(t,e,i,n){const s=fi(e,i,n);return t[e-1][s].gain.value}function Bi(t,e,i,n,s){return n===s?wi(t,1,e,1)*wi(t,s-1,i,s-1)-wi(t,1,e,-1)*wi(t,s-1,i,1-s):n===-s?wi(t,1,e,1)*wi(t,s-1,i,1-s)+wi(t,1,e,-1)*wi(t,s-1,i,s-1):wi(t,1,e,0)*wi(t,s-1,i,n)}function Di(t,e,i,n){return Bi(t,0,e,i,n)}function yi(t,e,i,n){if(0===e)return Bi(t,1,1,i,n)+Bi(t,-1,-1,i,n);if(e>0){const s=mi(e,1);return Bi(t,1,e-1,i,n)*Math.sqrt(1+s)-Bi(t,-1,1-e,i,n)*(1-s)}{const s=mi(e,-1);return Bi(t,1,e+1,i,n)*(1-s)+Bi(t,-1,-e-1,i,n)*Math.sqrt(1+s)}}function Ci(t,e,i,n){return 0===e?0:e>0?Bi(t,1,e+1,i,n)+Bi(t,-1,-e-1,i,n):Bi(t,1,e-1,i,n)-Bi(t,-1,1-e,i,n)}function bi(t,e,i){const n=mi(t,0),s=Math.abs(e)===i?1/(2*i*(2*i-1)):1/((i+e)*(i-e));return le(Ii,Math.sqrt((i+t)*(i-t)*s),.5*(1-2*n)*Math.sqrt((1+n)*(i+Math.abs(t)-1)*(i+Math.abs(t))*s),-.5*(1-n)*Math.sqrt((i-Math.abs(t)-1)*(i-Math.abs(t)))*s),Ii}const Ii=he();function Pi(t,e){for(let i=-e;i<=e;i++)for(let n=-e;n<=e;n++){const s=bi(i,n,e);Math.abs(s[0])>0&&(s[0]*=Di(t,i,n,e)),Math.abs(s[1])>0&&(s[1]*=yi(t,i,n,e)),Math.abs(s[2])>0&&(s[2]*=Ci(t,i,n,e)),vi(t,e,i,n,s[0]+s[1]+s[2])}}function Mi(t){for(let e=2;e<=t.length;e++)Pi(t,e)}class xi{constructor(t,e){this._context=t,this._ambisonicOrder=e;const i=(e+1)*(e+1);this._splitter=this._context.createChannelSplitter(i),this._merger=this._context.createChannelMerger(i),this._gainNodeMatrix=[];for(let t=1;t<=e;t++){const e=t*t,i=2*t+1;this._gainNodeMatrix[t-1]=[];for(let n=0;n<i;n++){const s=e+n;for(let a=0;a<i;a++){const o=e+a,r=n*i+a;this._gainNodeMatrix[t-1][r]=this._context.createGain(),this._splitter.connect(this._gainNodeMatrix[t-1][r],s),this._gainNodeMatrix[t-1][r].connect(this._merger,0,o)}}}this._splitter.connect(this._merger,0,0),this.setRotationMatrix3(ae(ne())),this.input=this._splitter,this.output=this._merger}dispose(){for(let t=1;t<=this._ambisonicOrder;t++){const e=t*t,i=2*t+1;for(let n=0;n<i;n++){const s=e+n;for(let a=0;a<i;a++){const o=e+a,r=n*i+a;this._splitter.disconnect(this._gainNodeMatrix[t-1][r],s),this._gainNodeMatrix[t-1][r].disconnect(this._merger,0,o)}}}this._splitter.disconnect(this._merger,0,0)}setRotationMatrix3(t){this._gainNodeMatrix[0][0].gain.value=t[0],this._gainNodeMatrix[0][1].gain.value=t[1],this._gainNodeMatrix[0][2].gain.value=t[2],this._gainNodeMatrix[0][3].gain.value=t[3],this._gainNodeMatrix[0][4].gain.value=t[4],this._gainNodeMatrix[0][5].gain.value=t[5],this._gainNodeMatrix[0][6].gain.value=t[6],this._gainNodeMatrix[0][7].gain.value=t[7],this._gainNodeMatrix[0][8].gain.value=t[8],Mi(this._gainNodeMatrix)}setRotationMatrix4(t){this._gainNodeMatrix[0][0].gain.value=t[0],this._gainNodeMatrix[0][1].gain.value=t[1],this._gainNodeMatrix[0][2].gain.value=t[2],this._gainNodeMatrix[0][3].gain.value=t[4],this._gainNodeMatrix[0][4].gain.value=t[5],this._gainNodeMatrix[0][5].gain.value=t[6],this._gainNodeMatrix[0][6].gain.value=t[8],this._gainNodeMatrix[0][7].gain.value=t[9],this._gainNodeMatrix[0][8].gain.value=t[10],Mi(this._gainNodeMatrix)}getRotationMatrix3(){return se(Ei,this._gainNodeMatrix[0][0].gain.value,this._gainNodeMatrix[0][1].gain.value,this._gainNodeMatrix[0][2].gain.value,this._gainNodeMatrix[0][3].gain.value,this._gainNodeMatrix[0][4].gain.value,this._gainNodeMatrix[0][5].gain.value,this._gainNodeMatrix[0][6].gain.value,this._gainNodeMatrix[0][7].gain.value,this._gainNodeMatrix[0][8].gain.value),Ei}getRotationMatrix4(){return re(Fi,this._gainNodeMatrix[0][0].gain.value,this._gainNodeMatrix[0][1].gain.value,this._gainNodeMatrix[0][2].gain.value,0,this._gainNodeMatrix[0][3].gain.value,this._gainNodeMatrix[0][4].gain.value,this._gainNodeMatrix[0][5].gain.value,0,this._gainNodeMatrix[0][6].gain.value,this._gainNodeMatrix[0][7].gain.value,this._gainNodeMatrix[0][8].gain.value,0,0,0,0,1),Fi}getAmbisonicOrder(){return this._ambisonicOrder}}const Ei=ne(),Fi=oe();var Si=["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/P////v//P8CAAQA+//+//3//f8CAAUA+v/9//////8AAAQA+v/8////AAD//wIA+//8/wAAAQD+/wEA+//8/wAAAgD9/////P/9/wEAAgD8//7//f/9/wAAAgD8//3//v/+////AQD8//z/////////AAD8//3///8AAP7/AAD9//7///8AAP7////+//////8AAP7////+////////////////////","UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAD//////v8AAP///////wAAAAAAAP7/AQABAAAABwD///X/BQAjAPL/CQDb/9D/GAAb/7sAYwCW/z0BcP/X/7T/2QDW+wH8yANCCCUJ5QT++UXmhPwhA78FuAxH+p78ifudBlAG9vmu/lAK2fdlB///cfjoCa0E7Akn9Yb/zvba+AkAHPywBGEBFwUNAL8AXAAGA20DFvmR/kz+F/06Ag/+GwHl/5EEKgJd/q0AP/ym/9n6EfxY/2H+/QFtAC4C6QBDAaMCo/20/+3/3f/p/fL9rv9V/6cBhQHuAX4AcwJYAaH/IP/P/gsApP0LAe7/sQBuAI0AAgGDAE4BzACe/5X//v+v/+f+Zf+gAOv/5QBhAOIApAANASYAuP+h/8b/HQBr/9//bACWAGEAFAB5AD0AWQDU/+D/Yf/p//D/s/+R/4QAMQBvABEAkQBfABQAJgDW/wwA8/8XALz/vf8zAFAAKwD1/zEAPwDJ/x0A7/8LAOX/FwDR//H/EQAdAO//6P8QAFEA2f8WABEAMgDy/xIA+f/s/xAALgDv////HQAvAPT/+f8iAAYAEgAFABoAGgD//w0A+f/0/xsAHgDx/9f/GAACAPH/8f8JAPf/GwALABEA7/8cAPT/CgD2//j/BQD8/+3/OgAgAAYA9f8PAN7/DgD9/9r/1//3/+3/9//1//b/8//5//f/AgAJAOf/+v8OAAMACwD9/+7/5f8eAAEA9//q//7/8P8WAP7/+//4/wIA+f8TAAIA9f/5/wcA+P8iAAgA9v/n/xoA//8gAAUABwDj/wAA9v8BAAUAFQDn/wMA7v8QABAAEQDm/wwA8f8aAAAABwDu/wcACgASAAEA7//w//f/BgARAAkA6P/3/wcADgAKAAYA4f/4/wYADgAAAPr/8P/9/xQACgAHAPn/7//9/xEAAgD+//L/8v/8/xUAAwDw//H/9f8CAAsA/v/q//L/+f8FAAYA/P/r//j///8GAAkA+//o//j/AQAIAP//+v/o//v/CAAIAPv/+P/w/wEACQAHAPj/+f/0/wIACwAFAPb/+f/4/wQACwACAPP/+f/+/wYACAD///L/+/8BAAYABQD9//P//P8FAAUAAgD7//T//f8HAAQA///7//f///8IAAMA/P/6//r/AQAIAAEA+v/6//3/AgAHAAAA+f/7/wAAAwAFAP7/+P/8/wIAAgACAP3/+f/9/wMAAwAAAPz/+v/+/wQAAgD+//z/+/8AAAQAAQD8//z//f8BAAQAAAD7//3///8BAAMA///7//3/AAACAAEA/v/7//7/AQABAAAA/v/9////AQAAAP///v/+////AAD/////////////////////////////","UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAD////////+//////8AAAAA/v/+/wAAAQD8//3/CQAJAP3/+v8PAAcApABlABkBkwCO/i//lfqa/HQAcf/3BdkCzwJcBCMC0wMN/9/9wgI7AaECYfxV/Tf83vhn/xrt8Owx/8n7cgHABYb43QcZDh4WugNrA7P74gHu/9z/zv0t/acCiQHY/iv4qQOl/ysCE/0//XT9Sf4O//j9xfupAn394gHO+rsCXAFIAxQC9wIXBgcD2AQuAnb/9gJh/6wAVfxEAI4Bvf7oAFv/bALsAMQBe/88/joAT/4dAH39/v9LAXn/gwDI//QBdABcAA0A7f4lAMn///+9/tv/iABp/13/pP/dALv/w/8MAHv//f+y/6////7U/5AAZP+Z/8r/nQDR/5r/DwDr/xAA4v+s/3z/+P9uAOv/t/82AGcAHgCb/yQAFQBGAM7/CgD3/xoAegAaAOz/CgBHAA8Adv8/AAAABQC2/xIAAAA7ABQAKgCj/z4AAQAXAJz/JAADAAcA8f/1/2AAAQAlAPD/NgDx/1wA7v/4/wMAZADv//3/HQAkAFoA8P9FAPv/FgBIAPf/WQAHAEUACQD0/xIAQwDu/wMAwP9VALn/XwCw/yEA5f8sAPj/FgDD/1YAyv8rAOX/HQDo//j/IQAQACAAHwD9/yQAHQBAABgABQAiAAUAKAD3/wkACwAKAAMABwAJAPb/+f8GAOr/JQAHABMA6P8TAA4AGgD//woA8/8ZAP//GADu/w0A9v8SAAMABwD4/wQA5P8XAAQACgDq/wUA+/8VAAcACADs/xIAAAATAPH/+v/1//T/7f///+z/+v/y/+//9/8KAAcACgAJAPT/BAAKAAAABgAIAPL/9v8KAAMABAACAPr/9v8OAAIA+P/x//v/+f8MAPb/+P/w/wQA9f8MAPn////7/woA/v8PAAEAAgD1/xAAAQAPAP//AwD//xQABwALAAAABgADABAAAgAHAAAACAABAA8ABQAFAAMABwAEAA4ABwADAAEACQAFAAoAAwD//wAACQADAAUAAQD/////CAABAAMAAAD/////BwACAAEAAAD/////BwACAP7///8BAAAABgABAP7///8CAAAABAAAAP7///8DAAAAAwAAAP3///8DAAAAAQAAAP3//v8EAAAAAAD+//////8EAP/////+/wAA/v8EAP/////+/wEA/v8EAP///v/+/wIA//8DAP///v/+/wIA//8BAP///v/+/wMA//8BAP/////+/wMA//8AAP//AAD+/wQA//8AAP7/AQD//wIA////////AQD//wIA////////AQAAAAEAAAAAAP//AQD//wEAAAAAAP//AQAAAAEAAAAAAAAA","UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAD+/wAA+v8AAPz/AAD//wAA/f8AAAEAAAD+/wAACQAAAAQAAAAZAAAAtgAAAFsBAABW/gAAH/oAAGcBAABoBwAAlAAAAO3/AAARAQAA+wIAAEoEAACe/gAAiv4AALD0AADJ8wAAkQQAAF34AABi8QAAPQAAAAH2AAD19AAADAMAAJwGAACTEAAA0AwAAJkHAACOBwAAuQEAANcDAAC6AgAAHwUAAHEFAAB0AwAAbgEAADz+AADYAQAAGAAAAJwCAADgAAAA//0AAMn+AAAT/AAAwP8AAOn9AAAJAAAAewEAAOn+AACN/wAAOv0AAO3+AADN/gAAcP8AACj/AACq/gAA+f4AAML9AACa/wAA/f4AAN7/AABo/wAA6/4AAE//AAAC/wAAEQAAAHX/AAB0AAAA5f8AAEwAAAB3AAAA5/8AAMIAAABCAAAAzgAAAE8AAAB3AAAAKAAAADMAAACqAAAALwAAAK4AAAASAAAAVgAAACgAAAAtAAAATAAAAP3/AAA7AAAA2/8AACQAAADw/wAALQAAADEAAAAlAAAAbAAAADMAAABUAAAAEAAAACgAAAD1/wAA9v8AAPr/AADu/wAALgAAABIAAABUAAAARAAAAGUAAABGAAAAOAAAAGAAAAAuAAAARQAAACEAAAAfAAAAAAAAAAkAAAAQAAAAAwAAABIAAADs/wAAEAAAAAYAAAASAAAAIgAAABEAAAADAAAABAAAAA8AAAD4/wAAHQAAAAsAAAAIAAAADgAAAP//AAAcAAAADwAAAAYAAAASAAAAFwAAAAMAAAAYAAAAEgAAAPr/AAAQAAAADQAAAAoAAAD3/wAABgAAAPb/AADf/wAA/v8AAPL/AAD6/wAAFAAAAAQAAAAEAAAAGwAAAAEAAAAMAAAAIAAAAAIAAAAdAAAAGAAAAAIAAAAcAAAAEgAAAAcAAAAeAAAADwAAAAQAAAAeAAAABAAAAAYAAAAZAAAAAQAAAA4AAAATAAAA/v8AAAoAAAAOAAAA+/8AAAsAAAAJAAAA+f8AAAsAAAABAAAA+f8AAAoAAAD9/wAA+v8AAAcAAAD5/wAA+v8AAAUAAAD3/wAA/f8AAAQAAAD2/wAAAAAAAAEAAAD3/wAAAgAAAAAAAAD4/wAAAwAAAP7/AAD6/wAABAAAAP3/AAD8/wAABAAAAPv/AAD+/wAAAwAAAPv/AAD//wAAAQAAAPv/AAAAAAAAAAAAAPv/AAACAAAA//8AAPz/AAACAAAA/v8AAP3/AAACAAAA/f8AAP7/AAABAAAA/f8AAP//AAABAAAA/f8AAAAAAAAAAAAA/v8AAAEAAAAAAAAA//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAA"],ki=["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AAD7/wEAAgD7//7/AQD8/wAAAwD8//3/AwD9/wAAAgD9//z/AwD/////AgD+//z/AwAAAP7/AQD///3/AgABAP3/AAAAAP3/AgACAPz///8BAP3/AQACAP3//v8BAP7/AAABAP3//v8CAP7///8BAP7//f8CAP////8AAAAA/v8CAAAAAAAAAAAA/v8BAAAAAAD//wAA//8AAP//AAD//wAA//8AAP//","UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAAAAP//AAD//wAA//8AAAAA/////wAAAQD+////AAAGAP3/OAABAIIAAwBv//f/E/0QAK0ADQCzA/7/8P4u/0cBDQCJA6ABbQDg/w7/z/9o+Vn/SPnL/1//Ef+2+jr9RfZgA5QFZwILDFj+PAb2/nEFKgKk/R0Dlv6b/FUDsP6YAoj9SgAT/iL/tAPwAv8A0P6zAr7/dwAnAf39uP22/skA2v///2YCoP4UAUsAZgF2AJH+4P70/rz9+f+U/Xv/8v7CAcb+TACS/kwAv/+x/tX9oP71/oL/1f8nAEUAZwGtAAgAIgC/AD4BaP8GAGH/dQDF/64Arf8nAakAhAH9/+kAQQD3AFb/q/8p/yIAR/8FAPD/ZAA/AIYA3v8tADQADQBp/3f/CwABAP3/Wf8OANj/WwDH/xoAe/8DAKz/zv96/z8A3f/J/5X/IAD5//j/q//c/+//RADq//D/vv8pADUAFQDI/y8ACAAbANb/OwD3/+3/9f/e/wcAIAAeAMH/8/8xAC0AEADW/+3/HAADAPv/8P8DAOL/OwD3/xcACQAHAM//5f8XAAcAz//T/9D/HgD9////yf/e//v/AgD//9H/6/////H/+/8hAAIA9//7/w0AFgAQAPL/2v/8/xsAGQABANz/9P8YAAQA/v/y/wMA5v8YAAkAAAAAAAMA7/8KABgADwDs//j/BwATABsA8P/1//z/BAAMAAAA9P/s/xAA/v8GAAkA/v/p/wMACwALAP7/9P/p/wcADQAFAPb/7//4/w0ACAD8//b//v/1/wMACwD1//T/8P/8/wAACQDz/+f/5P8GAAkABQD5//D/+v8FAA0AAwD///T/AgACABAA/v8CAPD/+/8FAAoA9f/3//f//v8GAP7/9v/t//z/+f8AAPj/+v/3/wEA+v8HAPr//P/5/wQA//8DAPr/+P/3/wYA///+//X/+//5/wQA/f/7//X/+//4/wMA/f/8//j//v/9/wYA///8//f/AgAAAAUA/f/6//n/AwACAAIA/f/7//z/AwACAAAA/f/6//3/AgADAP7//f/7/wAAAwAFAPz////8/wMAAgAEAPv//v/+/wMAAgADAPv//v///wMAAQABAPv//f8AAAIAAAD///v//f8BAAIA///+//z//v8CAAIA/v/9//3///8CAAEA/v/9//7/AAACAAAA/v/9////AAABAAAA/f/9/wAAAQABAP///f/+/wEAAQAAAP///v/+/wEAAQD///7//v///wEAAQD///7//v///wEAAAD+//7///8AAAAAAAD+//7///8AAAAA///+//7///8AAAAA////////AAAAAP////////////8AAP//////////","UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAAAAAAAAAABAAAAAAD//////////////v////3/////////+//8////AQD9//z/9f8BAAIA+f8dACgAWQBxAJX/qv+Y/uz9aP9k/7UDUQQBAiQA4Pgi/AkB0gKaBsD/+fxp/vz9CQSp/I/+ywDO+vMD0fzK/PABcgBeBfoBv/+uAuH9Sf5gAy39awMmBWUBuP9fA9/9fgDj/2/+EACaACcCSv9Z/2j/rv7hAA0AWf55/7L84P7E/SIAT/67AMv/tf+FAA7/1v+7/gv/IP+E/sQA+P5aAXz/tP9XAFX/tP8o/4r/j//e/yQAMv9mAJT/rgCr/9X/EwCb//H/9f7F/6D/EAAoAK3//v+e/zsAh/+B/7r/if/C/2r/4P/z/6//HwCy/0IA7/9ZALT/y/80ACgA9v/J/9//DgA5ADUALQARADIACwAfAOf/NgArACMACQBBAEcAGAAjAC4AWQBUAHcAAAAfACEAIAAcAPj/CADk/yQA7v89AEEAFwD5/xYA6f8aAOX/AADF/zQADwAUAOT/BQDr/yUA6P8XAOf/HADR/0AA8P8nAAgACQDt/ycAKAAHAPH/IQDz/xsACADn//n/DgADAA4A8P///8z/GgDN/yMA/f8QANj/MwACAC0ACwAOAO3/JgAZAAUACgAAAA4AIgAaAAkADwACAAAAHQATAAUABQACAAgACwAjAO////8AAA8ABQAPAPL//f8GAAsABgAGAPD/8v8GAPz/CAD6//H/6v8PAAgABgD4//3/9v8aAAgABwD1//7//v8QAAoACAD//wUA9v8QAAoABAAFAAgAAgAJAAoAAwD//w0AAgD//wcA/v8DAAoABQAFABUABAAKAAYABwAHAA8ACgAGAAwADwAMAAkAEAAJAAgADwAMAAgADgAJAAUACQAPAAUACwAHAAEABgAIAAEABAAGAP//AgAJAAAAAgAEAP7///8IAAIA//8GAAEAAQAJAAIA/v8EAAMA//8JAAEA/v8DAAMA/v8HAAMA/f8BAAUA/v8FAAMA/v8BAAcA//8DAAMA/v8BAAYA//8CAAMA/////wcAAAAAAAMAAAD//wYAAQD+/wMAAQD//wUAAQD+/wIAAgD//wQAAgD+/wEAAwD//wMAAwD+/wEAAwD//wIAAwD//wEABAAAAAEABAD//wAABAABAAAAAwAAAAAABAABAP//AwABAAAAAwACAP//AgACAAAAAwACAP//AgACAAAAAgACAAAAAQADAAAAAQACAAAAAQADAAAAAQACAAAAAAACAAEAAAACAAEAAAACAAEAAAABAAEAAAABAAEAAAABAAEAAAABAAEAAAABAAEAAAABAAEAAAAAAAAAAAAAAAAA","UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAAAAP//AAD//wAA//8AAAAA//8AAP//AAACAAAA+f8BAAYA///4/wIA//8AAA8A/v/V/wEAEwA9AAEBRwA2AF7/kfog/3gBwv99CDYBU/qtAUX/AP7OAfkAX/o9B38FSfwaAuT14/60BAr8CQAI/tfyIQTzAXP+egdUBBwBof7TBMT8bAWi/5EEWwBRAAAKyfxE/8b88vp6ACP+PAF4/qD8MQNM/ygCJ/2XAPD9kP5gAVT/iP9I/lEB4P8qAD0BFAGa/+7/DgB2AOP98gFm/u/+Vv5/AG8ASP9gAM//qv9w//oAcv+2/jIBHgA7/6D/oAAGAKH/lADT/wAAggC8AAYAkP9yAEcAkf8BAOD/RAAr/zUANwDt/xQAJQAkAMT/zwA/AOH/xv9zAGsANQBTAIcALAAvACIATACy/xMADADg/xcAWABvAJL/7f9VAPb/EgDt/wcA4f8kAPP/5P+h/wgACQDy//r/LgAQAMn/8/9CAOX/5v/S/9//3P8pABYAuP/s/w8AFgDt/+3/7v/w/9j/5/8GAOf/2P/2//P//v8kABMAuf/m/xoADADZ/+r/3P8KAAUAKwDe/wsA3P8VAAAADgAfAB0ACAAMAF4AGgAhAPL/MwDz/0kABAAKAPX/LwAbAAkA9v/s/+3/8/8CABAAAADm//n/BQALAAUAAQDj//n/JQAVAPX/9v/+/wIAEQABAPP/8P/1/wAABgD6/+3/7//o//j/DAD8/+b/8P8IAAkABgD4//D/8P8UAAoAAwD4/wAA+f8OAAcAAAAFAPX/9v8TAAkA8v8EAPb/9/8dAA0A7/8CAPn/+f8SAAQA8/8CAOf/+v8DAAgA9P////H//P8IAAUA8//0/wIAAQAGAAgA9//7/wAA+/8EAP//+P/+////AgACAAsA8v/+/wIABQD7/wgA9v/7/wMABAD5/wAA/P/3/wEAAQD7//7//P/1/wQA///3//r////3/wMAAwD1//r/AwD6////AgD4//n/AwD8//7/AgD4//n/AwD+//3/AQD4//n/BQD///n/AAD6//j/BAABAPj/AAD9//v/AwADAPj//v/+//z/AwAEAPj//v8BAP7/AQADAPj//f8CAP////8EAPr//P8DAAAA/v8CAPv//P8DAAEA/f8BAP3//f8DAAIA/P8AAP7//f8DAAIA/P///wAA/f8BAAIA+//+/wEA//8AAAEA+//+/wEA/////wEA/P/+/wEA///+/wAA/f/9/wEAAAD9/wAA/f/+/wEAAQD8/////v/+/wAAAQD8////////////AQD9////AAD/////AAD+////AAAAAP//AAD///////8AAP//AAD//wAA//8AAP//"];const Li=[2,3];class _i{constructor(t,e){if(this.context=t,this.config=Object.assign({ambisonicOrder:3,renderingMode:Pe.Ambisonic},e),Li.includes(this.config.ambisonicOrder)||(ni("HOARenderer: Invalid ambisonic order. (got "+this.config.ambisonicOrder+") Fallbacks to 3rd-order ambisonic."),this.config.ambisonicOrder=Math.max(2,Math.min(3,this.config.ambisonicOrder))),this.config.numberOfChannels=(this.config.ambisonicOrder+1)*(this.config.ambisonicOrder+1),this.config.numberOfStereoChannels=Math.ceil(this.config.numberOfChannels/2),this.config.hrirPathList.length!==this.config.numberOfStereoChannels)throw new Error("HOARenderer: Invalid HRIR URLs. It must be an array with "+this.config.numberOfStereoChannels+" URLs to HRIR files. (got "+e.hrirPathList+")");this._buildAudioGraph()}_buildAudioGraph(){this.input=this.context.createGain(),this.output=this.context.createGain(),this.bypass=this.context.createGain(),this.rotator=new xi(this.context,this.config.ambisonicOrder),this.convolver=new pi(this.context,this.config.ambisonicOrder),this.input.connect(this.rotator.input),this.input.connect(this.bypass),this.rotator.output.connect(this.convolver.input),this.convolver.output.connect(this.output),this.input.channelCount=this.config.numberOfChannels,this.input.channelCountMode="explicit",this.input.channelInterpretation="discrete"}dispose(){this.getRenderingMode()===Pe.Bypass&&this.bypass.connect(this.output),this.input.disconnect(this.rotator.input),this.input.disconnect(this.bypass),this.rotator.output.disconnect(this.convolver.input),this.convolver.output.disconnect(this.output),this.rotator.dispose(),this.convolver.dispose()}async initialize(){let t;t=this.config.hrirPathList?new ai(this.context,this.config.hrirPathList,{dataType:si.URL}):2===this.config.ambisonicOrder?new ai(this.context,Si):new ai(this.context,ki);try{const e=await t.load();this.convolver.setHRIRBufferList(e),this.setRenderingMode(this.config.renderingMode)}catch(t){const e=`HOARenderer: HRIR loading/decoding (mode: ${this.config.renderingMode}) failed. Reason: ${t.message}`;throw new Error(e)}}setRotationMatrix3(t){this.rotator.setRotationMatrix3(t)}setRotationMatrix4(t){this.rotator.setRotationMatrix4(t)}getRenderingMode(){return this.config.renderingMode}setRenderingMode(t){if(t!==this.config.renderingMode){switch(t){case Pe.Ambisonic:this.convolver.enable(),this.bypass.disconnect();break;case Pe.Bypass:this.convolver.disable(),this.bypass.connect(this.output);break;case Pe.None:this.convolver.disable(),this.bypass.disconnect();break;default:c(t)}this.config.renderingMode=t}}}class Ti{constructor(t,e){e=Object.assign({ambisonicOrder:1,position:ce(he(),Le),forward:ce(he(),Te),up:ce(he(),Oe),renderingMode:Qe},e),this.position=he(),this.tempMatrix3=ne(),this.ambisonicOrder=ii.validateAmbisonicOrder(e.ambisonicOrder),1==this.ambisonicOrder?this.renderer=function(t,e){return new gi(t,e)}(t,{renderingMode:e.renderingMode}):this.ambisonicOrder>1&&(this.renderer=function(t,e){return new _i(t,e)}(t,{ambisonicOrder:this.ambisonicOrder,renderingMode:e.renderingMode})),this.input=t.createGain(),this.output=t.createGain(),this.ambisonicOutput=t.createGain(),this.renderer.initialize().then((()=>{this.input.connect(this.renderer.input),this.renderer.rotator.output.connect(this.ambisonicOutput),this.renderer.output.connect(this.output)})),this.setOrientation(e.forward,e.up)}getRenderingMode(){return this.renderer.getRenderingMode()}setRenderingMode(t){this.renderer.setRenderingMode(t)}dispose(){this.input.disconnect(this.renderer.input),this.renderer.rotator.output.disconnect(this.ambisonicOutput),this.renderer.output.disconnect(this.output),this.renderer.dispose()}setOrientation(t,e){ce(Oi,t),ce(Ri,e),me(Ui,Oi,Ri),se(this.tempMatrix3,Ui[0],Ui[1],Ui[2],Ri[0],Ri[1],Ri[2],-Oi[0],-Oi[1],-Oi[2]),this.renderer.setRotationMatrix3(this.tempMatrix3)}}const Oi=he(),Ri=he(),Ui=he();class Qi{constructor(t,e){this.listenerPosition=ce(he(),Le),this.speedOfSound=Re,this.coefficients={left:Ne.left,right:Ne.right,front:Ne.front,back:Ne.back,up:Ne.up,down:Ne.down},this.halfDimensions={width:.5*He.width,height:.5*He.height,depth:.5*He.depth},e&&(l(e?.speedOfSound)&&(this.speedOfSound=e.speedOfSound),h(e?.listenerPosition)&&3===e.listenerPosition.length&&l(e.listenerPosition[0])&&l(e.listenerPosition[1])&&l(e.listenerPosition[2])&&(this.listenerPosition[0]=e.listenerPosition[0],this.listenerPosition[1]=e.listenerPosition[1],this.listenerPosition[2]=e.listenerPosition[2])),this.input=t.createGain(),this.output=t.createGain(),this.lowpass=t.createBiquadFilter(),this.merger=t.createChannelMerger(4),this.delays={left:t.createDelay(2),right:t.createDelay(2),front:t.createDelay(2),back:t.createDelay(2),up:t.createDelay(2),down:t.createDelay(2)},this.gains={left:t.createGain(),right:t.createGain(),front:t.createGain(),back:t.createGain(),up:t.createGain(),down:t.createGain()},this.inverters={right:t.createGain(),back:t.createGain(),down:t.createGain()};for(const t of Object.values(ke)){const e=this.delays[t],i=this.gains[t];e.delayTime.value=0,i.gain.value=0,this.delays[t]=e,this.gains[t]=i,this.lowpass.connect(e),e.connect(i),i.connect(this.merger,0,0),t!==ke.Right&&t!=ke.Back&&t!==ke.Down||(this.inverters[t].gain.value=-1)}this.input.connect(this.lowpass),this.lowpass.type="lowpass",this.lowpass.frequency.value=6400,this.lowpass.Q.value=0,this.gains.left.connect(this.merger,0,1),this.gains.right.connect(this.inverters.right),this.inverters.right.connect(this.merger,0,1),this.gains.up.connect(this.merger,0,2),this.gains.down.connect(this.inverters.down),this.inverters.down.connect(this.merger,0,2),this.gains.front.connect(this.merger,0,3),this.gains.back.connect(this.inverters.back),this.inverters.back.connect(this.merger,0,3),this.merger.connect(this.output),this.setRoomProperties(e?.dimensions,e?.coefficients)}setRoomProperties(t,e){null==t&&(t={width:He.width,height:He.height,depth:He.depth}),l(t.width)&&l(t.height)&&l(t.depth)&&(this.halfDimensions.width=.5*t.width,this.halfDimensions.height=.5*t.height,this.halfDimensions.depth=.5*t.depth),null==e&&(e={left:Ne.left,right:Ne.right,front:Ne.front,back:Ne.back,up:Ne.up,down:Ne.down}),l(e.left)&&l(e.right)&&l(e.front)&&l(e.back)&&l(e.up)&&l(e.down)&&(this.coefficients.left=e.left,this.coefficients.right=e.right,this.coefficients.front=e.front,this.coefficients.back=e.back,this.coefficients.up=e.up,this.coefficients.down=e.down),this.setListenerPosition(this.listenerPosition)}dispose(){this.input.disconnect(this.lowpass);for(const t of Object.values(ke)){const e=this.delays[t],i=this.gains[t];this.lowpass.disconnect(e),e.disconnect(i),i.disconnect(this.merger,0,0)}this.gains.left.disconnect(this.merger,0,1),this.gains.right.disconnect(this.inverters.right),this.inverters.right.disconnect(this.merger,0,1),this.gains.up.disconnect(this.merger,0,2),this.gains.down.disconnect(this.inverters.down),this.inverters.down.disconnect(this.merger,0,2),this.gains.front.disconnect(this.merger,0,3),this.gains.back.disconnect(this.inverters.back),this.inverters.back.disconnect(this.merger,0,3),this.merger.disconnect(this.output)}setListenerPosition(t){ce(this.listenerPosition,t);for(const t of Object.values(ke)){const e=this.halfDimensions[$e[t]],i=this.listenerPosition[ti[t]],n=ei[t],s=1*Math.max(0,e+n*i)+1,a=s/this.speedOfSound;this.delays[t].delayTime.value=a;const o=this.coefficients[t]/s;this.gains[t].gain.value=o}}}class Ni{constructor(t,e){const i=(e=Object.assign({durations:je.slice(),predelay:1.5,gain:.01,bandwidth:1,tailonset:3.8},e)).predelay/1e3;this.bandwidthCoeff=.346573590279973*e.bandwidth,this.tailonsetSamples=e.tailonset/1e3,this.context=t,this.input=t.createGain(),this.predelay=t.createDelay(i),this.convolver=t.createConvolver(),this.output=t.createGain(),this.output.gain.value=e.gain,this.convolver.normalize=!1,this.input.connect(this.predelay),this.predelay.connect(this.convolver),this.convolver.connect(this.output),this.setDurations(e.durations)}dispose(){this.input.disconnect(this.predelay),this.predelay.disconnect(this.convolver),this.convolver.disconnect(this.output)}setDurations(t){if(t.length!==Ge)return void qe("Warning: invalid number of RT60 values provided to reverb.");const e=new Float32Array(Ge),i=this.context.sampleRate;for(let n=0;n<t.length;n++)t[n]=Math.max(0,Math.min(3,t[n])),e[n]=Math.round(t[n]*i*1);let n=0;for(let t=0;t<e.length;t++)e[t]>n&&(n=e[t]);n<1&&(n=1);const s=this.context.createBuffer(1,n,i),a=s.getChannelData(0),o=new Float32Array(n);for(let t=0;t<n;t++)o[t]=2*Math.random()-1;for(let t=0;t<Ge;t++){const n=-6.90775527898214/e[t],s=Xe*ze[t]/i,r=Math.sin(s),h=r*Math.sinh(this.bandwidthCoeff*s/r),A=1/(1+h),c=h*A,l=-2*Math.cos(s)*A,u=(1-h)*A;let d=0,g=0;for(let i=0;i<e[t];i++){const t=o[i]*Math.exp(n*i)-l*d-u*g;a[i]+=c*(t-g),g=d,d=t}}const r=Math.round(this.tailonsetSamples);for(let t=0;t<Math.min(a.length,r);t++){const e=.5*(1-Math.cos(Xe*t/(2*r-1)));a[t]*=e}this.convolver.buffer=s}}function Hi(t){const e={[ke.Left]:null,[ke.Right]:null,[ke.Front]:null,[ke.Back]:null,[ke.Up]:null,[ke.Down]:null};for(const t of Object.values(ke)){const i=Ze[t];e[t]=Ve[i]}null==t&&(t=Object.assign({},t,Ze));for(const i of Object.values(ke))t[i]in Ve?e[i]=Ve[t[i]]:qe('Material "'+t[i]+'" on wall "'+i+'" not found. Using "'+Ze[i]+'".');return e}function zi(t){if(null==t)t={width:He.width,height:He.height,depth:He.depth};else for(const e of Object.values(Se))t.hasOwnProperty(e)||(t[e]=He[e]);return t}function Gi(t,e,i){const n=new Float32Array(Ge);t=zi(t),e=function(t){null==t&&(t={[ke.Left]:null,[ke.Right]:null,[ke.Front]:null,[ke.Back]:null,[ke.Up]:null,[ke.Down]:null});for(const e of Object.values(ke))t.hasOwnProperty(e)||(t[e]=Ve[Ze[e]]);return t}(e),null==i&&(i=Re);const s=55.2620422318571/i,a=t.width*t.height*t.depth;if(a<1e-4)return n;const o=t.width*t.height,r=t.width*t.depth,h=t.depth*t.height,A=2*(o+r+h);for(let t=0;t<Ge;t++){const i=((e.left[t]+e.right[t])*o+(e.down[t]+e.up[t])*r+(e.front[t]+e.back[t])*h)/A;n[t]=1.38*s*a/(-A*Math.log(1-i)+4*Ye[t]*a)}return n}function ji(t){const e={[ke.Left]:0,[ke.Right]:0,[ke.Front]:0,[ke.Back]:0,[ke.Up]:0,[ke.Down]:0};for(const i of Object.values(ke))if(Ne.hasOwnProperty(i)){e[i]=0;for(let n=0;n<3;n++){const s=n+4;e[i]+=t[i][s]}e[i]/=3,e[i]=Math.sqrt(1-e[i])}return e}class Wi{constructor(t,e){(e=Object.assign({listenerPosition:ce(he(),Le),dimensions:Object.assign({},e.dimensions,He),materials:Object.assign({},e.materials,Ze),speedOfSound:Re},e)).dimensions=zi(e.dimensions);const i=Hi(e.materials),n=ji(i),s=Gi(e.dimensions,i,e.speedOfSound);this.early=new Qi(t,{dimensions:e.dimensions,coefficients:n,speedOfSound:e.speedOfSound,listenerPosition:e.listenerPosition}),this.late=new Ni(t,{durations:s}),this.speedOfSound=e.speedOfSound,this.output=t.createGain(),this.early.output.connect(this.output),this._merger=t.createChannelMerger(4),this.late.output.connect(this._merger,0,0),this._merger.connect(this.output)}dispose(){this.early.output.disconnect(this.output),this.late.output.disconnect(this._merger,0,0),this._merger.disconnect(this.output)}setProperties(t,e){const i=Hi(e),n=Gi(t,i,this.speedOfSound);this.late.setDurations(n),this.early.speedOfSound=this.speedOfSound;const s=ji(i);this.early.setRoomProperties(t,s)}setListenerPosition(t){this.early.speedOfSound=this.speedOfSound,this.early.setListenerPosition(t);const e=this.getDistanceOutsideRoom(t);let i=1;e>Ke&&(i=1-e/1,i=Math.max(0,Math.min(1,i))),this.output.gain.value=i}getDistanceOutsideRoom(t){const e=Math.max(0,-this.early.halfDimensions.width-t[0],t[0]-this.early.halfDimensions.width),i=Math.max(0,-this.early.halfDimensions.height-t[1],t[1]-this.early.halfDimensions.height),n=Math.max(0,-this.early.halfDimensions.depth-t[2],t[2]-this.early.halfDimensions.depth);return Math.sqrt(e*e+i*i+n*n)}}class Vi{constructor(t,e){this.minDistance=1,this.maxDistance=1e3,this.rolloff=Ue,e&&(l(e.minDistance)&&(this.minDistance=e.minDistance),l(e.maxDistance)&&(this.maxDistance=e.maxDistance),e.rolloff&&(this.rolloff=e.rolloff)),this.setRolloff(this.rolloff),this.gainNode=t.createGain(),this.setDistance(this.maxDistance),this.input=this.gainNode,this.output=this.gainNode}setDistance(t){let e=1;if("logarithmic"==this.rolloff){if(t>this.maxDistance)e=0;else if(t>this.minDistance){let i=this.maxDistance-this.minDistance;if(i>Ke){let n=1/(i+1);e=(1/(t-this.minDistance+1)-n)/(1-n)}}}else if("linear"==this.rolloff)if(t>this.maxDistance)e=0;else if(t>this.minDistance){let i=this.maxDistance-this.minDistance;i>Ke&&(e=(this.maxDistance-t)/i)}this.gainNode.gain.value=e}setRolloff(t){null==t&&(t=Ue),this.rolloff=t}}const Zi=he(),Yi=he();class Xi{constructor(t,e){this.cosTheta=0,e=Object.assign({alpha:0,sharpness:1},e),this.context=t,this.lowpass=t.createBiquadFilter(),this.lowpass.type="lowpass",this.lowpass.Q.value=0,this.lowpass.frequency.value=.5*t.sampleRate,this.setPattern(e.alpha,e.sharpness),this.input=this.lowpass,this.output=this.lowpass}computeAngle(t,e){pe(Zi,t),pe(Yi,e);let i=1;if(this.alpha>Ke){let t=(s=Yi,(n=Zi)[0]*s[0]+n[1]*s[1]+n[2]*s[2]);i=1-this.alpha+this.alpha*t,i=Math.pow(Math.abs(i),this.sharpness)}var n,s;this.lowpass.frequency.value=.5*this.context.sampleRate*i}setPattern(t,e){this.alpha=Math.min(1,Math.max(0,t)),this.sharpness=Math.max(1,e),this.computeAngle(le(Zi,this.cosTheta*this.cosTheta,0,0),le(Yi,1,0,0))}}class Ji{constructor(t,e){e=Object.assign({position:ce(he(),Le),forward:ce(he(),Te),up:ce(he(),Oe),minDistance:1,maxDistance:1e3,rolloff:Ue,gain:1,alpha:0,sharpness:1,sourceWidth:0},e),this.scene=t,this.position=e.position,this.forward=e.forward,this.up=e.up,this.dx=he(),this.right=he(),me(this.right,this.forward,this.up);let i=t.context;this.input=i.createGain(),this.directivity=new Xi(i,{alpha:e.alpha,sharpness:e.sharpness}),this.toEarly=i.createGain(),this.toLate=i.createGain(),this.attenuation=new Vi(i,{minDistance:e.minDistance,maxDistance:e.maxDistance,rolloff:e.rolloff}),this.encoder=new ii(i,{ambisonicOrder:t.ambisonicOrder,sourceWidth:e.sourceWidth}),this.input.connect(this.toLate),this.toLate.connect(t.room.late.input),this.input.connect(this.attenuation.input),this.attenuation.output.connect(this.toEarly),this.toEarly.connect(t.room.early.input),this.attenuation.output.connect(this.directivity.input),this.directivity.output.connect(this.encoder.input),this.encoder.output.connect(t.listener.input),this.setPosition(e.position),this.input.gain.value=e.gain}dispose(){this.encoder.output.disconnect(this.scene.listener.input),this.directivity.output.disconnect(this.encoder.input),this.attenuation.output.disconnect(this.directivity.input),this.toEarly.disconnect(this.scene.room.early.input),this.attenuation.output.disconnect(this.toEarly),this.input.disconnect(this.attenuation.input),this.toLate.disconnect(this.scene.room.late.input),this.input.disconnect(this.toLate),this.encoder.dispose()}update(){de(this.dx,this.position,this.scene.listener.position);const t=Ae(this.dx);pe(this.dx,this.dx);const e=Je*Math.atan2(-this.dx[0],this.dx[2]),i=Je*Math.atan2(this.dx[1],Math.sqrt(this.dx[0]*this.dx[0]+this.dx[2]*this.dx[2]));this.attenuation.setDistance(t),this.directivity.computeAngle(this.forward,this.dx),this.encoder.setDirection(e,i)}setRolloff(t){this.attenuation.setRolloff(t)}setMinDistance(t){this.attenuation.minDistance=t}setMaxDistance(t){this.attenuation.maxDistance=t}setGain(t){this.input.gain.value=t}setPosition(t){ce(this.position,t);let e=function(t){let e=1;return t>Ke&&(e=1-t/1,e=Math.max(0,Math.min(1,e))),e}(this.scene.room.getDistanceOutsideRoom(this.position));this.toLate.gain.value=e,this.toEarly.gain.value=e,this.update()}setOrientation(t,e){ce(this.forward,t),ce(this.up,e),me(this.right,this.forward,this.up)}setSourceWidth(t){this.encoder.setSourceWidth(t),this.setPosition(this.position)}setDirectivityPattern(t,e){this.directivity.setPattern(t,e),this.setPosition(this.position)}}class Ki{constructor(t,e){e=Object.assign({ambisonicOrder:1,listenerPosition:ce(he(),Le),listenerForward:ce(he(),Te),listenerUp:ce(he(),Oe),dimensions:Object.assign({},e.dimensions,He),materials:Object.assign({},e.materials,Ze),speedOfSound:Re,renderingMode:Qe},e),this.ambisonicOrder=ii.validateAmbisonicOrder(e.ambisonicOrder),this._sources=new Array,this.room=new Wi(t,{listenerPosition:e.listenerPosition,dimensions:e.dimensions,materials:e.materials,speedOfSound:e.speedOfSound}),this.listener=new Ti(t,{ambisonicOrder:e.ambisonicOrder,position:e.listenerPosition,forward:e.listenerForward,up:e.listenerUp,renderingMode:e.renderingMode}),this.context=t,this.output=t.createGain(),this.ambisonicOutput=t.createGain(),this.ambisonicInput=this.listener.input,this.room.output.connect(this.listener.input),this.listener.output.connect(this.output),this.listener.ambisonicOutput.connect(this.ambisonicOutput)}getRenderingMode(){return this.listener.getRenderingMode()}setRenderingMode(t){this.listener.setRenderingMode(t)}dispose(){this.room.output.disconnect(this.listener.input),this.listener.output.disconnect(this.output),this.listener.ambisonicOutput.disconnect(this.ambisonicOutput)}createSource(t){let e=new Ji(this,t);return this._sources[this._sources.length]=e,e}removeSource(t){const e=this._sources.findIndex((e=>e===t));e>-1&&(this._sources.splice(e,1),t.dispose())}setAmbisonicOrder(t){this.ambisonicOrder=ii.validateAmbisonicOrder(t)}setRoomProperties(t,e){this.room.setProperties(t,e)}setListenerPosition(t){ce(this.listener.position,t),this.room.setListenerPosition(t),this._sources.forEach((function(t){t.update()}))}setListenerOrientation(t,e){this.listener.setOrientation(t,e)}setSpeedOfSound(t){this.room.speedOfSound=t}}class qi extends qt{constructor(t,e,i,n){super(t,e,i),this.node=n,this.gain.connect(this.node)}dispose(){this.node&&(this.node.disconnect(),this.node=null),super.dispose()}}class $i extends qi{constructor(t,e,i,n){const s=n.createSource(void 0);super(t,e,i,s.input),this.resScene=n,this.resNode=s,Object.seal(this)}update(t,e){const{p:i,f:n,u:s}=t;this.resNode.setPosition(i),this.resNode.setOrientation(n,s)}setAudioProperties(t,e,i,n,s){super.setAudioProperties(t,e,i,n,s),this.resNode.setMinDistance(this.minDistance),this.resNode.setMaxDistance(this.maxDistance),this.resNode.setGain(1/this.rolloff),this.resNode.setRolloff(this.algorithm)}dispose(){this.resScene.removeSource(this.resNode),this.resNode=null,super.dispose()}}class tn extends qt{constructor(t,e,i,n){super(t,e,i),this.gain.connect(n),Object.seal(this)}update(t,e){}}class en extends Kt{constructor(t,e){super(t),this.gain.connect(e)}createSpatializer(t,e,i,n){if(i)throw new Error("Can't spatialize with the base listener.");return new tn(t,e,n,this.gain)}}class nn extends en{constructor(t,e){super(t,e),this.scene=new Ki(t,{ambisonicOrder:1,renderingMode:Pe.Bypass}),this.scene.output.connect(this.gain),this.scene.setRoomProperties({width:10,height:5,depth:10},{[ke.Left]:We.Transparent,[ke.Right]:We.Transparent,[ke.Front]:We.Transparent,[ke.Back]:We.Transparent,[ke.Down]:We.Grass,[ke.Up]:We.Transparent}),Object.seal(this)}update(t,e){const{p:i,f:n,u:s}=t;this.scene.setListenerPosition(i),this.scene.setListenerOrientation(n,s)}createSpatializer(t,e,i,n){return i?new $i(t,e,n,this.scene):super.createSpatializer(t,e,i,n)}}const sn=he();class an extends qt{constructor(t,e,i,n,s){super(t,e,i),this.listener=s,this.gain.connect(n),Object.seal(this)}update(t,e){const i=this.listener.pose.p;we(sn,i,t.p);let n=Ft(Be(Ae(sn),this.minDistance,this.maxDistance),0,1);"logarithmic"===this.algorithm&&(n=Math.sqrt(n));const s=1-n;this.gain.gain.setValueAtTime(s,e)}}class on extends en{constructor(t,e){super(t,e),this.pose=null,this.gain.gain.value=.25,Object.seal(this)}update(t,e){this.pose=t}createSpatializer(t,e,i,n){return i?new an(t,e,n,this.gain,this):super.createSpatializer(t,e,i,n)}}class rn extends qi{constructor(t,e,i,n){const s=i.createPanner();super(t,e,i,s),this.node.panningModel="HRTF",this.node.distanceModel="inverse",this.node.coneInnerAngle=360,this.node.coneOuterAngle=0,this.node.coneOuterGain=0,this.node.connect(n)}setAudioProperties(t,e,i,n,s){super.setAudioProperties(t,e,i,n,s),this.node.refDistance=this.minDistance,"logarithmic"===this.algorithm&&(n="inverse"),this.node.distanceModel=n,this.node.rolloffFactor=this.rolloff}}class hn extends rn{constructor(t,e,i,n){super(t,e,i,n),Object.seal(this)}update(t,e){const{p:i,f:n}=t;this.node.positionX.setValueAtTime(i[0],e),this.node.positionY.setValueAtTime(i[1],e),this.node.positionZ.setValueAtTime(i[2],e),this.node.orientationX.setValueAtTime(-n[0],e),this.node.orientationY.setValueAtTime(-n[1],e),this.node.orientationZ.setValueAtTime(-n[2],e)}}class An extends en{constructor(t,e){super(t,e),this.node=t.listener,this.volume=.75}dispose(){this.node=null,super.dispose()}}class cn extends An{constructor(t,e){super(t,e),Object.seal(this)}update(t,e){const{p:i,f:n,u:s}=t;this.node.positionX.setValueAtTime(i[0],e),this.node.positionY.setValueAtTime(i[1],e),this.node.positionZ.setValueAtTime(i[2],e),this.node.forwardX.setValueAtTime(n[0],e),this.node.forwardY.setValueAtTime(n[1],e),this.node.forwardZ.setValueAtTime(n[2],e),this.node.upX.setValueAtTime(s[0],e),this.node.upY.setValueAtTime(s[1],e),this.node.upZ.setValueAtTime(s[2],e)}createSpatializer(t,e,i,n){return i?new hn(t,e,n,this.gain):super.createSpatializer(t,e,i,n)}}class ln extends rn{constructor(t,e,i,n){super(t,e,i,n),Object.seal(this)}update(t,e){const{p:i,f:n}=t;this.node.setPosition(i[0],i[1],i[2]),this.node.setOrientation(n[0],n[1],n[2])}}class un extends An{constructor(t,e){super(t,e),Object.seal(this)}update(t,e){const{p:i,f:n,u:s}=t;this.node.setPosition(i[0],i[1],i[2]),this.node.setOrientation(n[0],n[1],n[2],s[0],s[1],s[2])}createSpatializer(t,e,i,n){return i?new ln(t,e,n,this.gain):super.createSpatializer(t,e,i,n)}}!("AudioContext"in globalThis)&&"webkitAudioContext"in globalThis&&(globalThis.AudioContext=globalThis.webkitAudioContext),!("OfflineAudioContext"in globalThis)&&"webkitOfflineAudioContext"in globalThis&&(globalThis.OfflineAudioContext=globalThis.webkitOfflineAudioContext);const dn=new Xt,gn=new p("audioReady"),pn=J(),mn="createMediaStreamTrackSource"in AudioContext.prototype,fn=!mn&&!("createMediaStreamSource"in AudioContext.prototype),vn=new Map([["wav",["audio/wav","audio/vnd.wave","audio/wave","audio/x-wav"]],["mp3",["audio/mpeg"]],["m4a",["audio/mp4"]],["m4b",["audio/mp4"]],["3gp",["audio/mp4"]],["3g2",["audio/mp4"]],["aac",["audio/aac","audio/aacp"]],["oga",["audio/ogg"]],["ogg",["audio/ogg"]],["spx",["audio/ogg"]],["webm",["audio/webm"]],["flac",["audio/flac"]]]);let wn="AudioContext"in globalThis,Bn="AudioListener"in globalThis,Dn=Bn&&"setPosition"in AudioListener.prototype,yn=Bn&&"positionX"in AudioListener.prototype,Cn=Bn;var bn,In,Pn,Mn;!function(t){t.Low="volumescale",t.Medium="webaudiopanner",t.High="resonance"}(bn||(bn={}));class xn extends m{constructor(t,e){super(),this.minDistance=1,this.maxDistance=10,this.rolloff=1,this._algorithm="logarithmic",this.transitionTime=.5,this._offsetRadius=0,this.clips=new Map,this.users=new Map,this.analysers=new Map,this.sortedUserIDs=new Array,this.localUserID=null,this.listener=null,this.audioContext=null,this.element=null,this.destination=null,this._audioOutputDeviceID=null,this.fetcher=t||new Yt,this.type=e||bn.Medium,this.onAudioActivity=t=>{dn.id=t.id,dn.isActive=t.isActive,this.dispatchEvent(dn)},this.createContext(),Object.seal(this)}get offsetRadius(){return this._offsetRadius}set offsetRadius(t){this._offsetRadius=t,this.updateUserOffsets()}get algorithm(){return this._algorithm}addEventListener(t,e,i=null){t===gn.type&&this.ready?e(gn):super.addEventListener(t,e,i)}get ready(){return this.audioContext&&"running"===this.audioContext.state}async start(){await this.audioContext.resume(),await this.setAudioOutputDeviceID(this._audioOutputDeviceID),this.element&&await this.element.play()}update(){if(this.audioContext){const t=this.currentTime;for(const e of this.clips.values())e.update(t);for(const e of this.users.values())e.update(t);for(const t of this.analysers.values())t.update()}}createContext(){if(!this.audioContext){if(this.audioContext=new AudioContext,Ie?(this.destination=this.audioContext.createMediaStreamDestination(),this.element=J(k,D,_(this.destination.stream),H(G("none"))),document.body.appendChild(this.element)):this.destination=this.audioContext.destination,this.type===bn.High)if(wn&&Bn&&Cn)try{this.listener=new nn(this.audioContext,this.destination)}catch(t){Cn=!1,this.type=bn.Medium,console.warn("Resonance Audio API not available!",t)}else this.type=bn.Medium;if(this.type===bn.Medium)if(wn&&Bn){if(yn)try{this.listener=new cn(this.audioContext,this.destination)}catch(t){yn=!1,console.warn("No AudioListener.positionX property!",t)}if(!yn&&Dn)try{this.listener=new un(this.audioContext,this.destination)}catch(t){Dn=!1,console.warn("No WebAudio API!",t)}yn||Dn||(this.type=bn.Low,Bn=!1)}else this.type=bn.Low;if(this.type===bn.Low&&(this.listener=new on(this.audioContext,this.destination)),null===this.listener)throw new Error("Calla requires a functioning WebAudio system.");this.ready?(this.start(),this.dispatchEvent(gn)):function(t,e){const i=u(e)?v:e,n=async e=>{if(e.isTrusted&&await i()){for(const t of f)window.removeEventListener(t,n);t()}};for(const t of f)window.addEventListener(t,n)}((()=>this.dispatchEvent(gn)),(async()=>(await this.start(),this.ready)))}}getAudioOutputDeviceID(){return this.element?.sinkId}async setAudioOutputDeviceID(t){this._audioOutputDeviceID=t||"",this.element&&this._audioOutputDeviceID!==this.element.sinkId&&await this.element.setSinkId(this._audioOutputDeviceID)}createSpatializer(t,e,i){if(!this.listener)throw new Error("Audio context isn't ready");return this.listener.createSpatializer(t,e,i,this.audioContext)}get currentTime(){return this.audioContext.currentTime}createUser(t){let e=this.users.get(t);return e||(e=new be(t),this.users.set(t,e),d(this.sortedUserIDs,t),this.updateUserOffsets()),e}createLocalUser(t){this.localUserID=t;let i=null,n=null;for(const t of this.users.entries())if(t[1].spatializer===this.listener){[i,n]=t;break}return n?(this.users.delete(i),e(this.sortedUserIDs,i),this.users.set(t,n),d(this.sortedUserIDs,t),this.updateUserOffsets()):(n=this.createUser(t),n.spatializer=this.listener),n}async createClip(t,e,i,n,s,a,o){if(null==a||0===a.length)throw new Error("No clip source path provided");let r=null;if(function(t){const e=t.lastIndexOf(".");if(e>-1){const i=t.substring(e+1);if(vn.has(i)){for(const t of vn.get(i))if(pn.canPlayType(t))return!0;return!1}}return!0}(a)){const t=await this.fetcher.getBlob(a,o);pn.canPlayType(t.type)&&(r=t)}else o&&o(1,1,"skip");if(!r)throw new Error("Cannot play file: "+a);const h=await r.arrayBuffer(),A=await this.audioContext.decodeAudioData(h),c=this.audioContext.createBufferSource();c.buffer=A,c.loop=e;const l=new be("audio-clip-"+t);return l.spatializer=this.createSpatializer(t,c,n),l.spatializer.volume=s,i&&l.spatializer.play(),this.clips.set(t,l),l}hasClip(t){return this.clips.has(t)}async playClip(t){if(this.ready&&this.hasClip(t)){const e=this.clips.get(t);await e.spatializer.play()}}stopClip(t){if(this.ready&&this.hasClip(t)){this.clips.get(t).spatializer.stop()}}getSource(t,e){return t.get(e)||null}getUser(t){return this.getSource(this.users,t)}getClip(t){return this.getSource(this.clips,t)}removeSource(t,e){t.has(e)&&Zt(t.get(e),(i=>{i.spatializer&&i.spatializer.stop(),t.delete(e)}))}removeUser(t){this.removeSource(this.users,t),e(this.sortedUserIDs,t),this.updateUserOffsets()}removeClip(t){this.removeSource(this.clips,t)}createSourceFromStream(t){if(mn){const e=t.getAudioTracks().map((t=>this.audioContext.createMediaStreamTrackSource(t)));if(0===e.length)throw new Error("No audio tracks!");if(1===e.length)return e[0];{const t=this.audioContext.createChannelMerger(e.length);for(const i of e)i.connect(t);return t}}{const e=J(k(!0),D(!0),F(!fn),function(t){return new B("controls",t,"audio","video")}(!1),H(G("none")),_(t));return document.body.appendChild(e),e.play(),fn?this.audioContext.createMediaElementSource(e):this.audioContext.createMediaStreamSource(t)}}async setUserStream(t,e){if(this.users.has(t)){this.analysers.has(t)&&Zt(this.analysers.get(t),(e=>{this.analysers.delete(t),e.removeEventListener("audioActivity",this.onAudioActivity)}));const i=this.users.get(t);if(i.spatializer=null,e){await w((()=>e.active));const n=this.createSourceFromStream(e);i.spatializer=this.createSpatializer(t,n,!0),i.spatializer.setAudioProperties(this.minDistance,this.maxDistance,this.rolloff,this.algorithm,this.transitionTime);const s=new ee(i,this.audioContext,1024);s.addEventListener("audioActivity",this.onAudioActivity),this.analysers.set(t,s)}}}updateUserOffsets(){if(this.offsetRadius>0){const t=this.sortedUserIDs.indexOf(this.localUserID),e=2*Math.PI/this.sortedUserIDs.length,i=(t+1)*e,n=this.offsetRadius*Math.sin(i),s=this.offsetRadius*(Math.cos(i)-1);for(let t=0;t<this.sortedUserIDs.length;++t){const i=this.sortedUserIDs[t],a=(t+1)*e,o=this.offsetRadius*Math.sin(a)-n,r=this.offsetRadius*(Math.cos(a)-1)-s;this.setUserOffset(i,o,0,r)}}}setAudioProperties(t,e,i,n,s){this.minDistance=t,this.maxDistance=e,this.transitionTime=s,this.rolloff=i,this._algorithm=n;for(const t of this.users.values())t.spatializer&&t.spatializer.setAudioProperties(this.minDistance,this.maxDistance,this.rolloff,this.algorithm,this.transitionTime)}withPose(t,e,i,n){if(t.has(e)){const s=t.get(e).pose;return null==i&&(i=this.transitionTime),n(s,i)}return null}withUser(t,e,i){return this.withPose(this.users,t,e,i)}setUserOffset(t,e,i,n){this.withUser(t,null,(t=>{t.setOffset(e,i,n)}))}getUserOffset(t){return this.withUser(t,null,(t=>t.offset))}setUserPose(t,e,i,n,s,a,o,r,h,A,c=null){this.withUser(t,c,((t,c)=>{t.setTarget(e,i,n,s,a,o,r,h,A,this.currentTime,c)}))}withClip(t,e,i){return this.withPose(this.clips,t,e,i)}setClipPosition(t,e,i,n,s=null){this.withClip(t,s,((t,s)=>{t.setTargetPosition(e,i,n,this.currentTime,s)}))}setClipOrientation(t,e,i,n,s,a,o,r=null){this.withClip(t,r,((t,r)=>{t.setTargetOrientation(e,i,n,s,a,o,this.currentTime,r)}))}setClipPose(t,e,i,n,s,a,o,r,h,A,c=null){this.withClip(t,c,((t,c)=>{t.setTarget(e,i,n,s,a,o,r,h,A,this.currentTime,c)}))}}!function(t){t.Disconnected="Disconnected",t.Connecting="Connecting",t.Connected="Connected",t.Disconnecting="Disconnecting"}(In||(In={}));class En{constructor(t,e,i=null){this.value=t,this.desc=e,this.value=t,this.desc=e,this.props=i||{}}contains(t){return t instanceof En?this.contains(t.value):this.value.indexOf(t)>=0}}class Fn extends Event{constructor(t){super(t),this.eventType=t}}class Sn extends Fn{constructor(){super("serverConnected")}}class kn extends Fn{constructor(){super("serverDisconnected")}}class Ln extends Fn{constructor(){super("serverFailed")}}class _n extends Fn{constructor(t,e){super(t),this.id=e}}class Tn extends _n{constructor(t,e,i){super(t,e),this.displayName=i}}class On extends _n{constructor(t,e){super("conferenceJoined",t),this.pose=e}}class Rn extends _n{constructor(t){super("conferenceLeft",t)}}class Un extends Fn{constructor(){super("conferenceFailed")}}class Qn extends Tn{constructor(t,e,i){super("participantJoined",t,e),this.source=i}}class Nn extends _n{constructor(t){super("participantLeft",t)}}class Hn extends Tn{constructor(t,e){super("userNameChanged",t,e)}}class zn extends _n{constructor(t,e,i){super(t,e),this.muted=i}}class Gn extends zn{constructor(t,e){super("audioMuteStatusChanged",t,e)}}class jn extends zn{constructor(t,e){super("videoMuteStatusChanged",t,e)}}!function(t){t.Audio="audio",t.Video="video"}(Pn||(Pn={})),function(t){t.Added="added",t.Removed="removed",t.Changed="changed"}(Mn||(Mn={}));class Wn extends _n{constructor(t,e,i,n,s){super(t,n),this.kind=e,this.op=i,this.stream=s}}class Vn extends Wn{constructor(t,e,i,n){super(t,e,Mn.Added,i,n)}}class Zn extends Wn{constructor(t,e,i,n){super(t,e,Mn.Removed,i,n)}}class Yn extends Vn{constructor(t,e){super("audioAdded",Pn.Audio,t,e)}}class Xn extends Zn{constructor(t,e){super("audioRemoved",Pn.Audio,t,e)}}class Jn extends Vn{constructor(t,e){super("videoAdded",Pn.Video,t,e)}}class Kn extends Zn{constructor(t,e){super("videoRemoved",Pn.Video,t,e)}}class qn extends _n{constructor(t,e,i,n,s,a,o,r,h,A,c){super(t,e),this.px=i,this.py=n,this.pz=s,this.fx=a,this.fy=o,this.fz=r,this.ux=h,this.uy=A,this.uz=c}set(t,e,i,n,s,a,o,r,h){this.px=t,this.py=e,this.pz=i,this.fx=n,this.fy=s,this.fz=a,this.ux=o,this.uy=r,this.uz=h}}class $n extends qn{constructor(t,e,i,n,s,a,o,r,h,A){super("userPosed",t,e,i,n,s,a,o,r,h,A)}}class ts extends qn{constructor(t,e,i,n,s,a,o,r,h,A,c){super("userPointer",t,i,n,s,a,o,r,h,A,c),this.name=e}}class es extends _n{constructor(t,e,i){super(t,e),this.emoji=i instanceof En?i.value:i}}class is extends es{constructor(t,e){super("emote",t,e)}}class ns extends es{constructor(t,e){super("setAvatarEmoji",t,e)}}class ss extends _n{constructor(t,e){super("avatarChanged",t),this.url=e}}class as extends _n{constructor(t,e){super("chat",t),this.text=e}}class os extends m{constructor(t){super(),this.sleepTime=t,this.tasks=new Map}async getNext(t,e){return new Promise((i=>{const n=s=>{s instanceof _n&&s.id===e&&(this.removeEventListener(t,n),i(s))};this.addEventListener(t,n)}))}get isConnected(){return this.metadataState===In.Connected}async callThrottled(t,e,...i){if(!this.tasks.has(t)){const s=performance.now(),a=this.callInternal(e,...i);this.tasks.set(t,a),await a;const o=performance.now()-s;this.sleepTime-o>0&&await(n=this.sleepTime,new Promise((t=>{setTimeout(t,n)}))),this.tasks.delete(t)}var n}async callImmediate(t,...e){await this.callInternal(t,...e)}setLocalPose(t,e,i,n,s,a,o,r,h){this.callThrottled("userPosed","userPosed",t,e,i,n,s,a,o,r,h)}setLocalPoseImmediate(t,e,i,n,s,a,o,r,h){this.callImmediate("userPosed",t,e,i,n,s,a,o,r,h)}setLocalPointer(t,e,i,n,s,a,o,r,h,A){this.callThrottled("userPointer"+t,"userPointer",t,e,i,n,s,a,o,r,h,A)}setAvatarEmoji(t){this.callImmediate("setAvatarEmoji",t)}setAvatarURL(t){this.callImmediate("avatarChanged",t)}emote(t){this.callImmediate("emote",t)}chat(t){this.callImmediate("chat",t)}}const rs="Calla";class hs extends os{constructor(t){super(250),this.tele=t,this._status=In.Disconnected,this.remoteUserIDs=new Array,this.tele.addEventListener("participantJoined",(t=>{d(this.remoteUserIDs,t.id,!1)})),this.tele.addEventListener("participantLeft",(t=>{e(this.remoteUserIDs,t.id)}))}get metadataState(){return this._status}async connect(){}async join(t){this._status=In.Connecting,this.tele.conference.addEventListener(JitsiMeetJS.events.conference.ENDPOINT_MESSAGE_RECEIVED,((t,e)=>{if(e.hax===rs){const i=t.getId(),n=e.command,s=e.values;switch(n){case"avatarChanged":this.dispatchEvent(new ss(i,s[0]));break;case"emote":this.dispatchEvent(new is(i,s[0]));break;case"setAvatarEmoji":this.dispatchEvent(new ns(i,s[0]));break;case"userPosed":this.dispatchEvent(new $n(i,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8]));break;case"userPointer":this.dispatchEvent(new ts(i,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9]));break;case"chat":this.dispatchEvent(new as(i,s[0]));break;default:c(n)}}})),await ut(this.tele.conference,JitsiMeetJS.events.conference.DATA_CHANNEL_OPENED),this._status=In.Connected}async leave(){this._status=In.Disconnected}async identify(t){}async disconnect(){}sendJitsiHax(t,e,...i){this.tele.conference.sendMessage({hax:rs,command:e,values:i},t)}callInternal(t,...e){for(const i of this.remoteUserIDs)this.sendJitsiHax(i,t,...e);return Promise.resolve()}async stopInternal(){this._status=In.Disconnecting,await w((()=>this.metadataState===In.Disconnected))}}function As(t,...e){for(const i of e)for(const e of t)if(i(e))return e;return null}"chrome"in globalThis&&navigator.userAgent.match("CriOS");const cs="InstallTrigger"in globalThis,ls=(/^((?!chrome|android).)*safari/i.test(navigator.userAgent),/Opera/.test(navigator.userAgent),/Android/.test(navigator.userAgent),/iPad|iPhone|iPod/.test(navigator.platform)||/Macintosh(.*?) FxiOS(.*?)\//.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>2),us=(/BlackBerry/.test(navigator.userAgent),/(UC Browser |UCWEB)/.test(navigator.userAgent),/Mobile VR/.test(navigator.userAgent),/oculus/.test(navigator.userAgent)),ds=(us&&/pacific/.test(navigator.userAgent),us&&/quest/.test(navigator.userAgent));function gs(t,e){t.addEventListener(e,((...t)=>{ws&&console.log(">== CALLA ==<",e,...t)}))}const ps="calla:preferredAudioOutputID",ms="calla:preferredAudioInputID",fs="calla:preferredVideoInputID",vs="local-user";let ws="localhost"===window.location.hostname||/\bdebug\b/.test(window.location.search);class Bs extends m{constructor(t,e){super(),this.localUserID=null,this.localUserName=null,this.roomName=null,this._prepared=!1,this._connectionState=In.Disconnected,this._conferenceState=In.Disconnected,this.hasAudioPermission=!1,this.hasVideoPermission=!1,this.fetcher=t||new Yt,this.audio=e||new xn(t,ds?bn.High:bn.Medium),this.addEventListener("serverConnected",this.setConnectionState.bind(this,In.Connected)),this.addEventListener("serverFailed",this.setConnectionState.bind(this,In.Disconnected)),this.addEventListener("serverDisconnected",this.setConnectionState.bind(this,In.Disconnected)),this.addEventListener("conferenceJoined",this.setConferenceState.bind(this,In.Connected)),this.addEventListener("conferenceFailed",this.setConferenceState.bind(this,In.Disconnected)),this.addEventListener("conferenceRestored",this.setConferenceState.bind(this,In.Connected)),this.addEventListener("conferenceLeft",this.setConferenceState.bind(this,In.Disconnected))}toggleLogging(){ws=!ws}get connectionState(){return this._connectionState}setConnectionState(t){this._connectionState=t}get conferenceState(){return this._conferenceState}setConferenceState(t){this._conferenceState=t}dispatchEvent(t){return t instanceof _n&&(null==t.id||"local"===t.id)&&(this.localUserID===vs?t.id=null:t.id=this.localUserID),super.dispatchEvent(t)}async getNext(t,e){return new Promise((i=>{const n=s=>{s instanceof _n&&s.id===e&&(this.removeEventListener(t,n),i(s))};this.addEventListener(t,n)}))}get preferredAudioInputID(){return localStorage.getItem(ms)}set preferredAudioInputID(t){localStorage.setItem(ms,t)}get preferredVideoInputID(){return localStorage.getItem(fs)}set preferredVideoInputID(t){localStorage.setItem(fs,t)}async setPreferredDevices(){await this.setPreferredAudioInput(!0),await this.setPreferredVideoInput(!1),await this.setPreferredAudioOutput(!0)}async getPreferredAudioInput(t){return As(await this.getAudioInputDevices(),(t=>t.deviceId===this.preferredAudioInputID),(t=>"communications"===t.deviceId),(t=>"default"===t.deviceId),(e=>t&&e.deviceId.length>0))}async setPreferredAudioInput(t){const e=await this.getPreferredAudioInput(t);e&&await this.setAudioInputDevice(e)}async getPreferredVideoInput(t){return As(await this.getVideoInputDevices(),(t=>t.deviceId===this.preferredVideoInputID),(e=>t&&e&&/front/i.test(e.label)),(e=>t&&e.deviceId.length>0))}async setPreferredVideoInput(t){const e=await this.getPreferredVideoInput(t);e&&await this.setVideoInputDevice(e)}async getDevices(){let t=null;for(let e=0;e<3;++e){t=await navigator.mediaDevices.enumerateDevices();for(const e of t)e.deviceId.length>0&&(this.hasAudioPermission=this.hasAudioPermission||"audioinput"===e.kind&&e.label.length>0,this.hasVideoPermission=this.hasVideoPermission||"videoinput"===e.kind&&e.label.length>0);if(this.hasAudioPermission)break;try{await navigator.mediaDevices.getUserMedia({audio:!this.hasAudioPermission,video:!this.hasVideoPermission})}catch(t){console.warn(t)}}return t||[]}async getMediaPermissions(){return await this.getDevices(),{audio:this.hasAudioPermission,video:this.hasVideoPermission}}async getAvailableDevices(t=!1){let e=await this.getDevices();return t&&(e=function(t){const e=[];for(let i=0;i<t.length;++i){const n=t[i];let s=!1;for(let t=0;t<e.length&&!s;++t){const i=e[t];s=n.kind===i.kind&&i.label.indexOf(n.label)>0}s||e.push(n)}return e}(e)),{audioOutput:Ie?e.filter((t=>"audiooutput"===t.kind)):[],audioInput:e.filter((t=>"audioinput"===t.kind)),videoInput:e.filter((t=>"videoinput"===t.kind))}}async getAudioInputDevices(t=!1){const e=await this.getAvailableDevices(t);return e&&e.audioInput||[]}async getVideoInputDevices(t=!1){const e=await this.getAvailableDevices(t);return e&&e.videoInput||[]}async setAudioOutputDevice(t){Ie&&(this.preferredAudioOutputID=t&&t.deviceId||null)}async getAudioOutputDevices(t=!1){if(!Ie)return[];const e=await this.getAvailableDevices(t);return e&&e.audioOutput||[]}async getCurrentAudioOutputDevice(){if(!Ie)return null;const t=this.audio.getAudioOutputDeviceID(),e=(await this.getAudioOutputDevices()).filter((e=>null!=t&&e.deviceId===t||null==t&&e.deviceId===this.preferredAudioOutputID));return 0===e.length?null:e[0]}get preferredAudioOutputID(){return localStorage.getItem(ps)}set preferredAudioOutputID(t){localStorage.setItem(ps,t)}async getPreferredAudioOutput(t){return As(await this.getAudioOutputDevices(),(t=>t.deviceId===this.preferredAudioOutputID),(t=>"communications"===t.deviceId),(t=>"default"===t.deviceId),(e=>t&&e.deviceId.length>0))}async setPreferredAudioOutput(t){const e=await this.getPreferredAudioOutput(t);e&&await this.setAudioOutputDevice(e)}async setAudioInputDevice(t){this.preferredAudioInputID=t&&t.deviceId||null}async setVideoInputDevice(t){this.preferredVideoInputID=t&&t.deviceId||null}async connect(){this.setConnectionState(In.Connecting)}async join(t,e){this.setConferenceState(In.Connecting)}async leave(){this.setConferenceState(In.Disconnecting)}async disconnect(){this.setConnectionState(In.Disconnecting)}}function Ds(t){try{return decodeURIComponent(t)}catch(e){return t}}class ys extends Bs{constructor(t,e){super(t,e),this.usingDefaultMetadataClient=!1,this.host=null,this.bridgeHost=null,this.bridgeMUC=null,this.connection=null,this.conference=null,this.tracks=new Map,this.listenersForObjs=new Map}_on(t,e,i){let n=this.listenersForObjs.get(t);n||this.listenersForObjs.set(t,n=new Map);let s=n.get(e);s||n.set(e,s=new Array),s.push(i),t.addEventListener(e,i)}_off(t){const e=this.listenersForObjs.get(t);if(e){this.listenersForObjs.delete(t);for(const[i,n]of e.entries()){for(const e of n)t.removeEventListener(i,e);Jt(n)}e.clear()}}getDefaultMetadataClient(){return this.usingDefaultMetadataClient=!0,new hs(this)}async prepare(t,e,i,n){if(!this._prepared){this.host=t,this.bridgeHost=e,this.bridgeMUC=i,console.info("Connecting to:",this.host);const s=xt(n,2);await this.fetcher.loadScript("https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js",(()=>"jQuery"in globalThis),s.shift()),await this.fetcher.loadScript(`https://${this.host}/libs/lib-jitsi-meet.min.js`,(()=>"JitsiMeetJS"in globalThis),s.shift()),JitsiMeetJS.setLogLevel(JitsiMeetJS.logLevels.ERROR),JitsiMeetJS.init(),this._prepared=!0}}async connect(){await super.connect();const t=JitsiMeetJS.events.connection;this.connection=new JitsiMeetJS.JitsiConnection(null,null,{hosts:{domain:this.bridgeHost,muc:this.bridgeMUC},serviceUrl:`https://${this.host}/http-bind`});for(const e of Object.values(t))gs(this.connection,e);const e=()=>{this.connection&&(this._off(this.connection),this.connection=null)},i=(t,e,i)=>{this._on(this.connection,t,(()=>{this.dispatchEvent(new e),i&&i()}))};i(t.CONNECTION_ESTABLISHED,Sn),i(t.CONNECTION_DISCONNECTED,kn,e),i(t.CONNECTION_FAILED,Ln,e);const n=ut(this.connection,t.CONNECTION_ESTABLISHED);this.connection.connect(),await n}async join(t,e){await super.join(t,e);const i=t.toLocaleLowerCase();if(i!==this.roomName){this.conference&&await this.leave(),this.roomName=i,this.conference=this.connection.initJitsiConference(this.roomName,{openBridgeChannel:this.usingDefaultMetadataClient,p2p:{enabled:!1},startVideoMuted:!0});const n=JitsiMeetJS.events.conference;for(const t of Object.values(n))"conference.audioLevelsChanged"!==t&&gs(this.conference,t);const s=(t,e,i)=>{this._on(this.conference,t,(()=>{this.dispatchEvent(new e),i&&i(t)}))},a=async e=>{if(this.localUserID=vs,this.tracks.size>0){console.warn("><> CALLA <>< ---- there are leftover conference tracks");for(const t of this.tracks.keys())await this.tryRemoveTrack(t,Pn.Video),await this.tryRemoveTrack(t,Pn.Audio),this.dispatchEvent(new Nn(t))}this.dispatchEvent(new Rn(this.localUserID)),this.conference&&(this._off(this.conference),this.conference=null),console.info(`Left room '${t}'. Reason: ${e}.`)};s(n.CONFERENCE_ERROR,Un,a),s(n.CONFERENCE_FAILED,Un,a),s(n.CONNECTION_INTERRUPTED,Un,a),this._on(this.conference,n.CONFERENCE_JOINED,(async()=>{const t=this.conference.myUserId();t&&(this.localUserID=t,this.dispatchEvent(new On(t,null)))})),this._on(this.conference,n.CONFERENCE_LEFT,(()=>a(n.CONFERENCE_LEFT))),this._on(this.conference,n.USER_JOINED,((t,e)=>{this.dispatchEvent(new Qn(t,Ds(e.getDisplayName()),null))})),this._on(this.conference,n.USER_LEFT,(t=>{this.dispatchEvent(new Nn(t))})),this._on(this.conference,n.DISPLAY_NAME_CHANGED,((t,e)=>{this.dispatchEvent(new Hn(t,Ds(e)))}));const o=(t,e)=>{const i=t.getParticipantId()||this.localUserID,n=t.getType()===Pn.Audio?new Gn(i,e):new jn(i,e);this.dispatchEvent(n)};this._on(this.conference,n.TRACK_ADDED,(t=>{const e=t.getParticipantId()||this.localUserID,i=t.getType(),n=i===Pn.Audio?new Yn(e,t.stream):new Jn(e,t.stream);let s=this.tracks.get(e);s||(s=new Map,this.tracks.set(e,s));const a=s.get(i);if(a){const t=Pn.Audio?new Xn(e,a.stream):new Kn(e,a.stream);this.dispatchEvent(t),a.dispose()}s.set(i,t),this.dispatchEvent(n),t.addEventListener(JitsiMeetJS.events.track.TRACK_MUTE_CHANGED,(t=>{o(t,t.isMuted())})),o(t,!1)})),this._on(this.conference,n.TRACK_REMOVED,(t=>{Zt(t,(e=>{const i=t.getParticipantId()||this.localUserID,n=t.getType(),s=Pn.Audio?new Xn(i,t.stream):new Kn(i,t.stream);o(t,!0),this.dispatchEvent(s);const a=this.tracks.get(i);if(a){const e=a.get(n);e&&(a.delete(n),0===a.size&&this.tracks.delete(i),e!==t&&e.dispose())}}))}));const r=ut(this,"conferenceJoined");this.conference.join(e),await r}}async identify(t){this.localUserName=t,this.conference.setDisplayName(function(t){try{return encodeURIComponent(t)}catch(e){return t}}(t))}async tryRemoveTrack(t,e){const i=this.tracks.get(t),n=e===Pn.Video?Kn:Xn;if(i){const s=i.get(e);if(s){this.dispatchEvent(new n(t,s.stream)),i.delete(e);try{this.conference&&s.isLocal&&this.conference.removeTrack(s)}catch(t){console.warn(t)}finally{s.dispose()}}0===i.size&&this.tracks.delete(t)}}async leave(){await super.leave();try{await this.tryRemoveTrack(this.localUserID,Pn.Video),await this.tryRemoveTrack(this.localUserID,Pn.Audio);const t=ut(this,"conferenceLeft");this.conference.leave(),await t}catch(t){console.warn("><> CALLA <>< ---- Failed to leave teleconference.",t)}}async disconnect(){await super.disconnect(),this.conferenceState===In.Connected&&await this.leave();const t=ut(this,"serverDisconnected");this.connection.disconnect(),await t}userExists(t){return this.conference&&this.conference.participants&&t in this.conference.participants}getUserNames(){return this.conference?Object.keys(this.conference.participants).map((t=>[t,Ds(this.conference.participants[t].getDisplayName())])):[]}getCurrentMediaTrack(t){if(this.localUserID===vs)return null;const e=this.tracks.get(this.localUserID);return e?e.get(t):null}async setAudioInputDevice(t){await super.setAudioInputDevice(t);const e=this.getCurrentMediaTrack(Pn.Audio);if(e){const t=this.getNext("audioRemoved",this.localUserID);this.conference.removeTrack(e),await t}if(this.conference&&this.preferredAudioInputID){const t=this.getNext("audioAdded",this.localUserID),e=await JitsiMeetJS.createLocalTracks({devices:["audio"],micDeviceId:this.preferredAudioInputID,constraints:{autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0}});for(const t of e)this.conference.addTrack(t);await t}}async setVideoInputDevice(t){await super.setVideoInputDevice(t);const e=this.getCurrentMediaTrack(Pn.Video);if(e){const t=this.getNext("videoRemoved",this.localUserID);this.conference.removeTrack(e),await t}if(this.conference&&this.preferredVideoInputID){const t=this.getNext("videoAdded",this.localUserID),e=await JitsiMeetJS.createLocalTracks({devices:["video"],cameraDeviceId:this.preferredVideoInputID});for(const t of e)this.conference.addTrack(t);await t}}async getCurrentAudioInputDevice(){const t=this.getCurrentMediaTrack(Pn.Audio),e=(await this.getAudioInputDevices()).filter((e=>null!=t&&e.deviceId===t.getDeviceId()||null==t&&e.deviceId===this.preferredAudioInputID));return 0===e.length?null:e[0]}async getCurrentVideoInputDevice(){const t=this.getCurrentMediaTrack(Pn.Video),e=(await this.getVideoInputDevices()).filter((e=>null!=t&&e.deviceId===t.getDeviceId()||null==t&&e.deviceId===this.preferredVideoInputID));return 0===e.length?null:e[0]}async toggleAudioMuted(){const t=this.getNext("audioMuteStatusChanged",this.localUserID),e=this.getCurrentMediaTrack(Pn.Audio);if(e){e.isMuted()?await e.unmute():await e.mute()}else await this.setPreferredAudioInput(!0);return(await t).muted}async toggleVideoMuted(){const t=this.getNext("videoMuteStatusChanged",this.localUserID);this.getCurrentMediaTrack(Pn.Video)?await this.setVideoInputDevice(null):await this.setPreferredVideoInput(!0);return(await t).muted}isMediaMuted(t){const e=this.getCurrentMediaTrack(t);return null==e||e.isMuted()}async getAudioMuted(){return this.isMediaMuted(Pn.Audio)}async getVideoMuted(){return this.isMediaMuted(Pn.Video)}}var Cs;!function(t){t.InConference="in-conference",t.JoiningConference="joining-conference",t.Connected="connected",t.Connecting="connecting",t.Prepaired="prepaired",t.Prepairing="prepairing",t.Unprepared="unprepaired"}(Cs||(Cs={}));const bs=new Xt;class Is extends En{constructor(t,e,...i){super(t,e),this.width=null,this.alts=i}random(){const t=Math.floor(Math.random()*this.alts.length);if(t<0)return null;const e=this.alts[t];return e instanceof Is?e.random():e}contains(t){if(super.contains(t))return!0;for(const e of this.alts)if(e.contains(t))return!0;return!1}}function Ps(t,e,i=null){return new En(t,e,i)}function Ms(t,e,i=null){return new En(t+Us.value,e,i)}function xs(t,e,...i){return new Is(t,e,...i)}function Es(t,e,i,...n){const s=Object.values(i).filter((t=>t instanceof En)).map((t=>t)).concat(...n);return Object.assign(xs(t,e,...s),i)}function Fs(t,e,i=null){if(t instanceof Array)return t.map((t=>Fs(t,e)));if(t instanceof Is){const{value:i,desc:n}=Fs(Ps(t.value,t.desc),e);return xs(i,n,...Fs(t.alts,e))}return e instanceof Array?e.map((e=>Fs(t,e))):Ps(t.value+e.value,i||t.desc+": "+e.desc)}function Ss(t,e,i=null){if(t instanceof Array)return t.map((t=>Ss(t,e)));if(t instanceof Is){const{value:i,desc:n}=Ss(Ps(t.value,t.desc),e);return xs(i,n,...Ss(t.alts,e))}return e instanceof Array?e.map((e=>Ss(t,e))):Ps(t.value+Qs.value+e.value,i||t.desc+": "+e.desc)}function ks(t,e,...i){const n=Ps(t,e),s=Fs(n,js),a=Fs(n,Ws),o=Fs(n,Vs),r=Fs(n,Zs),h=Fs(n,Ys);return Es(n.value,n.desc,{default:n,light:s,mediumLight:a,medium:o,mediumDark:r,dark:h},...i)}function Ls(t){const e=Ss(t,zs),i=Ss(t,Hs);return Es(t.value,t.desc,{default:t,man:e,woman:i})}function _s(t,e){return Ls(ks(t,e))}function Ts(t,e,...i){const n=ks(t,e),s=Ss(n,Xs),a=Ss(n,Js),o=Ss(n,Ks),r=Ss(n,qs);return Es(n.value,n.desc,{default:n,red:s,curly:a,white:o,bald:r},...i)}function Os(t,e){const i=Ps(t.value,e),n=Ss(Ua.default,i),s=Ss(Ga.default,i);return Es(t.value,t.desc,{symbol:t,men:n,women:s})}const Rs=Ps("","Variation Selector-15: text style"),Us=Ps("","Variation Selector-16: emoji style"),Qs=Ps("","Zero Width Joiner"),Ns=Ps("","Combining Enclosing Keycap"),Hs=Ms("","Female"),zs=Ms("","Male"),Gs=Ms("","Transgender Symbol"),js=Ps("","Light Skin Tone"),Ws=Ps("","Medium-Light Skin Tone"),Vs=Ps("","Medium Skin Tone"),Zs=Ps("","Medium-Dark Skin Tone"),Ys=Ps("","Dark Skin Tone"),Xs=Ps("","Red Hair"),Js=Ps("","Curly Hair"),Ks=Ps("","White Hair"),qs=Ps("","Bald"),$s=_s("","Frowning"),ta=_s("","Pouting"),ea=_s("","Gesturing NO"),ia=_s("","Gesturing OK"),na=_s("","Tipping Hand"),sa=_s("","Raising Hand"),aa=_s("","Bowing"),oa=_s("","Facepalming"),ra=_s("","Shrugging"),ha=_s("","Can't Hear"),Aa=_s("","Getting Massage"),ca=_s("","Getting Haircut"),la=_s("","Construction Worker"),ua=_s("","Guard"),da=_s("","Spy"),ga=(_s("","Police"),_s("","Wearing Turban")),pa=_s("","Superhero"),ma=_s("","Supervillain"),fa=_s("","Mage"),va=_s("","Fairy"),wa=_s("","Vampire"),Ba=_s("","Merperson"),Da=_s("","Elf"),ya=_s("","Walking"),Ca=_s("","Standing"),ba=_s("","Kneeling"),Ia=_s("","Running"),Pa=xs("Gestures","Gestures",$s,ta,ea,ia,na,sa,aa,oa,ra,ha,Aa,ca),Ma=ks("","Baby"),xa=ks("","Child"),Ea=ks("","Boy"),Fa=ks("","Girl"),Sa=Es(xa.value,xa.desc,{default:xa,male:Ea,female:Fa}),ka=_s("","Blond Person"),La=ks("","Person",ka.default,ga.default),_a=ks("","Bearded Man"),Ta=Ms("","Man in Suit, Levitating"),Oa=ks("","Man With Chinese Cap"),Ra=ks("","Man in Tuxedo"),Ua=Ts("","Man",ka.man,_a,Ta,Oa,ga.man,Ra),Qa=ks("","Pregnant Woman"),Na=ks("","Breast-Feeding"),Ha=ks("","Woman With Headscarf"),za=ks("","Bride With Veil"),Ga=Ts("","Woman",ka.woman,Qa,Na,Ha,ga.woman,za),ja=Es(La.value,"Adult",{default:La,male:Ua,female:Ga}),Wa=ks("","Older Person"),Va=ks("","Old Man"),Za=ks("","Old Woman"),Ya=Es(Wa.value,Wa.desc,{default:Wa,male:Va,female:Za}),Xa=Ms("","Medical"),Ja=Os(Xa,"Health Care"),Ka=Ps("","Graduation Cap"),qa=Os(Ka,"Student"),$a=Ps("","School"),to=Os($a,"Teacher"),eo=Ms("","Balance Scale"),io=Os(eo,"Judge"),no=Ps("","Sheaf of Rice"),so=Os(no,"Farmer"),ao=Ps("","Cooking"),oo=Os(ao,"Cook"),ro=Ps("","Wrench"),ho=Os(ro,"Mechanic"),Ao=Ps("","Factory"),co=Os(Ao,"Factory Worker"),lo=Ps("","Briefcase"),uo=Os(lo,"Office Worker"),go=Ps("","Fire Engine"),po=Os(go,"Fire Fighter"),mo=Ps("","Rocket"),fo=Os(mo,"Astronaut"),vo=Ms("","Airplane"),wo=Os(vo,"Pilot"),Bo=Ps("","Artist Palette"),Do=Os(Bo,"Artist"),yo=Ps("","Microphone"),Co=Os(yo,"Singer"),bo=Ps("","Laptop"),Io=Os(bo,"Technologist"),Po=Ps("","Microscope"),Mo=Os(Po,"Scientist"),xo=Ps("","Crown"),Eo=ks("","Prince"),Fo=ks("","Princess"),So=Es(xo.value,xo.desc,{symbol:xo,male:Eo,female:Fo}),ko=Es("Roles","Depictions of people working",{healthCareWorkers:Ja,students:qa,teachers:to,judges:io,farmers:so,cooks:oo,mechanics:ho,factoryWorkers:co,officeWorkers:uo,scientists:Mo,technologists:Io,singers:Co,artists:Do,pilots:wo,astronauts:fo,fireFighters:po,spies:da,guards:ua,constructionWorkers:la,royalty:So}),Lo=ks("","Cherub"),_o=ks("","Santa Claus"),To=ks("","Mrs. Claus"),Oo=Ls(Ps("","Genie")),Ro=Ls(Ps("","Zombie")),Uo=Es("Fantasy","Depictions of fantasy characters",{cherub:Lo,santaClaus:_o,mrsClaus:To,superheroes:pa,supervillains:ma,mages:fa,fairies:va,vampires:wa,merpeople:Ba,elves:Da,genies:Oo,zombies:Ro}),Qo=Ps("","Safety Vest"),No=Ps("","Probing Cane"),Ho=Os(No,"Probing"),zo=Ps("","Motorized Wheelchair"),Go=Os(zo,"In Motorized Wheelchair"),jo=Ps("","Manual Wheelchair"),Wo=Os(jo,"In Manual Wheelchair"),Vo=ks("","Man Dancing"),Zo=ks("","Woman Dancing"),Yo=Es(Vo.value,"Dancing",{male:Vo,female:Zo}),Xo=_s("","Juggler"),Jo=_s("","Climber"),Ko=Ps("","Fencer"),qo=ks("","Jockey"),$o=Ms("","Skier"),tr=ks("","Snowboarder"),er=_s(""+Us.value,"Golfer"),ir=_s("","Surfing"),nr=_s("","Rowing Boat"),sr=_s("","Swimming"),ar=_s(""+Us.value,"Basket Baller"),or=_s(""+Us.value,"Weight Lifter"),rr=_s("","Biker"),hr=_s("","Mountain Biker"),Ar=_s("","Cartwheeler"),cr=Ls(Ps("","Wrestler")),lr=_s("","Water Polo Player"),ur=_s("","Hand Baller"),dr=Es("In Motion","Depictions of people in motion",{walking:ya,standing:Ca,kneeling:ba,withProbingCane:Ho,inMotorizedWheelchair:Go,inManualWheelchair:Wo,dancers:Yo,jugglers:Xo,climbers:Jo,fencer:Ko,jockeys:qo,skier:$o,snowboarders:tr,golfers:er,surfers:ir,rowers:nr,swimmers:sr,runners:Ia,basketballers:ar,weightLifters:or,bikers:rr,mountainBikers:hr,cartwheelers:Ar,wrestlers:cr,waterPoloers:lr,handBallers:ur}),gr=_s("","In Lotus Position"),pr=ks("","In Bath"),mr=ks("","In Bed"),fr=_s("","In Sauna"),vr=Es("Resting","Depictions of people at rest",{inLotusPosition:gr,inBath:pr,inBed:mr,inSauna:fr}),wr=xs(Ma.value,Ma.desc,Ma,Lo),Br=Es("People","People",{babies:wr,children:Sa,adults:ja,elderly:Ya}),Dr=Es("All People","All People",{people:Br,gestures:Pa,inMotion:dr,resting:vr,roles:ko,fantasy:Uo}),yr=Ps("","Ogre"),Cr=Ps("","Goblin"),br=Ps("","Ghost"),Ir=Ps("","Alien"),Pr=Ps("","Alien Monster"),Mr=Ps("","Angry Face with Horns"),xr=Ps("","Skull"),Er=Ps("","Pile of Poo"),Fr=Ps("","Grinning Face"),Sr=Ps("","Beaming Face with Smiling Eyes"),kr=Ps("","Face with Tears of Joy"),Lr=Ps("","Grinning Face with Big Eyes"),_r=Ps("","Grinning Face with Smiling Eyes"),Tr=Ps("","Grinning Face with Sweat"),Or=Ps("","Grinning Squinting Face"),Rr=Ps("","Smiling Face with Halo"),Ur=Ps("","Smiling Face with Horns"),Qr=Ps("","Winking Face"),Nr=Ps("","Smiling Face with Smiling Eyes"),Hr=Ps("","Face Savoring Food"),zr=Ps("","Relieved Face"),Gr=Ps("","Smiling Face with Heart-Eyes"),jr=Ps("","Smiling Face with Sunglasses"),Wr=Ps("","Smirking Face"),Vr=Ps("","Neutral Face"),Zr=Ps("","Expressionless Face"),Yr=Ps("","Unamused Face"),Xr=Ps("","Downcast Face with Sweat"),Jr=Ps("","Pensive Face"),Kr=Ps("","Confused Face"),qr=Ps("","Confounded Face"),$r=Ps("","Kissing Face"),th=Ps("","Face Blowing a Kiss"),eh=Ps("","Kissing Face with Smiling Eyes"),ih=Ps("","Kissing Face with Closed Eyes"),nh=Ps("","Face with Tongue"),sh=Ps("","Winking Face with Tongue"),ah=Ps("","Squinting Face with Tongue"),oh=Ps("","Disappointed Face"),rh=Ps("","Worried Face"),hh=Ps("","Angry Face"),Ah=Ps("","Pouting Face"),ch=Ps("","Crying Face"),lh=Ps("","Persevering Face"),uh=Ps("","Face with Steam From Nose"),dh=Ps("","Sad but Relieved Face"),gh=Ps("","Frowning Face with Open Mouth"),ph=Ps("","Anguished Face"),mh=Ps("","Fearful Face"),fh=Ps("","Weary Face"),vh=Ps("","Sleepy Face"),wh=Ps("","Tired Face"),Bh=Ps("","Grimacing Face"),Dh=Ps("","Loudly Crying Face"),yh=Ps("","Face with Open Mouth"),Ch=Ps("","Hushed Face"),bh=Ps("","Anxious Face with Sweat"),Ih=Ps("","Face Screaming in Fear"),Ph=Ps("","Astonished Face"),Mh=Ps("","Flushed Face"),xh=Ps("","Sleeping Face"),Eh=Ps("","Dizzy Face"),Fh=Ps("","Face Without Mouth"),Sh=Ps("","Face with Medical Mask"),kh=Ps("","Grinning Cat with Smiling Eyes"),Lh=Ps("","Cat with Tears of Joy"),_h=Ps("","Grinning Cat"),Th=Ps("","Smiling Cat with Heart-Eyes"),Oh=Ps("","Cat with Wry Smile"),Rh=Ps("","Kissing Cat"),Uh=Ps("","Pouting Cat"),Qh=Ps("","Crying Cat"),Nh=Ps("","Weary Cat"),Hh=Ps("","Slightly Frowning Face"),zh=Ps("","Slightly Smiling Face"),Gh=Ps("","Upside-Down Face"),jh=Ps("","Face with Rolling Eyes"),Wh=Ps("","See-No-Evil Monkey"),Vh=Ps("","Hear-No-Evil Monkey"),Zh=Ps("","Speak-No-Evil Monkey"),Yh=Ps("","Zipper-Mouth Face"),Xh=Ps("","Money-Mouth Face"),Jh=Ps("","Face with Thermometer"),Kh=Ps("","Nerd Face"),qh=Ps("","Thinking Face"),$h=Ps("","Face with Head-Bandage"),tA=Ps("","Robot"),eA=Ps("","Hugging Face"),iA=Ps("","Cowboy Hat Face"),nA=Ps("","Clown Face"),sA=Ps("","Nauseated Face"),aA=Ps("","Rolling on the Floor Laughing"),oA=Ps("","Drooling Face"),rA=Ps("","Lying Face"),hA=Ps("","Sneezing Face"),AA=Ps("","Face with Raised Eyebrow"),cA=Ps("","Star-Struck"),lA=Ps("","Zany Face"),uA=Ps("","Shushing Face"),dA=Ps("","Face with Symbols on Mouth"),gA=Ps("","Face with Hand Over Mouth"),pA=Ps("","Face Vomiting"),mA=Ps("","Exploding Head"),fA=Ps("","Smiling Face with Hearts"),vA=Ps("","Yawning Face"),wA=Ps("","Partying Face"),BA=Ps("","Woozy Face"),DA=Ps("","Hot Face"),yA=Ps("","Cold Face"),CA=Ps("","Pleading Face"),bA=Ps("","Face with Monocle"),IA=Ms("","Skull and Crossbones"),PA=Ms("","Frowning Face"),MA=Ms("","Smiling Face"),xA=Ms("","Speaking Head"),EA=Ps("","Bust in Silhouette"),FA=Es("Faces","Round emoji faces",{ogre:yr,goblin:Cr,ghost:br,alien:Ir,alienMonster:Pr,angryFaceWithHorns:Mr,skull:xr,pileOfPoo:Er,grinningFace:Fr,beamingFaceWithSmilingEyes:Sr,faceWithTearsOfJoy:kr,grinningFaceWithBigEyes:Lr,grinningFaceWithSmilingEyes:_r,grinningFaceWithSweat:Tr,grinningSquitingFace:Or,smillingFaceWithHalo:Rr,smilingFaceWithHorns:Ur,winkingFace:Qr,smilingFaceWithSmilingEyes:Nr,faceSavoringFood:Hr,relievedFace:zr,smilingFaceWithHeartEyes:Gr,smilingFaceWithSunglasses:jr,smirkingFace:Wr,neutralFace:Vr,expressionlessFace:Zr,unamusedFace:Yr,downcastFaceWithSweat:Xr,pensiveFace:Jr,confusedFace:Kr,confoundedFace:qr,kissingFace:$r,faceBlowingAKiss:th,kissingFaceWithSmilingEyes:eh,kissingFaceWithClosedEyes:ih,faceWithTongue:nh,winkingFaceWithTongue:sh,squintingFaceWithTongue:ah,disappointedFace:oh,worriedFace:rh,angryFace:hh,poutingFace:Ah,cryingFace:ch,perseveringFace:lh,faceWithSteamFromNose:uh,sadButRelievedFace:dh,frowningFaceWithOpenMouth:gh,anguishedFace:ph,fearfulFace:mh,wearyFace:fh,sleepyFace:vh,tiredFace:wh,grimacingFace:Bh,loudlyCryingFace:Dh,faceWithOpenMouth:yh,hushedFace:Ch,anxiousFaceWithSweat:bh,faceScreamingInFear:Ih,astonishedFace:Ph,flushedFace:Mh,sleepingFace:xh,dizzyFace:Eh,faceWithoutMouth:Fh,faceWithMedicalMask:Sh,grinningCatWithSmilingEyes:kh,catWithTearsOfJoy:Lh,grinningCat:_h,smilingCatWithHeartEyes:Th,catWithWrySmile:Oh,kissingCat:Rh,poutingCat:Uh,cryingCat:Qh,wearyCat:Nh,slightlyFrowningFace:Hh,slightlySmilingFace:zh,updisdeDownFace:Gh,faceWithRollingEyes:jh,seeNoEvilMonkey:Wh,hearNoEvilMonkey:Vh,speakNoEvilMonkey:Zh,zipperMouthFace:Yh,moneyMouthFace:Xh,faceWithThermometer:Jh,nerdFace:Kh,thinkingFace:qh,faceWithHeadBandage:$h,robot:tA,huggingFace:eA,cowboyHatFace:iA,clownFace:nA,nauseatedFace:sA,rollingOnTheFloorLaughing:aA,droolingFace:oA,lyingFace:rA,sneezingFace:hA,faceWithRaisedEyebrow:AA,starStruck:cA,zanyFace:lA,shushingFace:uA,faceWithSymbolsOnMouth:dA,faceWithHandOverMouth:gA,faceVomitting:pA,explodingHead:mA,smilingFaceWithHearts:fA,yawningFace:vA,partyingFace:wA,woozyFace:BA,hotFace:DA,coldFace:yA,pleadingFace:CA,faceWithMonocle:bA,skullAndCrossbones:IA,frowningFace:PA,smilingFace:MA,speakingHead:xA,bust:EA}),SA=Ps("","Kiss Mark"),kA=Ps("","Love Letter"),LA=Ps("","Beating Heart"),_A=Ps("","Broken Heart"),TA=Ps("","Two Hearts"),OA=Ps("","Sparkling Heart"),RA=Ps("","Growing Heart"),UA=Ps("","Heart with Arrow"),QA=Ps("","Blue Heart"),NA=Ps("","Green Heart"),HA=Ps("","Yellow Heart"),zA=Ps("","Purple Heart"),GA=Ps("","Heart with Ribbon"),jA=Ps("","Revolving Hearts"),WA=Ps("","Heart Decoration"),VA=Ps("","Black Heart"),ZA=Ps("","White Heart"),YA=Ps("","Brown Heart"),XA=Ps("","Orange Heart"),JA=Ms("","Heart Exclamation"),KA=Ms("","Red Heart"),qA=Es("Love","Hearts and kisses",{kissMark:SA,loveLetter:kA,beatingHeart:LA,brokenHeart:_A,twoHearts:TA,sparklingHeart:OA,growingHeart:RA,heartWithArrow:UA,blueHeart:QA,greenHeart:NA,yellowHeart:HA,purpleHeart:zA,heartWithRibbon:GA,revolvingHearts:jA,heartDecoration:WA,blackHeart:VA,whiteHeart:ZA,brownHeart:YA,orangeHeart:XA,heartExclamation:JA,redHeart:KA}),$A=Ps("","Anger Symbol"),tc=Ps("","Bomb"),ec=Ps("","Zzz"),ic=Ps("","Collision"),nc=Ps("","Sweat Droplets"),sc=Ps("","Dashing Away"),ac=Ps("","Dizzy"),oc=Ps("","Speech Balloon"),rc=Ps("","Thought Balloon"),hc=Ps("","Hundred Points"),Ac=Ms("","Hole"),cc=Ms("","Left Speech Bubble"),lc=Ms("","Right Speech Bubble"),uc=Ms("","Conversation Bubbles 2"),dc=Ms("","Conversation Bubbles 3"),gc=Ms("","Left Thought Bubble"),pc=Ms("","Right Thought Bubble"),mc=Ms("","Left Anger Bubble"),fc=Ms("","Right Anger Bubble"),vc=Ms("","Anger Bubble"),wc=Ms("","Anger Bubble Lightning"),Bc=Ms("","Lightning Bolt"),Dc=xs("Cartoon","Cartoon symbols",$A,tc,ec,ic,nc,sc,ac,oc,rc,hc,Ac,cc,lc,uc,dc,gc,pc,mc,fc,vc,wc,Bc),yc=Ps("","Backhand Index Pointing Up"),Cc=Ps("","Backhand Index Pointing Down"),bc=Ps("","Backhand Index Pointing Left"),Ic=Ps("","Backhand Index Pointing Right"),Pc=Ps("","Oncoming Fist"),Mc=Ps("","Waving Hand"),xc=Ps("","OK Hand"),Ec=Ps("","Thumbs Up"),Fc=Ps("","Thumbs Down"),Sc=Ps("","Clapping Hands"),kc=Ps("","Open Hands"),Lc=Ps("","Nail Polish"),_c=Ms("","Hand with Fingers Splayed"),Tc=Ms("","Hand with Fingers Splayed 2"),Oc=Ps("","Thumbs Up 2"),Rc=Ps("","Thumbs Down 2"),Uc=Ps("","Peace Fingers"),Qc=Ps("","Middle Finger"),Nc=Ps("","Vulcan Salute"),Hc=Ps("","Hand Pointing Down"),zc=Ps("","Hand Pointing Left"),Gc=Ps("","Hand Pointing Right"),jc=Ps("","Hand Pointing Left 2"),Wc=Ps("","Hand Pointing Right 2"),Vc=Ps("","Index Pointing Left"),Zc=Ps("","Index Pointing Right"),Yc=Ps("","Index Pointing Up"),Xc=Ps("","Index Pointing Down"),Jc=Ps("","Index Pointing Up 2"),Kc=Ps("","Index Pointing Down 2"),qc=Ps("","Index Pointing Up 3"),$c=Ps("","Index Pointing Down 3"),tl=Ps("","Raising Hands"),el=Ps("","Folded Hands"),il=Ps("","Pinched Fingers"),nl=Ps("","Pinching Hand"),sl=Ps("","Sign of the Horns"),al=Ps("","Call Me Hand"),ol=Ps("","Raised Back of Hand"),rl=Ps("","Left-Facing Fist"),hl=Ps("","Right-Facing Fist"),Al=Ps("","Handshake"),cl=Ps("","Crossed Fingers"),ll=Ps("","Love-You Gesture"),ul=Ps("","Palms Up Together"),dl=Ms("","Index Pointing Up 4"),gl=Ps("","Raised Fist"),pl=Ps("","Raised Hand"),ml=Ms("","Victory Hand"),fl=Ms("","Writing Hand"),vl=xs("Hands","Hands pointing at things",yc,Cc,bc,Ic,Pc,Mc,xc,Ec,Fc,Sc,kc,Lc,_c,Tc,Tc,Oc,Rc,Uc,Qc,Nc,Hc,zc,Gc,jc,Wc,Vc,Zc,Yc,Xc,Jc,Kc,qc,$c,tl,el,il,nl,sl,al,ol,rl,hl,Al,cl,ll,ul,dl,gl,pl,ml,fl),wl=Ps("","Red Circle"),Bl=Ps("","Blue Circle"),Dl=Ps("","Large Orange Diamond"),yl=Ps("","Large Blue Diamond"),Cl=Ps("","Small Orange Diamond"),bl=Ps("","Small Blue Diamond"),Il=Ps("","Red Triangle Pointed Up"),Pl=Ps("","Red Triangle Pointed Down"),Ml=Ps("","Orange Circle"),xl=Ps("","Yellow Circle"),El=Ps("","Green Circle"),Fl=Ps("","Purple Circle"),Sl=Ps("","Brown Circle"),kl=Ps("","Hollow Red Circle"),Ll=Ps("","White Circle"),_l=Ps("","Black Circle"),Tl=Ps("","Red Square"),Ol=Ps("","Blue Square"),Rl=Ps("","Orange Square"),Ul=Ps("","Yellow Square"),Ql=Ps("","Green Square"),Nl=Ps("","Purple Square"),Hl=Ps("","Brown Square"),zl=Ps("","Black Square Button"),Gl=Ps("","White Square Button"),jl=Ms("","Black Small Square"),Wl=Ms("","White Small Square"),Vl=Ps("","White Medium-Small Square"),Zl=Ps("","Black Medium-Small Square"),Yl=Ms("","White Medium Square"),Xl=Ms("","Black Medium Square"),Jl=Ps("","Black Large Square"),Kl=Ps("","White Large Square"),ql=Ps("","Star"),$l=Ps("","Diamond with a Dot"),tu=xs("Shapes","Colored shapes",wl,Bl,Dl,yl,Cl,bl,Il,Pl,Ml,xl,El,Fl,Sl,kl,Ll,_l,Tl,Ol,Rl,Ul,Ql,Nl,Hl,zl,Gl,jl,Wl,Vl,Zl,Yl,Xl,Jl,Kl,ql,$l),eu=Ms("","Eye"),iu=Ss(eu,cc,"Eye in Speech Bubble"),nu=xs("Body Parts","General body parts",Ps("","Eyes"),eu,iu,Ps("","Ear"),Ps("","Nose"),Ps("","Mouth"),Ps("","Tongue"),Ps("","Flexed Biceps"),Ps("","Selfie"),Ps("","Bone"),Ps("","Leg"),Ps("","Foot"),Ps("","Tooth"),Ps("","Ear with Hearing Aid"),Ps("","Mechanical Arm"),Ps("","Mechanical Leg"),Ps("","Anatomical Heart"),Ps("","Lungs"),Ps("","Brain")),su=Ms("","Snowflake"),au=Ps("","Rainbow"),ou=xs("Weather","Weather",Ps("","Sunrise Over Mountains"),Ps("","Sunrise"),Ps("","Cityscape at Dusk"),Ps("","Sunset"),Ps("","Night with Stars"),Ps("","Closed Umbrella"),Ms("","Umbrella"),Ms("","Umbrella with Rain Drops"),Ms("","Snowman"),Ps("","Snowman Without Snow"),Ms("","Sun"),Ms("","Cloud"),Ms("","Sun Behind Small Cloud"),Ps("","Sun Behind Cloud"),Ms("","Sun Behind Large Cloud"),Ms("","Sun Behind Rain Cloud"),Ms("","Cloud with Rain"),Ms("","Cloud with Snow"),Ms("","Cloud with Lightning"),Ms("","Cloud with Lightning and Rain"),su,Ps("","Cyclone"),Ms("","Tornado"),Ms("","Wind Face"),Ps("","Water Wave"),Ms("","Fog"),Ps("","Foggy"),au,Ms("","Thermometer")),ru=Ps("","Cat"),hu=Ss(ru,Jl,"Black Cat"),Au=Ps("","Dog"),cu=Ss(Au,Qo,"Service Dog"),lu=Ps("","Bear"),uu=Ss(lu,su,"Polar Bear"),du=xs("Animals","Animals and insects",Ps("","Rat"),Ps("","Mouse"),Ps("","Ox"),Ps("","Water Buffalo"),Ps("","Cow"),Ps("","Tiger"),Ps("","Leopard"),Ps("","Rabbit"),ru,hu,Ps("","Dragon"),Ps("","Crocodile"),Ps("","Whale"),Ps("","Snail"),Ps("","Snake"),Ps("","Horse"),Ps("","Ram"),Ps("","Goat"),Ps("","Ewe"),Ps("","Monkey"),Ps("","Rooster"),Ps("","Chicken"),Au,cu,Ps("","Pig"),Ps("","Boar"),Ps("","Elephant"),Ps("","Octopus"),Ps("","Spiral Shell"),Ps("","Bug"),Ps("","Ant"),Ps("","Honeybee"),Ps("","Lady Beetle"),Ps("","Fish"),Ps("","Tropical Fish"),Ps("","Blowfish"),Ps("","Turtle"),Ps("","Hatching Chick"),Ps("","Baby Chick"),Ps("","Front-Facing Baby Chick"),Ps("","Bird"),Ps("","Penguin"),Ps("","Koala"),Ps("","Poodle"),Ps("","Camel"),Ps("","Two-Hump Camel"),Ps("","Dolphin"),Ps("","Mouse Face"),Ps("","Cow Face"),Ps("","Tiger Face"),Ps("","Rabbit Face"),Ps("","Cat Face"),Ps("","Dragon Face"),Ps("","Spouting Whale"),Ps("","Horse Face"),Ps("","Monkey Face"),Ps("","Dog Face"),Ps("","Pig Face"),Ps("","Frog"),Ps("","Hamster"),Ps("","Wolf"),lu,uu,Ps("","Panda"),Ps("","Pig Nose"),Ps("","Paw Prints"),Ms("","Chipmunk"),Ms("","Dove"),Ms("","Spider"),Ms("","Spider Web"),Ps("","Lion"),Ps("","Scorpion"),Ps("","Turkey"),Ps("","Unicorn"),Ps("","Eagle"),Ps("","Duck"),Ps("","Bat"),Ps("","Shark"),Ps("","Owl"),Ps("","Fox"),Ps("","Butterfly"),Ps("","Deer"),Ps("","Gorilla"),Ps("","Lizard"),Ps("","Rhinoceros"),Ps("","Giraffe"),Ps("","Zebra"),Ps("","Hedgehog"),Ps("","Sauropod"),Ps("","T-Rex"),Ps("","Cricket"),Ps("","Kangaroo"),Ps("","Llama"),Ps("","Peacock"),Ps("","Hippopotamus"),Ps("","Parrot"),Ps("","Raccoon"),Ps("","Mosquito"),Ps("","Microbe"),Ps("","Badger"),Ps("","Swan"),Ps("","Sloth"),Ps("","Otter"),Ps("","Orangutan"),Ps("","Skunk"),Ps("","Flamingo"),Ps("","Guide Dog")),gu=Ps("","White Flower"),pu=xs("Plants","Flowers, trees, and things",Ps("","Seedling"),Ps("","Evergreen Tree"),Ps("","Deciduous Tree"),Ps("","Palm Tree"),Ps("","Cactus"),Ps("","Tulip"),Ps("","Cherry Blossom"),Ps("","Rose"),Ps("","Hibiscus"),Ps("","Sunflower"),Ps("","Blossom"),no,Ps("","Herb"),Ps("","Four Leaf Clover"),Ps("","Maple Leaf"),Ps("","Fallen Leaf"),Ps("","Leaf Fluttering in Wind"),Ms("","Rosette"),Ps("","Bouquet"),gu,Ps("","Wilted Flower"),Ms("","Shamrock")),mu=Ps("","Banana"),fu=xs("Food","Food, drink, and utensils",Ps("","Hot Dog"),Ps("","Taco"),Ps("","Burrito"),Ps("","Chestnut"),Ms("","Hot Pepper"),Ps("","Ear of Corn"),Ps("","Mushroom"),Ps("","Tomato"),Ps("","Eggplant"),Ps("","Grapes"),Ps("","Melon"),Ps("","Watermelon"),Ps("","Tangerine"),Ps("","Lemon"),mu,Ps("","Pineapple"),Ps("","Red Apple"),Ps("","Green Apple"),Ps("","Pear"),Ps("","Peach"),Ps("","Cherries"),Ps("","Strawberry"),Ps("","Hamburger"),Ps("","Pizza"),Ps("","Meat on Bone"),Ps("","Poultry Leg"),Ps("","Rice Cracker"),Ps("","Rice Ball"),Ps("","Cooked Rice"),Ps("","Curry Rice"),Ps("","Steaming Bowl"),Ps("","Spaghetti"),Ps("","Bread"),Ps("","French Fries"),Ps("","Roasted Sweet Potato"),Ps("","Dango"),Ps("","Oden"),Ps("","Sushi"),Ps("","Fried Shrimp"),Ps("","Fish Cake with Swirl"),Ps("","Bento Box"),Ps("","Pot of Food"),ao,Ps("","Popcorn"),Ps("","Croissant"),Ps("","Avocado"),Ps("","Cucumber"),Ps("","Bacon"),Ps("","Potato"),Ps("","Carrot"),Ps("","Baguette Bread"),Ps("","Green Salad"),Ps("","Shallow Pan of Food"),Ps("","Stuffed Flatbread"),Ps("","Egg"),Ps("","Peanuts"),Ps("","Kiwi Fruit"),Ps("","Pancakes"),Ps("","Dumpling"),Ps("","Fortune Cookie"),Ps("","Takeout Box"),Ps("","Bowl with Spoon"),Ps("","Coconut"),Ps("","Broccoli"),Ps("","Pretzel"),Ps("","Cut of Meat"),Ps("","Sandwich"),Ps("","Canned Food"),Ps("","Leafy Green"),Ps("","Mango"),Ps("","Moon Cake"),Ps("","Bagel"),Ps("","Crab"),Ps("","Shrimp"),Ps("","Squid"),Ps("","Lobster"),Ps("","Oyster"),Ps("","Cheese Wedge"),Ps("","Salt"),Ps("","Garlic"),Ps("","Onion"),Ps("","Falafel"),Ps("","Waffle"),Ps("","Butter"),Ps("","Soft Ice Cream"),Ps("","Shaved Ice"),Ps("","Ice Cream"),Ps("","Doughnut"),Ps("","Cookie"),Ps("","Chocolate Bar"),Ps("","Candy"),Ps("","Lollipop"),Ps("","Custard"),Ps("","Honey Pot"),Ps("","Shortcake"),Ps("","Birthday Cake"),Ps("","Pie"),Ps("","Cupcake"),Ps("","Teacup Without Handle"),Ps("","Sake"),Ps("","Wine Glass"),Ps("","Cocktail Glass"),Ps("","Tropical Drink"),Ps("","Beer Mug"),Ps("","Clinking Beer Mugs"),Ps("","Baby Bottle"),Ps("","Bottle with Popping Cork"),Ps("","Clinking Glasses"),Ps("","Tumbler Glass"),Ps("","Glass of Milk"),Ps("","Cup with Straw"),Ps("","Beverage Box"),Ps("","Mate"),Ps("","Ice"),Ps("","Hot Beverage"),Ps("","Fork and Knife"),Ms("","Fork and Knife with Plate"),Ps("","Amphora"),Ps("","Kitchen Knife"),Ps("","Spoon"),Ps("","Chopsticks")),vu=(xs("National Flags","Flags of countries from around the world",Ps("","Flag: Ascension Island"),Ps("","Flag: Andorra"),Ps("","Flag: United Arab Emirates"),Ps("","Flag: Afghanistan"),Ps("","Flag: Antigua & Barbuda"),Ps("","Flag: Anguilla"),Ps("","Flag: Albania"),Ps("","Flag: Armenia"),Ps("","Flag: Angola"),Ps("","Flag: Antarctica"),Ps("","Flag: Argentina"),Ps("","Flag: American Samoa"),Ps("","Flag: Austria"),Ps("","Flag: Australia"),Ps("","Flag: Aruba"),Ps("","Flag: land Islands"),Ps("","Flag: Azerbaijan"),Ps("","Flag: Bosnia & Herzegovina"),Ps("","Flag: Barbados"),Ps("","Flag: Bangladesh"),Ps("","Flag: Belgium"),Ps("","Flag: Burkina Faso"),Ps("","Flag: Bulgaria"),Ps("","Flag: Bahrain"),Ps("","Flag: Burundi"),Ps("","Flag: Benin"),Ps("","Flag: St. Barthlemy"),Ps("","Flag: Bermuda"),Ps("","Flag: Brunei"),Ps("","Flag: Bolivia"),Ps("","Flag: Caribbean Netherlands"),Ps("","Flag: Brazil"),Ps("","Flag: Bahamas"),Ps("","Flag: Bhutan"),Ps("","Flag: Bouvet Island"),Ps("","Flag: Botswana"),Ps("","Flag: Belarus"),Ps("","Flag: Belize"),Ps("","Flag: Canada"),Ps("","Flag: Cocos (Keeling) Islands"),Ps("","Flag: Congo - Kinshasa"),Ps("","Flag: Central African Republic"),Ps("","Flag: Congo - Brazzaville"),Ps("","Flag: Switzerland"),Ps("","Flag: Cte dIvoire"),Ps("","Flag: Cook Islands"),Ps("","Flag: Chile"),Ps("","Flag: Cameroon"),Ps("","Flag: China"),Ps("","Flag: Colombia"),Ps("","Flag: Clipperton Island"),Ps("","Flag: Costa Rica"),Ps("","Flag: Cuba"),Ps("","Flag: Cape Verde"),Ps("","Flag: Curaao"),Ps("","Flag: Christmas Island"),Ps("","Flag: Cyprus"),Ps("","Flag: Czechia"),Ps("","Flag: Germany"),Ps("","Flag: Diego Garcia"),Ps("","Flag: Djibouti"),Ps("","Flag: Denmark"),Ps("","Flag: Dominica"),Ps("","Flag: Dominican Republic"),Ps("","Flag: Algeria"),Ps("","Flag: Ceuta & Melilla"),Ps("","Flag: Ecuador"),Ps("","Flag: Estonia"),Ps("","Flag: Egypt"),Ps("","Flag: Western Sahara"),Ps("","Flag: Eritrea"),Ps("","Flag: Spain"),Ps("","Flag: Ethiopia"),Ps("","Flag: European Union"),Ps("","Flag: Finland"),Ps("","Flag: Fiji"),Ps("","Flag: Falkland Islands"),Ps("","Flag: Micronesia"),Ps("","Flag: Faroe Islands"),Ps("","Flag: France"),Ps("","Flag: Gabon"),Ps("","Flag: United Kingdom"),Ps("","Flag: Grenada"),Ps("","Flag: Georgia"),Ps("","Flag: French Guiana"),Ps("","Flag: Guernsey"),Ps("","Flag: Ghana"),Ps("","Flag: Gibraltar"),Ps("","Flag: Greenland"),Ps("","Flag: Gambia"),Ps("","Flag: Guinea"),Ps("","Flag: Guadeloupe"),Ps("","Flag: Equatorial Guinea"),Ps("","Flag: Greece"),Ps("","Flag: South Georgia & South Sandwich Islands"),Ps("","Flag: Guatemala"),Ps("","Flag: Guam"),Ps("","Flag: Guinea-Bissau"),Ps("","Flag: Guyana"),Ps("","Flag: Hong Kong SAR China"),Ps("","Flag: Heard & McDonald Islands"),Ps("","Flag: Honduras"),Ps("","Flag: Croatia"),Ps("","Flag: Haiti"),Ps("","Flag: Hungary"),Ps("","Flag: Canary Islands"),Ps("","Flag: Indonesia"),Ps("","Flag: Ireland"),Ps("","Flag: Israel"),Ps("","Flag: Isle of Man"),Ps("","Flag: India"),Ps("","Flag: British Indian Ocean Territory"),Ps("","Flag: Iraq"),Ps("","Flag: Iran"),Ps("","Flag: Iceland"),Ps("","Flag: Italy"),Ps("","Flag: Jersey"),Ps("","Flag: Jamaica"),Ps("","Flag: Jordan"),Ps("","Flag: Japan"),Ps("","Flag: Kenya"),Ps("","Flag: Kyrgyzstan"),Ps("","Flag: Cambodia"),Ps("","Flag: Kiribati"),Ps("","Flag: Comoros"),Ps("","Flag: St. Kitts & Nevis"),Ps("","Flag: North Korea"),Ps("","Flag: South Korea"),Ps("","Flag: Kuwait"),Ps("","Flag: Cayman Islands"),Ps("","Flag: Kazakhstan"),Ps("","Flag: Laos"),Ps("","Flag: Lebanon"),Ps("","Flag: St. Lucia"),Ps("","Flag: Liechtenstein"),Ps("","Flag: Sri Lanka"),Ps("","Flag: Liberia"),Ps("","Flag: Lesotho"),Ps("","Flag: Lithuania"),Ps("","Flag: Luxembourg"),Ps("","Flag: Latvia"),Ps("","Flag: Libya"),Ps("","Flag: Morocco"),Ps("","Flag: Monaco"),Ps("","Flag: Moldova"),Ps("","Flag: Montenegro"),Ps("","Flag: St. Martin"),Ps("","Flag: Madagascar"),Ps("","Flag: Marshall Islands"),Ps("","Flag: North Macedonia"),Ps("","Flag: Mali"),Ps("","Flag: Myanmar (Burma)"),Ps("","Flag: Mongolia"),Ps("","Flag: Macao Sar China"),Ps("","Flag: Northern Mariana Islands"),Ps("","Flag: Martinique"),Ps("","Flag: Mauritania"),Ps("","Flag: Montserrat"),Ps("","Flag: Malta"),Ps("","Flag: Mauritius"),Ps("","Flag: Maldives"),Ps("","Flag: Malawi"),Ps("","Flag: Mexico"),Ps("","Flag: Malaysia"),Ps("","Flag: Mozambique"),Ps("","Flag: Namibia"),Ps("","Flag: New Caledonia"),Ps("","Flag: Niger"),Ps("","Flag: Norfolk Island"),Ps("","Flag: Nigeria"),Ps("","Flag: Nicaragua"),Ps("","Flag: Netherlands"),Ps("","Flag: Norway"),Ps("","Flag: Nepal"),Ps("","Flag: Nauru"),Ps("","Flag: Niue"),Ps("","Flag: New Zealand"),Ps("","Flag: Oman"),Ps("","Flag: Panama"),Ps("","Flag: Peru"),Ps("","Flag: French Polynesia"),Ps("","Flag: Papua New Guinea"),Ps("","Flag: Philippines"),Ps("","Flag: Pakistan"),Ps("","Flag: Poland"),Ps("","Flag: St. Pierre & Miquelon"),Ps("","Flag: Pitcairn Islands"),Ps("","Flag: Puerto Rico"),Ps("","Flag: Palestinian Territories"),Ps("","Flag: Portugal"),Ps("","Flag: Palau"),Ps("","Flag: Paraguay"),Ps("","Flag: Qatar"),Ps("","Flag: Runion"),Ps("","Flag: Romania"),Ps("","Flag: Serbia"),Ps("","Flag: Russia"),Ps("","Flag: Rwanda"),Ps("","Flag: Saudi Arabia"),Ps("","Flag: Solomon Islands"),Ps("","Flag: Seychelles"),Ps("","Flag: Sudan"),Ps("","Flag: Sweden"),Ps("","Flag: Singapore"),Ps("","Flag: St. Helena"),Ps("","Flag: Slovenia"),Ps("","Flag: Svalbard & Jan Mayen"),Ps("","Flag: Slovakia"),Ps("","Flag: Sierra Leone"),Ps("","Flag: San Marino"),Ps("","Flag: Senegal"),Ps("","Flag: Somalia"),Ps("","Flag: Suriname"),Ps("","Flag: South Sudan"),Ps("","Flag: So Tom & Prncipe"),Ps("","Flag: El Salvador"),Ps("","Flag: Sint Maarten"),Ps("","Flag: Syria"),Ps("","Flag: Eswatini"),Ps("","Flag: Tristan Da Cunha"),Ps("","Flag: Turks & Caicos Islands"),Ps("","Flag: Chad"),Ps("","Flag: French Southern Territories"),Ps("","Flag: Togo"),Ps("","Flag: Thailand"),Ps("","Flag: Tajikistan"),Ps("","Flag: Tokelau"),Ps("","Flag: Timor-Leste"),Ps("","Flag: Turkmenistan"),Ps("","Flag: Tunisia"),Ps("","Flag: Tonga"),Ps("","Flag: Turkey"),Ps("","Flag: Trinidad & Tobago"),Ps("","Flag: Tuvalu"),Ps("","Flag: Taiwan"),Ps("","Flag: Tanzania"),Ps("","Flag: Ukraine"),Ps("","Flag: Uganda"),Ps("","Flag: U.S. Outlying Islands"),Ps("","Flag: United Nations"),Ps("","Flag: United States"),Ps("","Flag: Uruguay"),Ps("","Flag: Uzbekistan"),Ps("","Flag: Vatican City"),Ps("","Flag: St. Vincent & Grenadines"),Ps("","Flag: Venezuela"),Ps("","Flag: British Virgin Islands"),Ps("","Flag: U.S. Virgin Islands"),Ps("","Flag: Vietnam"),Ps("","Flag: Vanuatu"),Ps("","Flag: Wallis & Futuna"),Ps("","Flag: Samoa"),Ps("","Flag: Kosovo"),Ps("","Flag: Yemen"),Ps("","Flag: Mayotte"),Ps("","Flag: South Africa"),Ps("","Flag: Zambia"),Ps("","Flag: Zimbabwe")),Ms("","White Flag")),wu=Ss(vu,au,"Rainbow Flag"),Bu=Ss(vu,Gs,"Transgender Flag"),Du=Ps("","Black Flag"),yu=Ss(Du,IA,"Pirate Flag"),Cu=xs("Flags","Basic flags",Ps("","Crossed Flags"),Ps("","Chequered Flag"),vu,wu,Bu,Du,yu,Ps("","Flag: England"),Ps("","Flag: Scotland"),Ps("","Flag: Wales"),Ps("","Triangular Flag")),bu=Ms("","Motorcycle"),Iu=Ms("","Racing Car"),Pu=Ps("","Seat"),Mu=Ps("","Helicopter"),xu=Ps("","Locomotive"),Eu=Ps("","Railway Car"),Fu=Ps("","High-Speed Train"),Su=Ps("","Bullet Train"),ku=Ps("","Train"),Lu=Ps("","Metro"),_u=Ps("","Light Rail"),Tu=Ps("","Station"),Ou=Ps("","Tram"),Ru=Ps("","Tram Car"),Uu=Ps("","Bus"),Qu=Ps("","Oncoming Bus"),Nu=Ps("","Trolleybus"),Hu=Ps("","Bus Stop"),zu=Ps("","Minibus"),Gu=Ps("","Ambulance"),ju=Ps("","Taxi"),Wu=Ps("","Oncoming Taxi"),Vu=Ps("","Automobile"),Zu=Ps("","Oncoming Automobile"),Yu=Ps("","Sport Utility Vehicle"),Xu=Ps("","Delivery Truck"),Ju=Ps("","Articulated Lorry"),Ku=Ps("","Tractor"),qu=Ps("","Monorail"),$u=Ps("","Mountain Railway"),td=Ps("","Suspension Railway"),ed=Ps("","Mountain Cableway"),id=Ps("","Aerial Tramway"),nd=Ps("","Ship"),sd=Ps("","Speedboat"),ad=Ps("","Horizontal Traffic Light"),od=Ps("","Vertical Traffic Light"),rd=Ps("","Construction"),hd=Ps("","Bicycle"),Ad=Ps("","Stop Sign"),cd=Ms("","Oil Drum"),ld=Ms("","Motorway"),ud=Ms("","Railway Track"),dd=Ms("","Motor Boat"),gd=Ms("","Small Airplane"),pd=Ps("","Airplane Departure"),md=Ps("","Airplane Arrival"),fd=Ms("","Satellite"),vd=Ms("","Passenger Ship"),wd=Ps("","Kick Scooter"),Bd=Ps("","Motor Scooter"),Dd=Ps("","Canoe"),yd=Ps("","Flying Saucer"),Cd=Ps("","Skateboard"),bd=Ps("","Auto Rickshaw"),Id=Ps("","Parachute"),Pd=Ps("","Anchor"),Md=Ms("","Ferry"),xd=Ps("","Sailboat"),Ed=Ps("","Fuel Pump"),Fd=xs("Vehicles","Things that go",bu,Iu,Pu,mo,Mu,xu,Eu,Fu,Su,ku,Lu,_u,Tu,Ou,Ru,Uu,Qu,Nu,Hu,zu,Gu,go,ju,Wu,Vu,Zu,Yu,Xu,Ju,Ku,qu,$u,td,ed,id,nd,sd,ad,od,rd,hd,Ad,cd,ld,ud,dd,gd,pd,md,fd,vd,wd,Bd,Dd,yd,Cd,bd,zo,jo,Id,Pd,Md,xd,Ed,vo),Sd=(xs("Blood Types","Blood types",Ps("","A Button (Blood Type)"),Ps("","B Button (Blood Type)"),Ps("","O Button (Blood Type)"),Ps("","AB Button (Blood Type)")),xs("Regions","Region indicators",Ps("","Regional Indicator Symbol Letter A"),Ps("","Regional Indicator Symbol Letter B"),Ps("","Regional Indicator Symbol Letter C"),Ps("","Regional Indicator Symbol Letter D"),Ps("","Regional Indicator Symbol Letter E"),Ps("","Regional Indicator Symbol Letter F"),Ps("","Regional Indicator Symbol Letter G"),Ps("","Regional Indicator Symbol Letter H"),Ps("","Regional Indicator Symbol Letter I"),Ps("","Regional Indicator Symbol Letter J"),Ps("","Regional Indicator Symbol Letter K"),Ps("","Regional Indicator Symbol Letter L"),Ps("","Regional Indicator Symbol Letter M"),Ps("","Regional Indicator Symbol Letter N"),Ps("","Regional Indicator Symbol Letter O"),Ps("","Regional Indicator Symbol Letter P"),Ps("","Regional Indicator Symbol Letter Q"),Ps("","Regional Indicator Symbol Letter R"),Ps("","Regional Indicator Symbol Letter S"),Ps("","Regional Indicator Symbol Letter T"),Ps("","Regional Indicator Symbol Letter U"),Ps("","Regional Indicator Symbol Letter V"),Ps("","Regional Indicator Symbol Letter W"),Ps("","Regional Indicator Symbol Letter X"),Ps("","Regional Indicator Symbol Letter Y"),Ps("","Regional Indicator Symbol Letter Z")),xs("Japanese","Japanse symbology",Ps("","Japanese Symbol for Beginner"),Ps("","Japanese Here Button"),Ms("","Japanese Service Charge Button"),Ps("","Japanese Free of Charge Button"),Ps("","Japanese Reserved Button"),Ps("","Japanese Prohibited Button"),Ps("","Japanese Vacancy Button"),Ps("","Japanese Passing Grade Button"),Ps("","Japanese No Vacancy Button"),Ps("","Japanese Not Free of Charge Button"),Ms("","Japanese Monthly Amount Button"),Ps("","Japanese Application Button"),Ps("","Japanese Discount Button"),Ps("","Japanese Open for Business Button"),Ps("","Japanese Bargain Button"),Ps("","Japanese Acceptable Button"),Ms("","Japanese Congratulations Button"),Ms("","Japanese Secret Button")),xs("Clocks","Time-keeping pieces",Ps("","One OClock"),Ps("","Two OClock"),Ps("","Three OClock"),Ps("","Four OClock"),Ps("","Five OClock"),Ps("","Six OClock"),Ps("","Seven OClock"),Ps("","Eight OClock"),Ps("","Nine OClock"),Ps("","Ten OClock"),Ps("","Eleven OClock"),Ps("","Twelve OClock"),Ps("","One-Thirty"),Ps("","Two-Thirty"),Ps("","Three-Thirty"),Ps("","Four-Thirty"),Ps("","Five-Thirty"),Ps("","Six-Thirty"),Ps("","Seven-Thirty"),Ps("","Eight-Thirty"),Ps("","Nine-Thirty"),Ps("","Ten-Thirty"),Ps("","Eleven-Thirty"),Ps("","Twelve-Thirty"),Ms("","Mantelpiece Clock"),Ps("","Watch"),Ps("","Alarm Clock"),Ms("","Stopwatch"),Ms("","Timer Clock"),Ps("","Hourglass Done"),Ps("","Hourglass Not Done"))),kd=Ms("","Clockwise Vertical Arrows"),Ld=Ms("","Counterclockwise Arrows Button"),_d=Ms("","Left-Right Arrow"),Td=Ms("","Up-Down Arrow"),Od=Ms("","Up-Left Arrow"),Rd=Ms("","Up-Right Arrow"),Ud=Ps("","Down-Right Arrow"),Qd=Ms("","Down-Right Arrow"),Nd=Ms("","Down-Left Arrow"),Hd=Ms("","Right Arrow Curving Left"),zd=Ms("","Left Arrow Curving Right"),Gd=Ms("","Right Arrow"),jd=Ms("","Right Arrow Curving Up"),Wd=Ms("","Right Arrow Curving Down"),Vd=Ms("","Left Arrow"),Zd=Ms("","Up Arrow"),Yd=Ms("","Down Arrow"),Xd=xs("Arrows","Arrows pointing in different directions",kd,Ld,_d,Td,Od,Rd,Qd,Nd,Hd,zd,Gd,jd,Wd,Vd,Zd,Yd),Jd=Ps("","CL Button"),Kd=Ps("","Cool Button"),qd=Ps("","Free Button"),$d=Ps("","ID Button"),tg=Ps("","New Button"),eg=Ps("","NG Button"),ig=Ps("","OK Button"),ng=Ps("","SOS Button"),sg=Ps("","Up! Button"),ag=Ps("","Vs Button"),og=Ps("","Radio Button"),rg=Ps("","Back Arrow"),hg=Ps("","End Arrow"),Ag=Ps("","On! Arrow"),cg=Ps("","Soon Arrow"),lg=Ps("","Top Arrow"),ug=Ms("","Check Box with Check"),dg=Ps("","Input Latin Uppercase"),gg=Ps("","Input Latin Lowercase"),pg=Ps("","Input Numbers"),mg=Ps("","Input Symbols"),fg=Ps("","Input Latin Letters"),vg=Ps("","Shuffle Tracks Button"),wg=Ps("","Repeat Button"),Bg=Ps("","Repeat Single Button"),Dg=Ps("","Upwards Button"),yg=Ps("","Downwards Button"),Cg=Ms("","Play Button"),bg=Ms("","Reverse Button"),Ig=Ms("","Eject Button"),Pg=Ps("","Fast-Forward Button"),Mg=Ps("","Fast Reverse Button"),xg=Ps("","Fast Up Button"),Eg=Ps("","Fast Down Button"),Fg=Ms("","Next Track Button"),Sg=Ms("","Last Track Button"),kg=Ms("","Play or Pause Button"),Lg=Ms("","Pause Button"),_g=Ms("","Stop Button"),Tg=Ms("","Record Button"),Og=xs("Buttons","Buttons",Jd,Kd,qd,$d,tg,eg,ig,ng,sg,ag,og,rg,hg,Ag,cg,lg,ug,dg,gg,pg,mg,fg,vg,wg,Bg,Dg,yg,Cg,Lg,bg,Ig,Pg,Mg,xg,Eg,Fg,Sg,kg,Lg,_g,Tg),Rg=xs("Zodiac","The symbology of astrology",Ps("","Aries"),Ps("","Taurus"),Ps("","Gemini"),Ps("","Cancer"),Ps("","Leo"),Ps("","Virgo"),Ps("","Libra"),Ps("","Scorpio"),Ps("","Sagittarius"),Ps("","Capricorn"),Ps("","Aquarius"),Ps("","Pisces"),Ps("","Ophiuchus")),Ug=Ms("0","Digit Zero"),Qg=Ms("1","Digit One"),Ng=Ms("2","Digit Two"),Hg=Ms("3","Digit Three"),zg=Ms("4","Digit Four"),Gg=Ms("5","Digit Five"),jg=Ms("6","Digit Six"),Wg=Ms("7","Digit Seven"),Vg=Ms("8","Digit Eight"),Zg=Ms("9","Digit Nine"),Yg=Ms("*","Asterisk"),Xg=Ms("#","Number Sign"),Jg=(xs("Numbers","Numbers",Ug,Qg,Ng,Hg,zg,Gg,jg,Wg,Vg,Zg,Yg,Xg,Fs(Ug,Ns,"Keycap Digit Zero"),Fs(Qg,Ns,"Keycap Digit One"),Fs(Ng,Ns,"Keycap Digit Two"),Fs(Hg,Ns,"Keycap Digit Three"),Fs(zg,Ns,"Keycap Digit Four"),Fs(Gg,Ns,"Keycap Digit Five"),Fs(jg,Ns,"Keycap Digit Six"),Fs(Wg,Ns,"Keycap Digit Seven"),Fs(Vg,Ns,"Keycap Digit Eight"),Fs(Zg,Ns,"Keycap Digit Nine"),Fs(Yg,Ns,"Keycap Asterisk"),Fs(Xg,Ns,"Keycap Number Sign"),Ps("","Keycap: 10")),Ps("","Tag Plus Sign")),Kg=Ps("","Tag Hyphen-Minus"),qg=(xs("Tags","Tags",Ps("","Tag Space"),Ps("","Tag Exclamation Mark"),Ps("","Tag Quotation Mark"),Ps("","Tag Number Sign"),Ps("","Tag Dollar Sign"),Ps("","Tag Percent Sign"),Ps("","Tag Ampersand"),Ps("","Tag Apostrophe"),Ps("","Tag Left Parenthesis"),Ps("","Tag Right Parenthesis"),Ps("","Tag Asterisk"),Jg,Ps("","Tag Comma"),Kg,Ps("","Tag Full Stop"),Ps("","Tag Solidus"),Ps("","Tag Digit Zero"),Ps("","Tag Digit One"),Ps("","Tag Digit Two"),Ps("","Tag Digit Three"),Ps("","Tag Digit Four"),Ps("","Tag Digit Five"),Ps("","Tag Digit Six"),Ps("","Tag Digit Seven"),Ps("","Tag Digit Eight"),Ps("","Tag Digit Nine"),Ps("","Tag Colon"),Ps("","Tag Semicolon"),Ps("","Tag Less-Than Sign"),Ps("","Tag Equals Sign"),Ps("","Tag Greater-Than Sign"),Ps("","Tag Question Mark"),Ps("","Tag Commercial at"),Ps("","Tag Latin Capital Letter a"),Ps("","Tag Latin Capital Letter B"),Ps("","Tag Latin Capital Letter C"),Ps("","Tag Latin Capital Letter D"),Ps("","Tag Latin Capital Letter E"),Ps("","Tag Latin Capital Letter F"),Ps("","Tag Latin Capital Letter G"),Ps("","Tag Latin Capital Letter H"),Ps("","Tag Latin Capital Letter I"),Ps("","Tag Latin Capital Letter J"),Ps("","Tag Latin Capital Letter K"),Ps("","Tag Latin Capital Letter L"),Ps("","Tag Latin Capital Letter M"),Ps("","Tag Latin Capital Letter N"),Ps("","Tag Latin Capital Letter O"),Ps("","Tag Latin Capital Letter P"),Ps("","Tag Latin Capital Letter Q"),Ps("","Tag Latin Capital Letter R"),Ps("","Tag Latin Capital Letter S"),Ps("","Tag Latin Capital Letter T"),Ps("","Tag Latin Capital Letter U"),Ps("","Tag Latin Capital Letter V"),Ps("","Tag Latin Capital Letter W"),Ps("","Tag Latin Capital Letter X"),Ps("","Tag Latin Capital Letter Y"),Ps("","Tag Latin Capital Letter Z"),Ps("","Tag Left Square Bracket"),Ps("","Tag Reverse Solidus"),Ps("","Tag Right Square Bracket"),Ps("","Tag Circumflex Accent"),Ps("","Tag Low Line"),Ps("","Tag Grave Accent"),Ps("","Tag Latin Small Letter a"),Ps("","Tag Latin Small Letter B"),Ps("","Tag Latin Small Letter C"),Ps("","Tag Latin Small Letter D"),Ps("","Tag Latin Small Letter E"),Ps("","Tag Latin Small Letter F"),Ps("","Tag Latin Small Letter G"),Ps("","Tag Latin Small Letter H"),Ps("","Tag Latin Small Letter I"),Ps("","Tag Latin Small Letter J"),Ps("","Tag Latin Small Letter K"),Ps("","Tag Latin Small Letter L"),Ps("","Tag Latin Small Letter M"),Ps("","Tag Latin Small Letter N"),Ps("","Tag Latin Small Letter O"),Ps("","Tag Latin Small Letter P"),Ps("","Tag Latin Small Letter Q"),Ps("","Tag Latin Small Letter R"),Ps("","Tag Latin Small Letter S"),Ps("","Tag Latin Small Letter T"),Ps("","Tag Latin Small Letter U"),Ps("","Tag Latin Small Letter V"),Ps("","Tag Latin Small Letter W"),Ps("","Tag Latin Small Letter X"),Ps("","Tag Latin Small Letter Y"),Ps("","Tag Latin Small Letter Z"),Ps("","Tag Left Curly Bracket"),Ps("","Tag Vertical Line"),Ps("","Tag Right Curly Bracket"),Ps("","Tag Tilde"),Ps("","Cancel Tag")),xs("Math","Math",Ms("","Multiply"),Ps("","Plus"),Ps("","Minus"),Ps("","Divide"))),$g=xs("Games","Games",Ms("","Spade Suit"),Ms("","Club Suit"),Ms("","Heart Suit",{color:"red"}),Ms("","Diamond Suit",{color:"red"}),Ps("","Mahjong Red Dragon"),Ps("","Joker"),Ps("","Direct Hit"),Ps("","Slot Machine"),Ps("","Pool 8 Ball"),Ps("","Game Die"),Ps("","Bowling"),Ps("","Flower Playing Cards"),Ps("","Puzzle Piece"),Ms("","Chess Pawn"),Ps("","Yo-Yo"),Ps("","Kite")),tp=xs("Sports Equipment","Sports equipment",Ps("","Running Shirt"),Ps("","Tennis"),Ps("","Skis"),Ps("","Basketball"),Ps("","Sports Medal"),Ps("","Trophy"),Ps("","American Football"),Ps("","Rugby Football"),Ps("","Cricket Game"),Ps("","Volleyball"),Ps("","Field Hockey"),Ps("","Ice Hockey"),Ps("","Ping Pong"),Ps("","Badminton"),Ps("","Sled"),Ps("","Goal Net"),Ps("","1st Place Medal"),Ps("","2nd Place Medal"),Ps("","3rd Place Medal"),Ps("","Boxing Glove"),Ps("","Curling Stone"),Ps("","Lacrosse"),Ps("","Softball"),Ps("","Flying Disc"),Ps("","Soccer Ball"),Ps("","Baseball"),Ms("","Ice Skate")),ep=xs("Clothing","Clothing",Ps("","Top Hat"),Ps("","Diving Mask"),Ps("","Womans Hat"),Ps("","Glasses"),Ms("","Sunglasses"),Ps("","Necktie"),Ps("","T-Shirt"),Ps("","Jeans"),Ps("","Dress"),Ps("","Kimono"),Ps("","Bikini"),Ps("","Womans Clothes"),Ps("","Purse"),Ps("","Handbag"),Ps("","Clutch Bag"),Ps("","Mans Shoe"),Ps("","Running Shoe"),Ps("","High-Heeled Shoe"),Ps("","Womans Sandal"),Ps("","Womans Boot"),Ps("","Martial Arts Uniform"),Ps("","Sari"),Ps("","Lab Coat"),Ps("","Goggles"),Ps("","Hiking Boot"),Ps("","Flat Shoe"),No,Qo,Ps("","Billed Cap"),Ps("","Scarf"),Ps("","Gloves"),Ps("","Coat"),Ps("","Socks"),Ps("","Nazar Amulet"),Ps("","Ballet Shoes"),Ps("","One-Piece Swimsuit"),Ps("","Briefs"),Ps("","Shorts")),ip=xs("Town","Town",Ms("","Building Construction"),Ms("","Houses"),Ms("","Cityscape"),Ms("","Derelict House"),Ms("","Classical Building"),Ms("","Desert"),Ms("","Desert Island"),Ms("","National Park"),Ms("","Stadium"),Ps("","House"),Ps("","House with Garden"),Ps("","Office Building"),Ps("","Japanese Post Office"),Ps("","Post Office"),Ps("","Hospital"),Ps("","Bank"),Ps("","ATM Sign"),Ps("","Hotel"),Ps("","Love Hotel"),Ps("","Convenience Store"),$a,Ps("","Department Store"),Ao,Ps("","Bridge at Night"),Ps("","Fountain"),Ms("","Shopping Bags"),Ps("","Receipt"),Ps("","Shopping Cart"),Ps("","Barber Pole"),Ps("","Wedding"),Ms("","Ballot Box with Ballot")),np=xs("Music","Music",Ps("","Musical Score"),Ps("","Musical Notes"),Ps("","Musical Note"),Ps("","Saxophone"),Ps("","Guitar"),Ps("","Musical Keyboard"),Ps("","Trumpet"),Ps("","Violin"),Ps("","Drum"),Ps("","Banjo")),sp=xs("Astronomy","Astronomy",Ps("","Milky Way"),Ps("","Globe Showing Europe-Africa"),Ps("","Globe Showing Americas"),Ps("","Globe Showing Asia-Australia"),Ps("","Globe with Meridians"),Ps("","New Moon"),Ps("","Waxing Crescent Moon"),Ps("","First Quarter Moon"),Ps("","Waxing Gibbous Moon"),Ps("","Full Moon"),Ps("","Waning Gibbous Moon"),Ps("","Last Quarter Moon"),Ps("","Waning Crescent Moon"),Ps("","Crescent Moon"),Ps("","New Moon Face"),Ps("","First Quarter Moon Face"),Ps("","Last Quarter Moon Face"),Ps("","Full Moon Face"),Ps("","Sun with Face"),Ps("","Glowing Star"),Ps("","Shooting Star"),Ms("","Comet"),Ps("","Ringed Planet")),ap=xs("Finance","Finance",Ps("","Money Bag"),Ps("","Currency Exchange"),Ps("","Heavy Dollar Sign"),Ps("","Credit Card"),Ps("","Yen Banknote"),Ps("","Dollar Banknote"),Ps("","Euro Banknote"),Ps("","Pound Banknote"),Ps("","Money with Wings"),Ps("","Chart Increasing with Yen")),op=xs("Writing","Writing",Ms("","Pen"),Ms("","Fountain Pen"),Ms("","Paintbrush"),Ms("","Crayon"),Ms("","Pencil"),Ms("","Black Nib")),rp=Ms("","Alembic"),hp=Ms("","Gear"),Ap=Ms("","Atom Symbol"),cp=Ms("","Keyboard"),lp=Ms("","Telephone"),up=Ms("","Studio Microphone"),dp=Ms("","Level Slider"),gp=Ms("","Control Knobs"),pp=Ps("","Movie Camera"),mp=Ps("","Headphone"),fp=Ps("","Video Game"),vp=Ps("","Light Bulb"),wp=Ps("","Computer Disk"),Bp=Ps("","Floppy Disk"),Dp=Ps("","Optical Disk"),yp=Ps("","DVD"),Cp=Ps("","Telephone Receiver"),bp=Ps("","Pager"),Ip=Ps("","Fax Machine"),Pp=Ps("","Satellite Antenna"),Mp=Ps("","Loudspeaker"),xp=Ps("","Megaphone"),Ep=Ps("","Mobile Phone"),Fp=Ps("","Mobile Phone with Arrow"),Sp=Ps("","Mobile Phone Vibrating"),kp=Ps("","Mobile Phone Off"),Lp=Ps("","No Mobile Phone"),_p=Ps("","Antenna Bars"),Tp=Ps("","Camera"),Op=Ps("","Camera with Flash"),Rp=Ps("","Video Camera"),Up=Ps("","Television"),Qp=Ps("","Radio"),Np=Ps("","Videocassette"),Hp=Ms("","Film Projector"),zp=Ps("","Dim Button"),Gp=Ps("","Bright Button"),jp=Ps("","Muted Speaker"),Wp=Ps("","Speaker Low Volume"),Vp=Ps("","Speaker Medium Volume"),Zp=Ps("","Speaker High Volume"),Yp=Ps("","Battery"),Xp=Ps("","Electric Plug"),Jp=Ps("","Magnifying Glass Tilted Left"),Kp=Ps("","Magnifying Glass Tilted Right"),qp=Ps("","Locked with Pen"),$p=Ps("","Locked with Key"),tm=Ps("","Key"),em=Ps("","Locked"),im=Ps("","Unlocked"),nm=Ps("","Bell"),sm=Ps("","Bell with Slash"),am=Ps("","Bookmark"),om=Ps("","Link"),rm=Ms("","Joystick"),hm=Ms("","Desktop Computer"),Am=Ms("","Printer"),cm=Ms("","Computer Mouse"),lm=Ms("","Trackball"),um=Ps("","Card Index Dividers"),dm=Ps("","Card File Box"),gm=Ps("","File Cabinet"),pm=Ps("","Wastebasket"),mm=Ps("","Spiral Note Pad"),fm=Ps("","Spiral Calendar"),vm=Ps("","Compression"),wm=Ps("","Old Key"),Bm=xs("Technology","Technology",rm,fp,vp,bo,lo,wp,Bp,Dp,yp,hm,cp,Am,cm,lm,lp,Cp,bp,Ip,Pp,Mp,xp,Up,Qp,Np,Hp,up,dp,gp,yo,pp,mp,Tp,Op,Rp,Ep,kp,Fp,qp,$p,em,im,nm,sm,am,om,Sp,_p,zp,Gp,jp,Wp,Vp,Zp,Yp,Xp),Dm=xs("Mail","Mail",Ps("","Outbox Tray"),Ps("","Inbox Tray"),Ps("","Package"),Ps("","E-Mail"),Ps("","Incoming Envelope"),Ps("","Envelope with Arrow"),Ps("","Closed Mailbox with Lowered Flag"),Ps("","Closed Mailbox with Raised Flag"),Ps("","Open Mailbox with Raised Flag"),Ps("","Open Mailbox with Lowered Flag"),Ps("","Postbox"),Ps("","Postal Horn")),ym=xs("Celebration","Celebration",Ps("","Ribbon"),Ps("","Wrapped Gift"),Ps("","Jack-O-Lantern"),Ps("","Christmas Tree"),Ps("","Firecracker"),Ps("","Fireworks"),Ps("","Sparkler"),Ps("","Sparkles"),Ms("","Sparkle"),Ps("","Balloon"),Ps("","Party Popper"),Ps("","Confetti Ball"),Ps("","Tanabata Tree"),Ps("","Pine Decoration"),Ps("","Japanese Dolls"),Ps("","Carp Streamer"),Ps("","Wind Chime"),Ps("","Moon Viewing Ceremony"),Ps("","Backpack"),Ka,Ps("","Red Envelope"),Ps("","Red Paper Lantern"),Ms("","Military Medal")),Cm=xs("Tools","Tools",Ps("","Fishing Pole"),Ps("","Flashlight"),ro,Ps("","Hammer"),Ps("","Nut and Bolt"),Ms("","Hammer and Wrench"),Ps("","Compass"),Ps("","Fire Extinguisher"),Ps("","Toolbox"),Ps("","Brick"),Ps("","Axe"),Ms("","Hammer and Pick"),Ms("","Pick"),Ms("","Rescue Workers Helmet"),Ms("","Chains"),vm),bm=xs("Office","Office",Ps("","File Folder"),Ps("","Open File Folder"),Ps("","Page with Curl"),Ps("","Page Facing Up"),Ps("","Calendar"),Ps("","Tear-Off Calendar"),Ps("","Card Index"),um,dm,gm,pm,mm,fm,Ps("","Chart Increasing"),Ps("","Chart Decreasing"),Ps("","Bar Chart"),Ps("","Clipboard"),Ps("","Pushpin"),Ps("","Round Pushpin"),Ps("","Paperclip"),Ms("","Linked Paperclips"),Ps("","Straight Ruler"),Ps("","Triangular Ruler"),Ps("","Bookmark Tabs"),Ps("","Ledger"),Ps("","Notebook"),Ps("","Notebook with Decorative Cover"),Ps("","Closed Book"),Ps("","Open Book"),Ps("","Green Book"),Ps("","Blue Book"),Ps("","Orange Book"),Ps("","Books"),Ps("","Name Badge"),Ps("","Scroll"),Ps("","Memo"),Ms("","Scissors"),Ms("","Envelope")),Im=xs("Signs","Signs",Ps("","Cinema"),Lp,Ps("","No One Under Eighteen"),Ps("","Prohibited"),Ps("","Cigarette"),Ps("","No Smoking"),Ps("","Litter in Bin Sign"),Ps("","No Littering"),Ps("","Potable Water"),Ps("","Non-Potable Water"),Ps("","No Bicycles"),Ps("","No Pedestrians"),Ps("","Children Crossing"),Ps("","Mens Room"),Ps("","Womens Room"),Ps("","Restroom"),Ps("","Baby Symbol"),Ps("","Water Closet"),Ps("","Passport Control"),Ps("","Customs"),Ps("","Baggage Claim"),Ps("","Left Luggage"),Ms("","Parking Button"),Ps("","Wheelchair Symbol"),Ms("","Radioactive"),Ms("","Biohazard"),Ms("","Warning"),Ps("","High Voltage"),Ps("","No Entry"),Ms("","Recycling Symbol"),Hs,zs,Gs),Pm=xs("Religion","Religion",Ps("","Dotted Six-Pointed Star"),Ms("","Star of David"),Ms("","Om"),Ps("","Kaaba"),Ps("","Mosque"),Ps("","Synagogue"),Ps("","Menorah"),Ps("","Place of Worship"),Ps("","Hindu Temple"),Ms("","Orthodox Cross"),Ms("","Latin Cross"),Ms("","Star and Crescent"),Ms("","Peace Symbol"),Ms("","Yin Yang"),Ms("","Wheel of Dharma"),Ms("","Infinity"),Ps("","Diya Lamp"),Ms("","Shinto Shrine"),Ps("","Church"),Ms("","Eight-Pointed Star"),Ps("","Prayer Beads")),Mm=Ps("","Door"),xm=xs("Household","Household",Ps("","Lipstick"),Ps("","Ring"),Ps("","Gem Stone"),Ps("","Newspaper"),tm,Ps("","Fire"),Ps("","Pistol"),Ms("","Candle"),Ms("","Framed Picture"),wm,Ms("","Rolled-Up Newspaper"),Ms("","World Map"),Mm,Ps("","Toilet"),Ps("","Shower"),Ps("","Bathtub"),Ms("","Couch and Lamp"),Ms("","Bed"),Ps("","Lotion Bottle"),Ps("","Thread"),Ps("","Yarn"),Ps("","Safety Pin"),Ps("","Teddy Bear"),Ps("","Broom"),Ps("","Basket"),Ps("","Roll of Paper"),Ps("","Soap"),Ps("","Sponge"),Ps("","Chair"),Ps("","Razor"),Ms("","Reminder Ribbon")),Em=xs("Activities","Activities",Ms("","Film Frames"),Ms("","Admission Tickets"),Ps("","Carousel Horse"),Ps("","Ferris Wheel"),Ps("","Roller Coaster"),Bo,Ps("","Circus Tent"),Ps("","Ticket"),Ps("","Clapper Board"),Ps("","Performing Arts")),Fm=xs("Travel","Travel",Ms("","Label"),Ps("","Volcano"),Ms("","Snow-Capped Mountain"),Ms("","Mountain"),Ms("","Camping"),Ms("","Beach with Umbrella"),Ms("","Umbrella on Ground"),Ps("","Japanese Castle"),Ps("","Footprints"),Ps("","Mount Fuji"),Ps("","Tokyo Tower"),Ps("","Statue of Liberty"),Ps("","Map of Japan"),Ps("","Moai"),Ms("","Bellhop Bell"),Ps("","Luggage"),Ps("","Flag in Hole"),Ps("","Tent"),Ms("","Hot Springs")),Sm=xs("Medieval","Medieval",Ps("","Castle"),Ps("","Bow and Arrow"),xo,Ps("","Trident Emblem"),Ms("","Dagger"),Ms("","Shield"),Ps("","Crystal Ball"),Ms("","Crossed Swords"),Ms("","Fleur-de-lis")),km=Ms("","Double Exclamation Mark"),Lm=Ms("","Exclamation Question Mark"),_m=Ms("","Information"),Tm=Ms("","Circled M"),Om=Ps("","Check Mark Button"),Rm=Ms("","Check Mark"),Um=Ms("","Eight-Spoked Asterisk"),Qm=Ps("","Cross Mark"),Nm=Ps("","Cross Mark Button"),Hm=Ps("","Question Mark"),zm=Ps("","White Question Mark"),Gm=Ps("","White Exclamation Mark"),jm=Ps("","Exclamation Mark"),Wm=Ps("","Curly Loop"),Vm=Ps("","Double Curly Loop"),Zm=Ms("","Wavy Dash"),Ym=Ms("","Part Alternation Mark"),Xm=Ms("","Trade Mark"),Jm=Ms("","Copyright"),Km=Ms("","Registered"),qm=Ms("","Square: Four Corners"),$m=(Es("Marks","Marks",{doubleExclamationMark:km,interrobang:Lm,information:_m,circledM:Tm,checkMarkButton:Om,checkMark:Rm,eightSpokedAsterisk:Um,crossMark:Qm,crossMarkButton:Nm,questionMark:Hm,whiteQuestionMark:zm,whiteExclamationMark:Gm,exclamationMark:jm,curlyLoop:Wm,doubleCurlyLoop:Vm,wavyDash:Zm,partAlternationMark:Ym,tradeMark:Xm,copyright:Jm,registered:Km}),Es("Science","Science",{droplet:Ps("","Droplet"),dropOfBlood:Ps("","Drop of Blood"),adhesiveBandage:Ps("","Adhesive Bandage"),stethoscope:Ps("","Stethoscope"),syringe:Ps("","Syringe"),pill:Ps("","Pill"),microscope:Po,testTube:Ps("","Test Tube"),petriDish:Ps("","Petri Dish"),dna:Ps("","DNA"),abacus:Ps("","Abacus"),magnet:Ps("","Magnet"),telescope:Ps("","Telescope"),medical:Xa,balanceScale:eo,alembic:rp,gear:hp,atomSymbol:Ap,magnifyingGlassTiltedLeft:Jp,magnifyingGlassTiltedRight:Kp})),tf=Ps("","White Chess King"),ef=Ps("","White Chess Queen"),nf=Ps("","White Chess Rook"),sf=Ps("","White Chess Bishop"),af=Ps("","White Chess Knight"),of=Ps("","White Chess Pawn"),rf=Es(tf.value+ef.value+nf.value+sf.value+af.value+of.value,"White Chess Pieces",{width:"auto",king:tf,queen:ef,rook:nf,bishop:sf,knight:af,pawn:of}),hf=Ps("","Black Chess King"),Af=Ps("","Black Chess Queen"),cf=Ps("","Black Chess Rook"),lf=Ps("","Black Chess Bishop"),uf=Ps("","Black Chess Knight"),df=Ps("","Black Chess Pawn"),gf=Es(hf.value+Af.value+cf.value+lf.value+uf.value+df.value,"Black Chess Pieces",{width:"auto",king:hf,queen:Af,rook:cf,bishop:lf,knight:uf,pawn:df}),pf=Es(of.value+df.value,"Chess Pawns",{width:"auto",white:of,black:df}),mf=Es(nf.value+cf.value,"Chess Rooks",{width:"auto",white:nf,black:cf}),ff=Es(sf.value+lf.value,"Chess Bishops",{width:"auto",white:sf,black:lf}),vf=Es(af.value+uf.value,"Chess Knights",{width:"auto",white:af,black:uf}),wf=Es(ef.value+Af.value,"Chess Queens",{width:"auto",white:ef,black:Af}),Bf=Es(tf.value+hf.value,"Chess Kings",{width:"auto",white:tf,black:hf}),Df=Es("Chess Pieces","Chess Pieces",{width:"auto",white:rf,black:gf,pawns:pf,rooks:mf,bishops:ff,knights:vf,queens:wf,kings:Bf}),yf=Es("Dice","Dice",{dice1:Ps("","Dice: Side 1"),dice2:Ps("","Dice: Side 2"),dice3:Ps("","Dice: Side 3"),dice4:Ps("","Dice: Side 4"),dice5:Ps("","Dice: Side 5"),dice6:Ps("","Dice: Side 6")}),Cf=Es("All Icons","All Icons",{faces:FA,love:qA,cartoon:Dc,hands:vl,bodyParts:nu,people:Br,gestures:Pa,inMotion:dr,resting:vr,roles:ko,fantasy:Uo,animals:du,plants:pu,food:fu,flags:Cu,vehicles:Fd,clocks:Sd,arrows:Xd,shapes:tu,buttons:Og,zodiac:Rg,chess:Df,dice:yf,math:qg,games:$g,sportsEquipment:tp,clothing:ep,town:ip,music:np,weather:ou,astro:sp,finance:ap,writing:op,science:$m,tech:Bm,mail:Dm,celebration:ym,tools:Cm,office:bm,signs:Im,religion:Pm,household:xm,activities:Em,travel:Fm,medieval:Sm}),bf=[];function If(t){const e=[];return t.fontStyle&&"normal"!==t.fontStyle&&e.push(t.fontStyle),t.fontVariant&&"normal"!==t.fontVariant&&e.push(t.fontVariant),t.fontWeight&&"normal"!==t.fontWeight&&e.push(t.fontWeight),e.push(t.fontSize+"px"),e.push(t.fontFamily),e.join(" ")}async function Pf(t,e=null,i){if(-1===bf.indexOf(t)){e=e||"The quick brown fox jumps over the lazy dog",i&&i(0,1,t);const n=await document.fonts.load(t,e);i&&i(1,1,t),0===n.length?console.warn(`Failed to load font "${t}". If this is a system font, just set the object's \`value\` property, instead of calling \`loadFontAndSetText\`.`):bf.push(t)}}function Mf(t,e,i){return(1-i)*t+i*e}class xf extends Event{constructor(){super("tick"),this.t=0,this.dt=0,this.sdt=0,Object.seal(this)}copy(t){this.t=t.t,this.dt=t.dt,this.sdt=t.sdt}set(t,e){this.t=t,this.dt=e,this.sdt=Mf(this.sdt,e,.01)}}class Ef extends m{constructor(t){super(),this._timer=null,this._frameTime=Number.MAX_VALUE,this._targetFPS=0,this.targetFrameRate=t,this._onTick=t=>{const e=new xf;let i=t;this._onTick=t=>{t>i&&(e.t=t,e.dt=t-i,e.sdt=e.dt,i=t,this._onTick=t=>{let n=t-i;n<-1e3&&(i=t-this._frameTime,n=this._frameTime),n>0&&n>=this._frameTime&&(e.set(t,n),i=t,this.dispatchEvent(e))})}}}restart(){this.stop(),this.start()}get isRunning(){return null!=this._timer}stop(){this._timer=null,this.dispatchEvent(new Event("stopped"))}get targetFrameRate(){return this._targetFPS}set targetFrameRate(t){this._targetFPS=t,this._frameTime=1e3/t}}const Ff="tele.calla.chat";class Sf{constructor(t,e,i){if(this.name=t,this.callback=e,!n(e))throw new Error("A function instance is required for this parameter");this.opts=i,Object.freeze(this)}apply(t){A(t)&&this.add(t)}add(t){t.addEventListener(this.name,this.callback,this.opts)}remove(t){t.removeEventListener(this.name,this.callback)}}function kf(t,e){return new Sf("click",t,e)}function Lf(t,e){return new Sf("input",t,e)}function _f(t){return n(t.isOpen)&&n(t.setOpen)&&n(t.toggleOpen)&&n(t.show)&&n(t.hide)}function Tf(t){return _f(t)?t.isOpen():"none"!==t.style.display}function Of(t,e,i=""){_f(t)?t.setOpen(e,i):e?Uf(t,i):Qf(t)}function Rf(t,e=""){_f(t)?t.toggleOpen(e):Tf(t)?Qf(t,e):Uf(t)}function Uf(t,e=""){_f(t)?t.show():t.style.display=e}function Qf(t,e=""){_f(t)?t.hide(e):t.style.display="none"}function Nf(t,e,i,s,a){a=a||"",t.accessKey&&(a+=` <kbd>(ALT+${t.accessKey.toUpperCase()})</kbd>`),n(t.updateLabel)?t.updateLabel(e,i,s,a):t.innerHTML=(e?i:s)+a}const Hf=C(!0),zf=C(!1);function Gf(t,e){n(t.setLocked)?t.setLocked(e):e?Hf.apply(t):zf.apply(t)}const jf=new p("toggleOptions"),Wf=new p("tweet"),Vf=new p("leave"),Zf=new p("toggleFullscreen"),Yf=new p("toggleInstructions"),Xf=new p("toggleUserDirectory"),Jf=new p("toggleAudio"),Kf=new p("toggleVideo"),qf=new p("changeDevices"),$f=new p("emote"),tv=new p("selectEmoji"),ev=new p("zoomChanged");class iv extends g{constructor(t,...e){super(),this.element=Y(t,...e)}get id(){return this.element.id}get eventTarget(){return this.element}isForwardedEvent(t){return!0}addEventListener(t,e,i){this.isForwardedEvent(t)?this.eventTarget.addEventListener(t,e,i):super.addEventListener(t,e,i)}removeEventListener(t,e){this.isForwardedEvent(t)?this.eventTarget.removeEventListener(t,e):super.removeEventListener(t,e)}get style(){return this.element.style}get visible(){return null!==this.style.display}set visible(t){Of(this.element,t)}get tagName(){return this.element.tagName}get disabled(){return!1}set disabled(t){}focus(){this.element.focus()}blur(){this.element.blur()}}const nv=C(!0),sv=C(!1);function av(t,e,i,n,...s){return new ov(t,e,i,n,...s)}class ov extends iv{constructor(t,e,i,s,...a){if(super("select",M(t),...a),this._emptySelectionEnabled=!1,this._values=new Array,!n(i))throw new Error("makeID parameter must be a Function");if(!n(s))throw new Error("makeLabel parameter must be a Function");this.noSelectionText=e,this.makeID=t=>null!==t&&i(t)||null,this.makeLabel=t=>null!==t&&s(t)||"None",this.emptySelectionEnabled=!0,Object.seal(this)}render(){if(function(t){for(;t.lastChild;)t.lastChild.remove()}(this.element),0===this.values.length)this.element.append(st(this.noSelectionText)),nv.apply(this.element);else{this.emptySelectionEnabled&&this.element.append(st(this.noSelectionText));for(let t of this.values)this.element.append(st(U(this.makeID(t)),this.makeLabel(t)));sv.apply(this.element)}}get emptySelectionEnabled(){return this._emptySelectionEnabled}set emptySelectionEnabled(t){this._emptySelectionEnabled=t,this.render()}get values(){return this._values}set values(t){const e=this.selectedValue;this._values.splice(0,this._values.length,...t),this.render(),this.selectedValue=e}get options(){return this.element.options}get selectedIndex(){let t=this.element.selectedIndex;return this.emptySelectionEnabled&&--t,t}set selectedIndex(t){this.emptySelectionEnabled&&++t,this.element.selectedIndex=t}get selectedValue(){return 0<=this.selectedIndex&&this.selectedIndex<this.values.length?this.values[this.selectedIndex]:null}set selectedValue(t){this.selectedIndex=this.indexOf(t)}get selectedText(){const t=this.element.selectedOptions;return 1===t.length?t[0].textContent||t[0].innerText:""}set selectedText(t){const e=this.values.findIndex((e=>null!==t&&this.makeLabel(e)===t));this.selectedIndex=e}indexOf(t){return u(t)?-1:this.values.findIndex((e=>this.makeID(t)===this.makeID(e)))}contains(t){return this.indexOf(t)>=0}}const rv=new p("hidden"),hv=new p("shown");class Av extends m{constructor(t){super(),this.element=$(M(t)),this.header=this.element.querySelector(".header"),this.content=this.element.querySelector(".content"),this.footer=this.element.querySelector(".footer");const e=this.element.querySelector(".dialogTitle > button.closeButton");e&&e.addEventListener("click",(()=>Qf(this)))}isOpen(){return"none"!==this.style.display}setOpen(t,e){this.style.display=t?e||"":"none"}toggleOpen(t){this.setOpen(!this.isOpen(),t)}get tagName(){return this.element.tagName}get disabled(){return!1}set disabled(t){}get style(){return this.element.style}appendChild(t){return this.element.appendChild(t)}append(...t){this.element.append(...t)}show(){Uf(this.element),this.dispatchEvent(hv)}async showAsync(){Uf(this),await ut(this,"hidden")}hide(){Qf(this.element),this.dispatchEvent(rv)}}const cv=new p("audioInputChanged"),lv=new p("audioOutputChanged"),uv=new p("videoInputChanged");function dv(t,e,i,n){return u(i)&&(i=1),u(n)&&(n=1),new B("gridArea",`${e}/${t}/${e+n}/${t+i}`)}function gv(t,e){return u(e)&&(e=1),new B("gridRow",`${t}/${t+e}`)}const pv=G("grid");function mv(...t){return H(pv,(e=t.join(" "),new B("gridTemplateColumns",e)));var e}const fv=C(!0),vv=C(!1);class wv extends p{constructor(t){super("emojiSelected"),this.emoji=t}}const Bv=new p("emojiCanceled");const Dv=new p("login");class yv extends p{constructor(t,e){super(t),this.button=e}}class Cv extends yv{constructor(t){super("gamepadButtonUp",t)}}class bv extends yv{constructor(t){super("gamepadButtonDown",t)}}class Iv extends p{constructor(t,e){super(t),this.axis=e}}class Pv extends Iv{constructor(t){super("gamepadAxisMaxed",t)}}class Mv extends m{constructor(t){super(),this.lastButtons=new Array,this.buttons=new Array,this.axes=new Array,this.hapticActuators=new Array,this.btnDownEvts=new Array,this.btnUpEvts=new Array,this.btnState=new Array,this.axisThresholdMax=.9,this.axisThresholdMin=.1,this.axisMaxEvts=new Array,this.axisMaxed=new Array,this.sticks=new Array,this.id=t.id,this.displayId=t.displayId,this.connected=t.connected,this.hand=t.hand,this.pose=t.pose,this._isStick=e=>e%2==0&&e<t.axes.length-1;for(let e=0;e<t.buttons.length;++e)this.btnDownEvts[e]=new bv(e),this.btnUpEvts[e]=new Cv(e),this.btnState[e]=!1,this.buttons[e]=t.buttons[e];for(let e=0;e<t.axes.length;++e)this.axisMaxEvts[e]=new Pv(e),this.axisMaxed[e]=!1,this._isStick(e)&&(this.sticks[e/2]={x:0,y:0}),this.axes[e]=t.axes[e];if(null!=t.hapticActuators)for(let e=0;e<t.hapticActuators.length;++e)this.hapticActuators[e]=t.hapticActuators[e];Object.seal(this)}update(t){this.connected=t.connected,this.hand=t.hand,this.pose=t.pose;for(let e=0;e<t.buttons.length;++e){const i=this.btnState[e],n=t.buttons[e].pressed;n!==i&&(this.btnState[e]=n,this.dispatchEvent((n?this.btnDownEvts:this.btnUpEvts)[e])),this.lastButtons[e]=this.buttons[e],this.buttons[e]=t.buttons[e]}for(let e=0;e<t.axes.length;++e){const i=this.axisMaxed[e],n=t.axes[e],s=Math.sign(n),a=Math.abs(n),o=a>=this.axisThresholdMax,r=a<=this.axisThresholdMin;o&&!i&&this.dispatchEvent(this.axisMaxEvts[e]),this.axes[e]=s*(o?1:r?0:a)}for(let t=0;t<this.axes.length-1;t+=2){const e=this.sticks[t/2];e.x=this.axes[t],e.y=this.axes[t+1]}if(null!=t.hapticActuators)for(let e=0;e<t.hapticActuators.length;++e)this.hapticActuators[e]=t.hapticActuators[e]}}const xv="CallaSettings";class Ev extends Event{constructor(){super("inputBindingChanged")}}const Fv=new Ev;class Sv extends m{constructor(){super(),this.bindings=new Map([["keyButtonUp","ArrowUp"],["keyButtonDown","ArrowDown"],["keyButtonLeft","ArrowLeft"],["keyButtonRight","ArrowRight"],["keyButtonEmote","e"],["keyButtonToggleAudio","a"],["keyButtonZoomOut","["],["keyButtonZoomIn","]"],["gpAxisLeftRight",0],["gpAxisUpDown",1],["gpButtonEmote",0],["gpButtonToggleAudio",1],["gpButtonZoomIn",6],["gpButtonZoomOut",7],["gpButtonUp",12],["gpButtonDown",13],["gpButtonLeft",14],["gpButtonRight",15]]);for(let t of this.bindings.keys())Object.defineProperty(this,t,{get:()=>this.bindings.get(t),set:e=>{this.bindings.has(t)&&e!==this.bindings.get(t)&&(this.bindings.set(t,e),this.dispatchEvent(Fv))}});Object.freeze(this)}get(t){return this.bindings.get(t)}set(t,e){this.bindings.set(t,e)}get keyButtonUp(){return this.bindings.get("keyButtonUp")}set keyButtonUp(t){this.checkedSet("keyButtonUp",t)}get keyButtonDown(){return this.bindings.get("keyButtonDown")}set keyButtonDown(t){this.checkedSet("keyButtonDown",t)}get keyButtonLeft(){return this.bindings.get("keyButtonLeft")}set keyButtonLeft(t){this.checkedSet("keyButtonLeft",t)}get keyButtonRight(){return this.bindings.get("keyButtonRight")}set keyButtonRight(t){this.checkedSet("keyButtonRight",t)}get keyButtonEmote(){return this.bindings.get("keyButtonEmote")}set keyButtonEmote(t){this.checkedSet("keyButtonEmote",t)}get keyButtonToggleAudio(){return this.bindings.get("keyButtonToggleAudio")}set keyButtonToggleAudio(t){this.checkedSet("keyButtonToggleAudio",t)}get keyButtonZoomOut(){return this.bindings.get("keyButtonZoomOut")}set keyButtonZoomOut(t){this.checkedSet("keyButtonZoomOut",t)}get keyButtonZoomIn(){return this.bindings.get("keyButtonZoomIn")}set keyButtonZoomIn(t){this.checkedSet("keyButtonZoomIn",t)}get gpAxisLeftRight(){return this.bindings.get("gpAxisLeftRight")}set gpAxisLeftRight(t){this.checkedSet("gpAxisLeftRight",t)}get gpAxisUpDown(){return this.bindings.get("gpAxisUpDown")}set gpAxisUpDown(t){this.checkedSet("gpAxisUpDown",t)}get gpButtonEmote(){return this.bindings.get("gpButtonEmote")}set gpButtonEmote(t){this.checkedSet("gpButtonEmote",t)}get gpButtonToggleAudio(){return this.bindings.get("gpButtonToggleAudio")}set gpButtonToggleAudio(t){this.checkedSet("gpButtonToggleAudio",t)}get gpButtonZoomIn(){return this.bindings.get("gpButtonZoomIn")}set gpButtonZoomIn(t){this.checkedSet("gpButtonZoomIn",t)}get gpButtonZoomOut(){return this.bindings.get("gpButtonZoomOut")}set gpButtonZoomOut(t){this.checkedSet("gpButtonZoomOut",t)}get gpButtonUp(){return this.bindings.get("gpButtonUp")}set gpButtonUp(t){this.checkedSet("gpButtonUp",t)}get gpButtonDown(){return this.bindings.get("gpButtonDown")}set gpButtonDown(t){this.checkedSet("gpButtonDown",t)}get gpButtonLeft(){return this.bindings.get("gpButtonLeft")}set gpButtonLeft(t){this.checkedSet("gpButtonLeft",t)}get gpButtonRight(){return this.bindings.get("gpButtonRight")}set gpButtonRight(t){this.checkedSet("gpButtonRight",t)}checkedSet(t,e){this.bindings.has(t)&&e!==this.bindings.get(t)&&(this.bindings.set(t,e),this.dispatchEvent(Fv))}toJSON(){return{keyButtonUp:this.keyButtonUp,keyButtonDown:this.keyButtonDown,keyButtonLeft:this.keyButtonLeft,keyButtonRight:this.keyButtonRight,keyButtonEmote:this.keyButtonEmote,keyButtonToggleAudio:this.keyButtonToggleAudio,keyButtonZoomOut:this.keyButtonZoomOut,keyButtonZoomIn:this.keyButtonZoomIn,gpAxisLeftRight:this.gpAxisLeftRight,gpAxisUpDown:this.gpAxisUpDown,gpButtonEmote:this.gpButtonEmote,gpButtonToggleAudio:this.gpButtonToggleAudio,gpButtonZoomIn:this.gpButtonZoomIn,gpButtonZoomOut:this.gpButtonZoomOut,gpButtonUp:this.gpButtonUp,gpButtonDown:this.gpButtonDown,gpButtonLeft:this.gpButtonLeft,gpButtonRight:this.gpButtonRight}}copy(t){t&&(this.keyButtonUp=t.keyButtonUp,this.keyButtonDown=t.keyButtonDown,this.keyButtonLeft=t.keyButtonLeft,this.keyButtonRight=t.keyButtonRight,this.keyButtonEmote=t.keyButtonEmote,this.keyButtonToggleAudio=t.keyButtonToggleAudio,this.keyButtonZoomOut=t.keyButtonZoomOut,this.keyButtonZoomIn=t.keyButtonZoomIn,this.gpAxisLeftRight=t.gpAxisLeftRight,this.gpAxisUpDown=t.gpAxisUpDown,this.gpButtonEmote=t.gpButtonEmote,this.gpButtonToggleAudio=t.gpButtonToggleAudio,this.gpButtonZoomIn=t.gpButtonZoomIn,this.gpButtonZoomOut=t.gpButtonZoomOut,this.gpButtonUp=t.gpButtonUp,this.gpButtonDown=t.gpButtonDown,this.gpButtonLeft=t.gpButtonLeft,this.gpButtonRight=t.gpButtonRight)}fix(t){this.bindings.has("keyButtonUp")||(this.keyButtonUp=t.keyButtonUp),this.bindings.has("keyButtonDown")||(this.keyButtonDown=t.keyButtonDown),this.bindings.has("keyButtonLeft")||(this.keyButtonLeft=t.keyButtonLeft),this.bindings.has("keyButtonRight")||(this.keyButtonRight=t.keyButtonRight),this.bindings.has("keyButtonEmote")||(this.keyButtonEmote=t.keyButtonEmote),this.bindings.has("keyButtonToggleAudio")||(this.keyButtonToggleAudio=t.keyButtonToggleAudio),this.bindings.has("keyButtonZoomOut")||(this.keyButtonZoomOut=t.keyButtonZoomOut),this.bindings.has("keyButtonZoomIn")||(this.keyButtonZoomIn=t.keyButtonZoomIn),this.bindings.has("gpAxisLeftRight")||(this.gpAxisLeftRight=t.gpAxisLeftRight),this.bindings.has("gpAxisUpDown")||(this.gpAxisUpDown=t.gpAxisUpDown),this.bindings.has("gpButtonEmote")||(this.gpButtonEmote=t.gpButtonEmote),this.bindings.has("gpButtonToggleAudio")||(this.gpButtonToggleAudio=t.gpButtonToggleAudio),this.bindings.has("gpButtonZoomIn")||(this.gpButtonZoomIn=t.gpButtonZoomIn),this.bindings.has("gpButtonZoomOut")||(this.gpButtonZoomOut=t.gpButtonZoomOut),this.bindings.has("gpButtonUp")||(this.gpButtonUp=t.gpButtonUp),this.bindings.has("gpButtonDown")||(this.gpButtonDown=t.gpButtonDown),this.bindings.has("gpButtonLeft")||(this.gpButtonLeft=t.gpButtonLeft),this.bindings.has("gpButtonRight")||(this.gpButtonRight=t.gpButtonRight)}}const kv=Object.freeze({keyButtonUp:"ArrowUp",keyButtonDown:"ArrowDown",keyButtonLeft:"ArrowLeft",keyButtonRight:"ArrowRight",keyButtonEmote:"e",keyButtonToggleAudio:"a",keyButtonZoomOut:"[",keyButtonZoomIn:"]",gpAxisLeftRight:0,gpAxisUpDown:1,gpButtonEmote:0,gpButtonToggleAudio:1,gpButtonZoomIn:6,gpButtonZoomOut:7,gpButtonUp:12,gpButtonDown:13,gpButtonLeft:14,gpButtonRight:15});function Lv(t,e,i,...n){return new _v(t,e,i,...n)}class _v extends iv{constructor(t,e,i,...n){super("div"),this.label=it(b(t),i),this.input=et(R(e),...n),this.element.append(this.label,this.input),this.element.style.display="grid",Object.seal(this)}get eventTarget(){return this.input}get value(){return this.input.value}set value(t){this.input.value=t}get checked(){return this.input.checked}set checked(t){this.input.checked=t}setLocked(t){Gf(this.input,t)}}const Tv=new p("select");function Ov(t,e,...i){return new Rv(t,e,...i)}class Rv extends iv{constructor(t,e,...i){super("div",M(t),at(...i)),this.button=K(M(t+"Btn"),kf((()=>this.dispatchEvent(Tv))),e)}isForwardedEvent(t){return"select"!==t}get visible(){return super.visible}set visible(t){super.visible=t,this.button.className=t?"tabSelected":"tabUnselected",this.element.className=t?"tabSelected":"tabUnselected"}}class Uv extends Event{constructor(){super("avatarURLChanged")}}class Qv extends Event{constructor(){super("gamepadChanged")}}class Nv extends Event{constructor(){super("selectAvatar")}}class Hv extends Event{constructor(){super("fontSizeChanged")}}class zv extends Event{constructor(){super("inputBindingChanged")}}class Gv extends Event{constructor(){super("audioPropertiesChanged")}}class jv extends Event{constructor(){super("toggleDrawHearing")}}class Wv extends Event{constructor(){super("toggleVideo")}}class Vv extends Event{constructor(){super("gamepadButtonUp"),this.button=0}}class Zv extends Event{constructor(){super("gamepadAxisMaxed"),this.axis=0}}const Yv=Q("7em"),Xv=Q("3em"),Jv=new Uv,Kv=new Qv,qv=new Nv,$v=new Hv,tw=new zv,ew=new Gv,iw=new jv,nw=new Wv,sw=new Vv,aw=new Zv,ow=C(!0),rw=C(!1);const hw=z("lightgreen"),Aw=z("rgba(65, 255, 202, 0.25)"),cw=z("transparent");class lw extends Event{constructor(){super("warpTo"),this.id=null}}const uw=new lw;function dw(t,e,i){return t*(i-e)+e}let gw;if(!Object.prototype.hasOwnProperty.call(CanvasRenderingContext2D.prototype,"getTransform")&&Object.prototype.hasOwnProperty.call(CanvasRenderingContext2D.prototype,"mozCurrentTransform")){class t{constructor(t){this.a=t[0],this.b=t[1],this.c=t[2],this.d=t[3],this.e=t[4],this.f=t[5]}get is2D(){return!0}get isIdentity(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f}transformPoint(t){return void 0!==t&&void 0!==t.x&&void 0!==t.y?{x:t.x*this.a+t.y*this.c+this.e,y:t.x*this.b+t.y*this.d+this.f}:null}}gw=e=>new t(e.mozCurrentTransform)}else gw=t=>t.getTransform();function pw(t){return gw(t)}const mw=new p("redrawn");class fw extends m{constructor(){super(),this._minWidth=null,this._maxWidth=null,this._minHeight=null,this._maxHeight=null,this._strokeColor=null,this._strokeSize=null,this._bgColor=null,this._value=null,this._scale=1,this._fillColor="black",this._textDirection="horizontal",this._wrapWords=!0,this._fontStyle="normal",this._fontVariant="normal",this._fontWeight="normal",this._fontFamily="sans-serif",this._fontSize=20,this._padding={top:0,right:0,bottom:0,left:0},this._canvas=Dt(10,10);const t=this.canvas.getContext("2d");if(!t)throw new Error("Couldn't create a graphics context for the TextImage canvas.");this._g=t}async loadFontAndSetText(t=null){const e=If(this);await Pf(e,t),this.value=t}get scale(){return this._scale}set scale(t){this.scale!==t&&(this._scale=t,this.redraw())}get minWidth(){return this._minWidth}set minWidth(t){this.minWidth!==t&&(this._minWidth=t,this.redraw())}get maxWidth(){return this._maxWidth}set maxWidth(t){this.maxWidth!==t&&(this._maxWidth=t,this.redraw())}get minHeight(){return this._minHeight}set minHeight(t){this.minHeight!==t&&(this._minHeight=t,this.redraw())}get maxHeight(){return this._maxHeight}set maxHeight(t){this.maxHeight!==t&&(this._maxHeight=t,this.redraw())}get canvas(){return this._canvas}get width(){return this.canvas.width/this.scale}get height(){return this.canvas.height/this.scale}get padding(){return this._padding}set padding(t){if(t instanceof Array)throw new Error("Invalid padding");this.padding.top===t.top&&this.padding.right==t.right&&this.padding.bottom==t.bottom&&this.padding.left==t.left||(this._padding=t,this.redraw())}get wrapWords(){return this._wrapWords}set wrapWords(t){this.wrapWords!==t&&(this._wrapWords=t,this.redraw())}get textDirection(){return this._textDirection}set textDirection(t){this.textDirection!==t&&(this._textDirection=t,this.redraw())}get fontStyle(){return this._fontStyle}set fontStyle(t){this.fontStyle!==t&&(this._fontStyle=t,this.redraw())}get fontVariant(){return this._fontVariant}set fontVariant(t){this.fontVariant!==t&&(this._fontVariant=t,this.redraw())}get fontWeight(){return this._fontWeight}set fontWeight(t){this.fontWeight!==t&&(this._fontWeight=t,this.redraw())}get fontSize(){return this._fontSize}set fontSize(t){this.fontSize!==t&&(this._fontSize=t,this.redraw())}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.redraw())}get fillColor(){return this._fillColor}set fillColor(t){this.fillColor!==t&&(this._fillColor=t,this.redraw())}get strokeColor(){return this._strokeColor}set strokeColor(t){this.strokeColor!==t&&(this._strokeColor=t,this.redraw())}get strokeSize(){return this._strokeSize}set strokeSize(t){this.strokeSize!==t&&(this._strokeSize=t,this.redraw())}get bgColor(){return this._bgColor}set bgColor(t){this.bgColor!==t&&(this._bgColor=t,this.redraw())}get value(){return this._value}set value(t){this.value!==t&&(this._value=t,this.redraw())}draw(t,e,i){this._canvas.width>0&&this._canvas.height>0&&t.drawImage(this._canvas,e,i,this.width,this.height)}split(t){return this.wrapWords?t.split(" ").join("\n").replace(/\r\n/,"\n").split("\n"):t.replace(/\r\n/,"\n").split("\n")}redraw(){if(this._g.clearRect(0,0,this.canvas.width,this.canvas.height),this.fontFamily&&this.fontSize&&(this.fillColor||this.strokeColor&&this.strokeSize)&&this.value){const t=this.textDirection&&0===this.textDirection.indexOf("vertical"),e=null!=this.minWidth||null!=this.maxWidth||null!=this.minHeight||null!=this.maxHeight,i=((this.minWidth||0)-this.padding.right-this.padding.left)*this.scale,n=((this.maxWidth||4096)-this.padding.right-this.padding.left)*this.scale,s=((this.minHeight||0)-this.padding.top-this.padding.bottom)*this.scale,a=((this.maxHeight||4096)-this.padding.top-this.padding.bottom)*this.scale,r=t?s:i,h=t?a:n,A=t?i:s,c=t?n:a,l=[],u=this.split(this.value);let d=0,g=0,p=0,m=!1,f=!1,v=1e4,w=0,B=Ft(this.fontSize*this.scale,w,v),D=null,y=Number.MAX_VALUE;do{const t=this.fontSize;this._fontSize=B;const i=If(this);this._fontSize=t,this._g.textAlign="center",this._g.textBaseline="middle",this._g.font=i,g=0,p=0;for(const t of u){const i=this._g.measureText(t);g=Math.max(g,i.width),p+=B,o(i.actualBoundingBoxLeft)&&o(i.actualBoundingBoxRight)&&o(i.actualBoundingBoxAscent)&&o(i.actualBoundingBoxDescent)&&(e||(g=i.actualBoundingBoxLeft+i.actualBoundingBoxRight,p=i.actualBoundingBoxAscent+i.actualBoundingBoxDescent,d=(i.actualBoundingBoxLeft-g/2)/2))}if(e){const t=g-r,e=g-h,i=p-A,n=p-c,s=Math.abs(t),a=Math.abs(e),o=Math.abs(i),u=Math.abs(n);m=e>1||n>1,f=t<-1&&i<-1;const d=Math.min(s,Math.min(a,Math.min(o,u)));d<y&&(y=d,D=this._g.font),(m||f)&&l.indexOf(this._g.font)>-1&&D&&(this._g.font=D,m=!1,f=!1),m?(v=B,B=(w+B)/2):f&&(w=B,B=(B+v)/2)}l.push(this._g.font)}while(m||f);e&&(g<r?g=r:g>h&&(g=h),p<A?p=A:p>c&&(p=c));const C=g+this.scale*(this.padding.right+this.padding.left),b=p+this.scale*(this.padding.top+this.padding.bottom);try{Pt(this._g,C,b)}catch(t){throw console.error(t),t}this.bgColor?(this._g.fillStyle=this.bgColor,this._g.fillRect(0,0,this.canvas.width,this.canvas.height)):this._g.clearRect(0,0,this.canvas.width,this.canvas.height),this.strokeColor&&this.strokeSize&&(this._g.lineWidth=this.strokeSize*this.scale,this._g.strokeStyle=this.strokeColor),this.fillColor&&(this._g.fillStyle=this.fillColor);const I=.5*(u.length-1);for(let t=0;t<u.length;++t){const e=u[t],i=(t-I)*B,n=d+this.canvas.width/2,s=i+this.canvas.height/2;this.strokeColor&&this.strokeSize&&this._g.strokeText(e,n,s),this.fillColor&&this._g.fillText(e,n,s)}if(t){const t=Dt(this.canvas.height,this.canvas.width),e=t.getContext("2d");e?(e.translate(t.width/2,t.height/2),"vertical"===this.textDirection||"vertical-left"===this.textDirection?e.rotate(Math.PI/2):"vertical-right"===this.textDirection&&e.rotate(-Math.PI/2),e.translate(-this.canvas.width/2,-this.canvas.height/2),e.drawImage(this.canvas,0,0),Pt(this._g,t.width,t.height)):console.warn("Couldn't rotate the TextImage"),this._g.drawImage(t,0,0)}this.dispatchEvent(mw)}}}class vw{constructor(t,e,i){this.emoji=t,this.x=e,this.y=i,this.life=1,this.width=-1,this.emoteText=null,this.dx=Math.random()-.5,this.dy=.5*-Math.random()-.5,this.emoteText=new fw,this.emoteText.fontFamily="Noto Color Emoji",this.emoteText.value=t.value}isDead(){return this.life<=.01}update(t){this.life-=t/3,this.dx*=.99,this.dy*=.99,this.x+=this.dx*t,this.y+=this.dy*t}drawShadow(t,e){const i=pw(t).a;t.save(),t.shadowColor="rgba(0, 0, 0, 0.5)",t.shadowOffsetX=3*i,t.shadowOffsetY=3*i,t.shadowBlur=3*i,this.drawEmote(t,e),t.restore()}drawEmote(t,e){const i=t.globalAlpha,n=pw(t).a;t.globalAlpha=this.life,this.emoteText.fontSize=e.tileHeight/2,this.emoteText.scale=n,this.emoteText.draw(t,this.x*e.tileWidth-this.width/2,this.y*e.tileHeight),t.globalAlpha=i}}class ww extends p{constructor(t){super(t),this.pointerType=null,this.pointerID=null,this.x=0,this.y=0,this.dx=0,this.dy=0,this.dz=0,this.u=0,this.v=0,this.du=0,this.dv=0,this.buttons=0,this.dragDistance=0,Object.seal(this)}}class Bw extends p{constructor(t){super("inputTypeChanging"),this.newInputType=t,Object.freeze(this)}}class Dw{constructor(t){if("wheel"!==t.type){const e=t;this.type=e.pointerType,this.id=e.pointerId}else this.type="mouse",this.id=0;this.buttons=t.buttons,this.moveDistance=0,this.dragDistance=0,this.x=t.offsetX,this.y=t.offsetY,this.dx=t.movementX,this.dy=t.movementY,Object.seal(this)}}const yw=new ww("pointerdown"),Cw=new ww("pointerup"),bw=new ww("click"),Iw=new ww("move"),Pw=new ww("drag");class Mw extends m{constructor(t){super(),this.pointers=new Map,this.currentInputType=null;let e=!0;const i=(e,i,n)=>{e.pointerType=i.type,e.pointerID=i.id,e.buttons=i.buttons,e.x=i.x,e.y=i.y,e.u=dw(Be(e.x,0,t.clientWidth),-1,1),e.v=dw(Be(e.y,0,t.clientHeight),-1,1),e.dx=i.dx,e.dy=i.dy,e.dz=n,e.du=2*e.dx/t.clientWidth,e.dv=2*e.dy/t.clientHeight,e.dragDistance=i.dragDistance,this.dispatchEvent(e)},n=t=>{const e=this.pointers.get(t.id);return e&&(t.dragDistance=e.dragDistance,document.pointerLockElement&&(t.x=e.x+t.dx,t.y=e.y+t.dy)),t.moveDistance=Math.sqrt(t.dx*t.dx+t.dy*t.dy),this.pointers.set(t.id,t),e};t.addEventListener("wheel",(t=>{if(!(t.shiftKey||t.altKey||t.ctrlKey||t.metaKey)){t.preventDefault();const e=new Dw(t);n(e);const s=-t.deltaY*(cs?1:.02);i(Iw,e,s)}}),{passive:!1}),t.addEventListener("pointerdown",(t=>{const s=this.pressCount,a=new Dw(t);n(a);const o=this.pressCount;a.type!==this.currentInputType&&(this.dispatchEvent(new Bw(a.type)),this.currentInputType=a.type),i(yw,a,0),e=0===s&&1===o}));t.addEventListener("pointermove",(t=>{const s=this.pinchDistance,a=new Dw(t),o=n(a),r=this.pressCount,h=((t,i)=>{if(null!==t&&null!==i)return e=!1,(i-t)/10;return 0})(s,this.pinchDistance);i(Iw,a,h),1===r&&1===a.buttons&&o&&o.buttons===a.buttons&&(a.dragDistance+=a.moveDistance,a.dragDistance>5&&(e=!1,i(Pw,a,0)))})),t.addEventListener("pointerup",(t=>{const s=new Dw(t),a=n(s);s.buttons=a.buttons,i(Cw,s,0),e&&i(bw,s,0),s.dragDistance=0,"touch"===s.type&&this.pointers.delete(s.id)})),t.addEventListener("contextmenu",(t=>{t.preventDefault()})),t.addEventListener("pointercancel",(t=>{this.pointers.has(t.pointerId)&&this.pointers.delete(t.pointerId)}))}get primaryPointer(){for(let t of this.pointers.values())return t;return null}getPointerCount(t){let e=0;for(const i of this.pointers.values())i.type===t&&++e;return e}get pressCount(){let t=0;for(let e of this.pointers.values())e.buttons>0&&++t;return t}get pinchDistance(){if(2!==this.pressCount)return null;let t,e;for(let i of this.pointers.values())if(1===i.buttons)if(t){if(e)break;e=i}else t=i;const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}}function xw(t){let e=t;const i=new Array;for(;e.parent;)i.unshift(e),e=e.parent;return i}function Ew(t,e,i,n){t.cleanDirty();const s=(n=n||{}).heuristic||Fw.manhattan,a=n.closest||!1,o=new _w((function(t){return t.f}));let r=e;for(e.h=s(e,i),t.markDirty(e),o.push(e);o.size()>0;){const e=o.pop();if(e===i)return xw(e);e.closed=!0;const n=t.neighbors(e);for(const h of n){if(h.closed||h.isWall())continue;const n=e.g+h.getCost(e),A=h.visited;(!A||n<h.g)&&(h.visited=!0,h.parent=e,h.h=h.h||s(h,i),h.g=n,h.f=h.g+h.h,t.markDirty(h),a&&(h.h<r.h||h.h===r.h&&h.g<r.g)&&(r=h),A?o.rescoreElement(h):o.push(h))}}return a?xw(r):[]}const Fw={manhattan:(t,e)=>Math.abs(e.x-t.x)+Math.abs(e.y-t.y),diagonal(t,e){const i=Math.sqrt(2),n=Math.abs(e.x-t.x),s=Math.abs(e.y-t.y);return 1*(n+s)+(i-2)*Math.min(n,s)}};function Sw(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}class kw{constructor(t,e){this.dirtyNodes=new Array,this.grid=null,this.diagonal=!0,e&&(this.diagonal=!1!==e.diagonal),this.nodes=new Array,this.grid=new Array;for(let e=0;e<t.length;e++){const i=t[e];this.grid[e]=new Array(i.length);for(let t=0;t<i.length;t++){const n=new Lw(e,t,i[t]);this.grid[e][t]=n,this.nodes.push(n)}}this.init()}init(){Jt(this.dirtyNodes);for(let t=0;t<this.nodes.length;t++)Sw(this.nodes[t])}cleanDirty(){for(let t=0;t<this.dirtyNodes.length;t++)Sw(this.dirtyNodes[t]);Jt(this.dirtyNodes)}markDirty(t){this.dirtyNodes.push(t)}neighbors(t){const e=[],i=t.x,n=t.y,s=this.grid;return s[i-1]&&s[i-1][n]&&e.push(s[i-1][n]),s[i+1]&&s[i+1][n]&&e.push(s[i+1][n]),s[i]&&s[i][n-1]&&e.push(s[i][n-1]),s[i]&&s[i][n+1]&&e.push(s[i][n+1]),this.diagonal&&(s[i-1]&&s[i-1][n-1]&&e.push(s[i-1][n-1]),s[i+1]&&s[i+1][n-1]&&e.push(s[i+1][n-1]),s[i-1]&&s[i-1][n+1]&&e.push(s[i-1][n+1]),s[i+1]&&s[i+1][n+1]&&e.push(s[i+1][n+1])),e}toString(){const t=[],e=this.grid;for(let i=0;i<e.length;i++){const n=[],s=e[i];for(let t=0;t<s.length;t++)n.push(s[t].weight);t.push(n.join(" "))}return t.join("\n")}}class Lw{constructor(t,e,i){this.x=t,this.y=e,this.weight=i,this.f=0,this.g=0,this.h=0,this.visited=!1,this.closed=!1,this.parent=null}toString(){return`[${this.x} ${this.y}]`}getCost(t){return t&&t.x!=this.x&&t.y!=this.y?1.41421*this.weight:this.weight}isWall(){return 0===this.weight}}class _w{constructor(t){this.scoreFunction=t,this.content=new Array}push(t){this.content.push(t),this.sinkDown(this.content.length-1)}pop(){const t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t}remove(t){const e=this.content.indexOf(t),i=this.content.pop();e!==this.content.length-1&&(this.content[e]=i,this.scoreFunction(i)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))}size(){return this.content.length}rescoreElement(t){this.sinkDown(this.content.indexOf(t))}sinkDown(t){const e=this.content[t];for(;t>0;){const i=(t+1>>1)-1,n=this.content[i];if(!(this.scoreFunction(e)<this.scoreFunction(n)))break;this.content[i]=e,this.content[t]=n,t=i}}bubbleUp(t){const e=this.content.length,i=this.content[t],n=this.scoreFunction(i);for(;;){const s=t+1<<1,a=s-1;let o,r=null;if(a<e){const t=this.content[a];o=this.scoreFunction(t),o<n&&(r=a)}if(s<e){const t=this.content[s];this.scoreFunction(t)<(null===r?n:o)&&(r=s)}if(null===r)break;this.content[t]=this.content[r],this.content[r]=i,t=r}}}class Tw{constructor(t,e){this.url=t,this.fetcher=e,this.name=null,this.tileWidth=0,this.tileHeight=0,this.tilesPerRow=0,this.tileCount=0,this.image=null,this.collision=new Map}async load(){const t=await this.fetcher.getXml(this.url.href),e=t.querySelector("image").getAttribute("source"),i=new URL(e,this.url),n=t.querySelectorAll("tile");for(let t=0;t<n.length;++t){const e=n[t],i=parseInt(e.getAttribute("id"),10),s=e.querySelector("properties > property[name='Collision']").getAttribute("value");this.collision.set(i,"true"===s)}this.name=t.getAttribute("name"),this.tileWidth=parseInt(t.getAttribute("tilewidth"),10),this.tileHeight=parseInt(t.getAttribute("tileheight"),10),this.tileCount=parseInt(t.getAttribute("tilecount"),10),this.image=await this.fetcher.getCanvas(i.href),this.tilesPerRow=Math.floor(this.image.width/this.tileWidth)}isClear(t){return!this.collision.get(t-1)}draw(t,e,i,n){if(e>0){const s=e-1,a=this.tileWidth*(s%this.tilesPerRow),o=this.tileHeight*Math.floor(s/this.tilesPerRow),r=i*this.tileWidth,h=n*this.tileHeight;t.drawImage(this.image,a,o,this.tileWidth,this.tileHeight,r,h,this.tileWidth,this.tileHeight)}}}class Ow{constructor(t,e){this.fetcher=e,this._tileWidth=0,this._tileHeight=0,this._layers=0,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._layerImages=new Array,this._url=null,this._tileset=null,this._tiles=null,this._graph=null,this._url=new URL(`data/tilemaps/${t}.tmx`,document.baseURI)}async load(){const t=await this.fetcher.getXml(this._url.href),e=parseInt(t.getAttribute("width"),10),i=parseInt(t.getAttribute("height"),10),n=parseInt(t.getAttribute("tilewidth"),10),s=parseInt(t.getAttribute("tileheight"),10),a=t.querySelector("tileset").getAttribute("source"),o=t.querySelectorAll("layer > data");this._layers=o.length,this._width=e,this._height=i,this._offsetX=-Math.floor(e/2),this._offsetY=-Math.floor(i/2),this._tileWidth=n,this._tileHeight=s,this._tiles=[];for(let t=0;t<o.length;++t){const i=o[t].innerHTML.replace(" ","").replace("\t","").replace("\n","").replace("\r","").split(",").map((t=>parseInt(t,10))),n=[];let s=[];for(let t of i)s.push(t),s.length===e&&(n.push(s),s=[]);s.length>0&&n.push(s),this._tiles.push(n)}this._tileset=new Tw(new URL(a,this._url),this.fetcher),await this._tileset.load(),this._tileWidth=this._tileset.tileWidth,this._tileHeight=this._tileset.tileHeight;for(let t=0;t<this._layers;++t){const e=Dt(this.width*this.tileWidth,this.height*this.tileHeight);this._layerImages.push(e);const i=e.getContext("2d"),n=this._tiles[t];for(let t=0;t<this.height;++t){const e=n[t];for(let n=0;n<this.width;++n){const s=e[n];this._tileset.draw(i,s,n,t)}}}let r=[];for(let t of this._tiles[0]){let e=[];for(let i of t)this._tileset.isClear(i)?e.push(1):e.push(0);r.push(e)}this._graph=new kw(r,{diagonal:!0})}get width(){return this._width}get height(){return this._height}get tileWidth(){return this._tileWidth}get tileHeight(){return this._tileHeight}isInBounds(t,e){return 0<=t&&t<this.width&&0<=e&&e<this.height}getGridNode(t,e){return t-=this._offsetX,e-=this._offsetY,t=Math.round(t),e=Math.round(e),this.isInBounds(t,e)?this._graph.grid[e][t]:null}draw(t){t.save(),t.translate(this._offsetX*this.tileWidth,this._offsetY*this.tileHeight);for(let e of this._layerImages)t.drawImage(e,0,0);t.restore()}searchPath(t,e){return Ew(this._graph,t,e).map((t=>({x:t.y+this._offsetX,y:t.x+this._offsetY})))}isClear(t,e,i){return t-=this._offsetX,e-=this._offsetY,t=Math.round(t),e=Math.round(e),t<0||this.width<=t||e<0||this.height<=e||this._tileset&&this._tileset.isClear(this._tiles[0][e][t])||i&&i.canSwim}getClearTile(t,e,i,n,s){const a=t+i,o=e+n,r=t<a?1:-1,h=e<o?1:-1;let A=((i=Math.abs(a-t))>(n=Math.abs(o-e))?i:-n)/2;for(;t!==a||e!==o;){const a=A;if(a>-i){if(!this.isClear(t+r,e,s))break;A-=n,t+=r}if(a<n){if(!this.isClear(t,e+h,s))break;A+=i,e+=h}}return{x:t,y:e}}getClearTileNear(t,e,i,n){for(let s=1;s<=i;++s)for(let i=-s;i<=s;++i){const a=s-Math.abs(i),o=t+i,r=e+a,h=e-a;if(this.isClear(o,r,n))return{x:o,y:r};if(this.isClear(o,h,n))return{x:o,y:h}}return{x:t,y:e}}}var Rw;!function(t){t.None="none",t.Emoji="emoji",t.Photo="photo",t.Video="video"}(Rw||(Rw={}));class Uw{constructor(t,e){this.mode=t,this.canSwim=e,this.element=Dt(128,128),this.g=this.element.getContext("2d")}draw(t,e,i,n){const s=this.element.width/this.element.height,a=s>1?e:s*i,o=s>1?e/s:i,r=(e-a)/2,h=(i-o)/2;t.drawImage(this.element,r,h,a,o)}}class Qw extends Uw{constructor(t){super(Rw.Emoji,function(t){return ir.contains(t)||nr.contains(t)||sr.contains(t)||Ba.contains(t)}(t)),this.value=t;const e=new fw;e.fillColor=t.color||"black",e.fontFamily="Noto Color Emoji",e.fontSize=256,e.value=this.value,Pt(this.g,e.width,e.height),e.draw(this.g,0,0)}}class Nw extends Uw{constructor(t){super(Rw.Photo,!1);const e=new Image;e.addEventListener("load",(()=>{const t=(e.width-e.height)/2,i=Math.max(0,t),n=Math.max(0,-t),s=Math.min(e.width,e.height);Pt(this.g,s,s),this.g.drawImage(e,i,n,s,s,0,0,s,s)})),t instanceof URL?this.url=t.href:this.url=t,e.src=this.url}}class Hw extends Uw{constructor(t){if(super(Rw.Video,!1),t instanceof HTMLVideoElement)this.video=t;else{if(!(t instanceof MediaStream))throw new Error("Can only create a video avatar from an HTMLVideoElement or MediaStream.");this.video=function(...t){return Y("video",...t)}(D,k,F,function(t){return new B("volume",t,"audio","video")}(0),_(t))}ls||(this.video.play(),ut(this.video,"canplay").then((()=>this.video.play())))}draw(t,e,i,n){if(this.video.videoWidth>0&&this.video.videoHeight>0){const t=(this.video.videoWidth-this.video.videoHeight)/2,e=Math.max(0,t),i=Math.max(0,-t),s=Math.min(this.video.videoWidth,this.video.videoHeight);Pt(this.g,s,s),this.g.save(),n&&(this.g.translate(s,0),this.g.scale(-1,1)),this.g.drawImage(this.video,e,i,s,s,0,0,s,s),this.g.restore()}super.draw(t,e,i,n)}}class zw extends p{constructor(t){super("userMoved"),this.id=t,this.x=0,this.y=0}}const Gw=new fw,jw=new fw;Gw.fontFamily="Noto Color Emoji",Gw.value=jp.value,jw.fontFamily="Noto Color Emoji",jw.value=Vp.value;class Ww extends m{constructor(t,e,i,n){super(),this.id=t,this.pose=i,this.isMe=n,this.audioMuted=!1,this.videoMuted=!0,this.isActive=!1,this.stackUserCount=1,this.stackIndex=0,this.stackAvatarHeight=0,this.stackAvatarWidth=0,this.stackOffsetX=0,this.stackOffsetY=0,this.visible=!0,this._displayName=null,this._avatarVideo=null,this._avatarImage=null,this._avatarEmoji=null,this.userMovedEvt=new zw(t),this.label=n?"(Me)":`(${this.id})`,this.setAvatarEmoji(EA.value),this.lastPositionRequestTime=performance.now()/1e3-1,this.userNameText=new fw,this.userNameText.fillColor="white",this.userNameText.fontSize=128,this.displayName=e,Object.seal(this)}get x(){return this.pose.current.p[0]}get y(){return this.pose.current.p[2]}get gridX(){return this.pose.end.p[0]}get gridY(){return this.pose.end.p[2]}setAvatar(t){switch(t.mode){case Rw.Emoji:this.setAvatarEmoji(t.avatar);break;case Rw.Photo:this.setAvatarImage(t.avatar);break;case Rw.Video:this.setAvatarVideo(t.avatar);break;default:c(t)}}serialize(){return{id:this.id,avatarMode:this.avatarMode,avatarID:this.avatarID}}get avatarVideo(){return this._avatarVideo}setAvatarVideo(t){this._avatarVideo=t?new Hw(t):null}get avatarImage(){return this._avatarImage}setAvatarImage(t){s(t)&&t.length>0?this._avatarImage=new Nw(t):this._avatarImage=null}get avatarEmoji(){return this._avatarEmoji}setAvatarEmoji(t){this._avatarEmoji=t?new Qw(t):null}get avatarMode(){return this._avatarVideo?Rw.Video:this._avatarImage?Rw.Photo:this._avatarEmoji?Rw.Emoji:Rw.None}get avatarID(){switch(this.avatarMode){case Rw.Emoji:return this.avatarEmoji.value;case Rw.Photo:return this.avatarImage.url;case Rw.Video:case Rw.None:return null;default:c(this.avatarMode)}}get avatar(){switch(this.avatarMode){case Rw.Emoji:return this._avatarEmoji;case Rw.Photo:return this._avatarImage;case Rw.Video:return this._avatarVideo;case Rw.None:return null;default:c(this.avatarMode)}}get displayName(){return this._displayName||this.label}set displayName(t){this._displayName=t,this.userNameText.value=this.displayName}moveTo(t,e){this.isMe&&(this.userMovedEvt.x=t,this.userMovedEvt.y=e,this.dispatchEvent(this.userMovedEvt))}update(t,e){this.stackUserCount=0,this.stackIndex=0;for(let t of e.values())t.gridX===this.gridX&&t.gridY===this.gridY&&(t.id===this.id&&(this.stackIndex=this.stackUserCount),++this.stackUserCount);this.stackAvatarWidth=t.tileWidth-5*(this.stackUserCount-1),this.stackAvatarHeight=t.tileHeight-5*(this.stackUserCount-1),this.stackOffsetX=5*this.stackIndex,this.stackOffsetY=5*this.stackIndex}drawShadow(t,e){const i=pw(t).a,n=this.x*e.tileWidth,s=this.y*e.tileHeight,a=pw(t).transformPoint({x:n,y:s});this.visible=-e.tileWidth<=a.x&&a.x<t.canvas.width&&-e.tileHeight<=a.y&&a.y<t.canvas.height,this.visible&&(t.save(),t.shadowColor="rgba(0, 0, 0, 0.5)",t.shadowOffsetX=3*i,t.shadowOffsetY=3*i,t.shadowBlur=3*i,this.innerDraw(t,e),t.restore())}drawAvatar(t,e){if(this.visible){if(t.save(),this.innerDraw(t,e),this.isActive&&!this.audioMuted){const e=this.stackAvatarHeight/2,i=pw(t).a;jw.fontSize=e,jw.scale=i,jw.draw(t,this.stackAvatarWidth-jw.width,0)}t.restore()}}innerDraw(t,e){if(t.translate(this.x*e.tileWidth+this.stackOffsetX,this.y*e.tileHeight+this.stackOffsetY),t.fillStyle="black",t.textBaseline="top",this.avatar&&this.avatar.draw(t,this.stackAvatarWidth,this.stackAvatarHeight,this.isMe),this.audioMuted||!this.videoMuted){const e=this.stackAvatarHeight/2,i=pw(t).a;this.audioMuted&&(Gw.fontSize=e,Gw.scale=i,Gw.draw(t,this.stackAvatarWidth-Gw.width,0))}}drawName(t,e,i){if(this.visible){const n=pw(t).a;t.save();{t.translate(this.x*e.tileWidth+this.stackOffsetX,this.y*e.tileHeight+this.stackOffsetY),t.shadowColor="black",t.shadowOffsetX=3*n,t.shadowOffsetY=3*n,t.shadowBlur=3*n;const s=i/this.userNameText.fontSize;t.scale(s,s),this.userNameText.draw(t,0,-this.userNameText.height)}t.restore()}}drawHearingTile(t,e,i,n,s){t.save(),t.translate((this.gridX+i)*e.tileWidth,(this.gridY+n)*e.tileHeight),t.strokeStyle=`rgba(0, 255, 0, ${(1-s)/2})`,t.strokeRect(0,0,e.tileWidth,e.tileHeight),t.restore()}drawHearingRange(t,e,i,n){const s=pw(t).a,a=Math.min(n,Math.ceil(t.canvas.width/(2*e.tileWidth*s))),o=Math.min(n,Math.ceil(t.canvas.height/(2*e.tileHeight*s)));for(let s=0;s<o;++s)for(let o=0;o<a;++o){const a=Be(Math.sqrt(o*o+s*s),i,n);a<=1&&(this.drawHearingTile(t,e,o,s,a),0!=s&&this.drawHearingTile(t,e,o,-s,a),0!=o&&this.drawHearingTile(t,e,-o,s,a),0!=o&&0!=s&&this.drawHearingTile(t,e,-o,-s,a))}}}const Vw=.01,Zw=new p("gameStarted"),Yw=new p("gameEnded"),Xw=new p("zoomChanged"),Jw=new p("emojiNeeded"),Kw=new p("toggleAudio"),qw=new p("toggleVideo"),$w=new class extends p{constructor(t){super("userJoined"),this.user=t}}(null),tB=new zw(null),eB=new class extends p{constructor(t){super("emote"),this.emoji=t}}(null),iB=new Map;const nB=new class{constructor(){this._drawHearing=!1,this._audioDistanceMin=1,this._audioDistanceMax=10,this._audioRolloff=1,this._fontSize=12,this._transitionSpeed=1,this._zoom=1.5,this._roomName="calla",this._userName="",this._email="",this._avatarEmoji=null,this._avatarURL=null,this._gamepadIndex=0,this._inputBinding=new Sv,this._preferredAudioOutputID=null,this._preferredAudioInputID=null,this._preferredVideoInputID=null;const t=localStorage.getItem(xv);if(t){const e=JSON.parse(t),i=e._inputBinding;delete e._inputBinding,Object.assign(this,e),this._avatarEmoji&&!s(this._avatarEmoji)&&("value"in this._avatarEmoji?this._avatarEmoji=this._avatarEmoji.value:this._avatarEmoji=null),this.inputBinding=i}this._inputBinding.fix(kv),window.location.hash.length>0&&(this.roomName=window.location.hash.substring(1)),Object.seal(this)}commit(){localStorage.setItem(xv,JSON.stringify(this))}get preferredAudioOutputID(){return this._preferredAudioOutputID}set preferredAudioOutputID(t){t!==this.preferredAudioOutputID&&(this._preferredAudioOutputID=t,this.commit())}get preferredAudioInputID(){return this._preferredAudioInputID}set preferredAudioInputID(t){t!==this.preferredAudioInputID&&(this._preferredAudioInputID=t,this.commit())}get preferredVideoInputID(){return this._preferredVideoInputID}set preferredVideoInputID(t){t!==this.preferredVideoInputID&&(this._preferredVideoInputID=t,this.commit())}get transitionSpeed(){return this._transitionSpeed}set transitionSpeed(t){t!==this.transitionSpeed&&(this._transitionSpeed=t,this.commit())}get drawHearing(){return this._drawHearing}set drawHearing(t){t!==this.drawHearing&&(this._drawHearing=t,this.commit())}get audioDistanceMin(){return this._audioDistanceMin}set audioDistanceMin(t){t!==this.audioDistanceMin&&(this._audioDistanceMin=t,this.commit())}get audioDistanceMax(){return this._audioDistanceMax}set audioDistanceMax(t){t!==this.audioDistanceMax&&(this._audioDistanceMax=t,this.commit())}get audioRolloff(){return this._audioRolloff}set audioRolloff(t){t!==this.audioRolloff&&(this._audioRolloff=t,this.commit())}get fontSize(){return this._fontSize}set fontSize(t){t!==this.fontSize&&(this._fontSize=t,this.commit())}get zoom(){return this._zoom}set zoom(t){t!==this.zoom&&(this._zoom=t,this.commit())}get userName(){return this._userName}set userName(t){t!==this.userName&&(this._userName=t,this.commit())}get email(){return this._email}set email(t){t!==this.email&&(this._email=t,this.commit())}get avatarEmoji(){return this._avatarEmoji}set avatarEmoji(t){t!==this.avatarEmoji&&(this._avatarEmoji=t,this.commit())}get avatarURL(){return this._avatarURL}set avatarURL(t){t!==this.avatarURL&&(this._avatarURL=t,this.commit())}get roomName(){return this._roomName}set roomName(t){t!==this.roomName&&(this._roomName=t,this.commit())}get gamepadIndex(){return this._gamepadIndex}set gamepadIndex(t){t!==this.gamepadIndex&&(this._gamepadIndex=t,this.commit())}get inputBinding(){return this._inputBinding.toJSON()}set inputBinding(t){let e=!1;this._inputBinding.addEventListener("inputBindingChanged",(t=>e=!0),{once:!0}),this._inputBinding.copy(t),e&&this.commit()}},sB=new Yt,aB=new xn(sB,bn.High),oB=new class extends m{constructor(t,e,i,n){super(),this.isAudioMuted=null,this.isVideoMuted=null,u(i)&&(i=ys),this.tele=new i(t,e),u(n)?this.meta=this.tele.getDefaultMetadataClient():this.meta=new n(this.tele);const s=this.dispatchEvent.bind(this);this.tele.addEventListener("serverConnected",s),this.tele.addEventListener("serverDisconnected",s),this.tele.addEventListener("serverFailed",s),this.tele.addEventListener("conferenceFailed",s),this.tele.addEventListener("conferenceRestored",s),this.tele.addEventListener("audioMuteStatusChanged",s),this.tele.addEventListener("videoMuteStatusChanged",s),this.tele.addEventListener("conferenceJoined",(async t=>{const e=this.audio.createLocalUser(t.id);t.pose=e.pose,this.dispatchEvent(t),await this.setPreferredDevices()})),this.tele.addEventListener("conferenceLeft",(t=>{this.audio.createLocalUser(t.id),this.dispatchEvent(t)})),this.tele.addEventListener("participantJoined",(async t=>{t.source=this.audio.createUser(t.id),this.dispatchEvent(t)})),this.tele.addEventListener("participantLeft",(t=>{this.dispatchEvent(t),this.audio.removeUser(t.id)})),this.tele.addEventListener("userNameChanged",s),this.tele.addEventListener("videoAdded",s),this.tele.addEventListener("videoRemoved",s),this.tele.addEventListener("audioAdded",(t=>{const e=this.audio.getUser(t.id);if(e){let i=e.streams.get(t.kind);i&&e.streams.delete(t.kind),i=t.stream,e.streams.set(t.kind,i),t.id!==this.tele.localUserID&&this.audio.setUserStream(t.id,i),this.dispatchEvent(t)}})),this.tele.addEventListener("audioRemoved",(t=>{const e=this.audio.getUser(t.id);e&&e.streams.has(t.kind)&&e.streams.delete(t.kind),t.id!==this.tele.localUserID&&this.audio.setUserStream(t.id,null),this.dispatchEvent(t)})),this.meta.addEventListener("avatarChanged",s),this.meta.addEventListener("chat",s),this.meta.addEventListener("emote",s),this.meta.addEventListener("setAvatarEmoji",s);const a=t=>{const e=this.audio.getUserOffset(t.id);e&&(t.px+=e[0],t.py+=e[1],t.pz+=e[2]),this.dispatchEvent(t)};this.meta.addEventListener("userPointer",a),this.meta.addEventListener("userPosed",(t=>{this.audio.setUserPose(t.id,t.px,t.py,t.pz,t.fx,t.fy,t.fz,t.ux,t.uy,t.uz),a(t)})),this.audio.addEventListener("audioActivity",(t=>{bs.id=t.id,bs.isActive=t.isActive,this.dispatchEvent(bs)}));const o=this.dispose.bind(this);window.addEventListener("beforeunload",o),window.addEventListener("unload",o),window.addEventListener("pagehide",o),Object.seal(this)}get connectionState(){return this.tele.connectionState}get conferenceState(){return this.tele.conferenceState}get audio(){return this.tele.audio}get preferredAudioOutputID(){return this.tele.preferredAudioOutputID}set preferredAudioOutputID(t){this.tele.preferredAudioOutputID=t}get preferredAudioInputID(){return this.tele.preferredAudioInputID}set preferredAudioInputID(t){this.tele.preferredAudioInputID=t}get preferredVideoInputID(){return this.tele.preferredVideoInputID}set preferredVideoInputID(t){this.tele.preferredVideoInputID=t}async getCurrentAudioOutputDevice(){return await this.tele.getCurrentAudioOutputDevice()}async getMediaPermissions(){return await this.tele.getMediaPermissions()}async getAudioOutputDevices(t){return await this.tele.getAudioOutputDevices(t)}async getAudioInputDevices(t){return await this.tele.getAudioInputDevices(t)}async getVideoInputDevices(t){return await this.tele.getVideoInputDevices(t)}dispose(){this.leave(),this.disconnect()}get offsetRadius(){return this.audio.offsetRadius}set offsetRadius(t){this.audio.offsetRadius=t}setLocalPose(t,e,i,n,s,a,o,r,h){this.audio.setUserPose(this.localUserID,t,e,i,n,s,a,o,r,h,0),this.meta.setLocalPose(t,e,i,n,s,a,o,r,h)}setLocalPoseImmediate(t,e,i,n,s,a,o,r,h){this.audio.setUserPose(this.localUserID,t,e,i,n,s,a,o,r,h,0),this.meta.setLocalPoseImmediate(t,e,i,n,s,a,o,r,h)}setLocalPointer(t,e,i,n,s,a,o,r,h,A){this.meta.setLocalPointer(t,e,i,n,s,a,o,r,h,A)}setAvatarEmoji(t){this.meta.setAvatarEmoji(t)}setAvatarURL(t){this.meta.setAvatarURL(t)}emote(t){this.meta.emote(t)}chat(t){this.meta.chat(t)}async setPreferredDevices(){await this.tele.setPreferredDevices()}async setAudioInputDevice(t){await this.tele.setAudioInputDevice(t)}async setVideoInputDevice(t){await this.tele.setVideoInputDevice(t)}async getCurrentAudioInputDevice(){return await this.tele.getCurrentAudioInputDevice()}async getCurrentVideoInputDevice(){return await this.tele.getCurrentVideoInputDevice()}async toggleAudioMuted(){return await this.tele.toggleAudioMuted()}async toggleVideoMuted(){return await this.tele.toggleVideoMuted()}async getAudioMuted(){return await this.tele.getAudioMuted()}async getVideoMuted(){return await this.tele.getVideoMuted()}get metadataState(){return this.meta.metadataState}get localUserID(){return this.tele.localUserID}get localUserName(){return this.tele.localUserName}get roomName(){return this.tele.roomName}userExists(t){return this.tele.userExists(t)}getUserNames(){return this.tele.getUserNames()}async prepare(t,e,i,n){await this.tele.prepare(t,e,i,n)}async connect(){await this.tele.connect(),this.tele.connectionState===In.Connected&&await this.meta.connect()}async join(t){await this.tele.join(t),this.tele.conferenceState===In.Connected&&await this.meta.join(t)}async identify(t){await this.tele.identify(t),await this.meta.identify(this.localUserID)}async leave(){await this.meta.leave(),await this.tele.leave()}async disconnect(){await this.meta.disconnect(),await this.tele.disconnect()}update(){this.audio.update()}async setAudioOutputDevice(t){this.tele.setAudioOutputDevice(t),Ie&&await this.audio.setAudioOutputDeviceID(this.tele.preferredAudioOutputID)}async setAudioMuted(t){let e=this.isAudioMuted;return t!==e&&(e=await this.toggleAudioMuted()),e}async setVideoMuted(t){let e=this.isVideoMuted;return t!==e&&(e=await this.toggleVideoMuted()),e}}(sB,aB),rB=new class extends m{constructor(t,e,i){super(),this.fetcher=t,this.zoomMin=e,this.zoomMax=i,this.waypoints=new Array,this.users=new Map,this.emotes=new Array,this.keys=new Map,this.lastMove=Number.MAX_VALUE,this.lastWalk=Number.MAX_VALUE,this.gridOffsetX=0,this.gridOffsetY=0,this.fontSize=0,this.cameraX=0,this.offsetCameraX=0,this.targetOffsetCameraX=0,this.cameraY=0,this.offsetCameraY=0,this.targetOffsetCameraY=0,this.cameraZ=1.5,this.targetCameraZ=1.5,this.drawHearing=!1,this.audioDistanceMin=2,this.audioDistanceMax=10,this.rolloff=5,this.lastGamepadIndex=-1,this.gamepadIndex=-1,this.transitionSpeed=.125,this.keyboardEnabled=!0,this.me=null,this.map=null,this.currentRoomName=null,this.currentEmoji=null,this.element=q(M("frontBuffer")),this.gFront=this.element.getContext("2d"),this.audioDistanceMin=2,this.audioDistanceMax=10,this.rolloff=5,this.currentEmoji=null,this.inputBinding={keyButtonUp:"ArrowUp",keyButtonDown:"ArrowDown",keyButtonLeft:"ArrowLeft",keyButtonRight:"ArrowRight",keyButtonEmote:"e",keyButtonToggleAudio:"a",keyButtonZoomOut:"[",keyButtonZoomIn:"]",gpAxisLeftRight:0,gpAxisUpDown:1,gpButtonEmote:0,gpButtonToggleAudio:1,gpButtonZoomIn:6,gpButtonZoomOut:7,gpButtonUp:12,gpButtonDown:13,gpButtonLeft:14,gpButtonRight:15},this.lastGamepadIndex=-1,this.gamepadIndex=-1,this.transitionSpeed=.125,this.keyboardEnabled=!0,window.addEventListener("keydown",(t=>{this.keys.set(t.key,t),!this.keyboardEnabled||t.ctrlKey||t.altKey||t.shiftKey||t.metaKey||t.key!==this.inputBinding.keyButtonToggleAudio||!this.me||this.toggleMyAudio()})),window.addEventListener("keyup",(t=>{this.keys.has(t.key)&&this.keys.delete(t.key)})),this.screenControls=new Mw(this.element),this.screenControls.addEventListener("move",(t=>{Math.abs(t.dz)>0&&(this.zoom+=t.dz,this.dispatchEvent(Xw))})),this.screenControls.addEventListener("drag",(t=>{this.targetOffsetCameraX=this.offsetCameraX+=t.dx,this.targetOffsetCameraY=this.offsetCameraY+=t.dy})),this.screenControls.addEventListener("click",(t=>{if(this.me){const e=this.getTileAt(t),i=e.x-this.me.gridX,n=e.y-this.me.gridY;this.moveMeByPath(i,n)}}))}get style(){return this.element.style}updateAudioActivity(t,e){this.withUser("update audio activity",t,(t=>{t.isActive=e}))}emote(t,e){if(this.users.has(t)){const i=this.users.get(t);i.isMe&&((e=e||this.currentEmoji)?(eB.emoji=this.currentEmoji=e,this.dispatchEvent(eB)):this.dispatchEvent(Jw)),e&&this.emotes.push(new vw(e,i.x,i.y))}}getTileAt(t){const e=t.x*devicePixelRatio-this.gridOffsetX-this.offsetCameraX,i=t.y*devicePixelRatio-this.gridOffsetY-this.offsetCameraY,n=e/this.cameraZ,s=i/this.cameraZ,a=n-this.cameraX,o=s-this.cameraY;return{x:a/this.map.tileWidth-.5,y:o/this.map.tileHeight-.5}}moveMeTo(t,e){this.map.isClear(t,e,this.me.avatar)&&(this.targetOffsetCameraX=0,this.targetOffsetCameraY=0,tB.x=t,tB.y=e,this.dispatchEvent(tB))}moveMeBy(t,e){const i=this.map.getClearTile(this.me.gridX,this.me.gridY,t,e,this.me.avatar);this.moveMeTo(i.x,i.y)}moveMeByPath(t,e){Jt(this.waypoints);const i=this.me.gridX,n=this.me.gridY,s=this.map.getGridNode(i,n),a=i+t,o=n+e,r=a-Math.round(a),h=o-Math.round(o),A=this.map.getGridNode(a,o);if(s&&A){const t=this.map.searchPath(s,A);if(0===t.length)this.moveMeTo(a,o);else{for(let e of t)e.x+=r,e.y+=h;this.waypoints.push(...t)}}else this.moveMeTo(a,o)}warpMeTo(t,e){const i=this.map.getClearTileNear(t,e,3,this.me.avatar);this.moveMeTo(i.x,i.y)}visit(t){this.withUser("visit",t,(t=>{this.warpMeTo(t.gridX,t.gridY)}))}get zoom(){const t=Be(this.targetCameraZ,this.zoomMin,this.zoomMax);return dw(Math.pow(t,.5),this.zoomMin,this.zoomMax)}set zoom(t){const e=Be(t=Ft(t,this.zoomMin,this.zoomMax),this.zoomMin,this.zoomMax),i=dw(Math.pow(e,2),this.zoomMin,this.zoomMax);this.targetCameraZ=i}addUser(t,e,i){this.users.has(t)&&this.removeUser(t);const n=new Ww(t,e,i,!1);this.users.set(t,n),$w.user=n,this.dispatchEvent($w)}toggleMyAudio(){this.dispatchEvent(Kw)}toggleMyVideo(){this.dispatchEvent(qw)}muteUserAudio(t,e){this.withUser("mute audio",t,(t=>{t.audioMuted=e}))}muteUserVideo(t,e){this.withUser("mute video",t,(t=>{t.videoMuted=e}))}withUser(t,e,i,n){if(void 0===n&&(n=5e3),e)if(this.users.has(e)){i(this.users.get(e))}else console.warn(`No user "${e}" found to ${t}. Trying again in a quarter second.`),n>0&&setTimeout(this.withUser.bind(this,t,e,i,n-250),250)}changeUserName(t,e){this.withUser("change user name",t,(t=>{t.displayName=e}))}removeUser(t){this.users.has(t)&&this.users.delete(t)}setAvatarVideo(t,e){this.withUser("set avatar video",t,(t=>{t.setAvatarVideo(e)}))}setAvatarURL(t,e){this.withUser("set avatar image",t,(t=>{t.setAvatarImage(e)}))}setAvatarEmoji(t,e){this.withUser("set avatar emoji",t,(t=>{t.setAvatarEmoji(e.value)}))}async startAsync(t,e,i,n,a){this.currentRoomName=a.toLowerCase(),this.me=new Ww(t,e,i,!0),s(n)&&this.me.setAvatarImage(n),this.users.set(t,this.me),this.map=new Ow(this.currentRoomName,this.fetcher);let o=!1;for(let t=0;t<2;++t)try{await this.map.load(),o=!0}catch(e){0===t?(console.warn(e),console.warn("Retrying with default map."),this.map=new Ow("default",this.fetcher)):console.error(e)}o||console.error("Couldn't load any maps!"),this.startLoop(),this.dispatchEvent(Xw),this.dispatchEvent(Zw)}startLoop(){Uf(this.element),this.resize(),this.element.focus()}resize(){!function(t,e=1){It(t,t.clientWidth,t.clientHeight,e)}(this.element,window.devicePixelRatio)}end(){this.currentRoomName=null,this.map=null,this.users.clear(),this.me=null,Qf(this.element),this.dispatchEvent(Yw)}update(t){if(null!==this.currentRoomName){if(t/=1e3,this.gridOffsetX=Math.floor(.5*this.element.width/this.map.tileWidth)*this.map.tileWidth,this.gridOffsetY=Math.floor(.5*this.element.height/this.map.tileHeight)*this.map.tileHeight,this.lastMove+=t,this.lastMove>=.125){let t=0,e=0,i=0;if(this.keyboardEnabled)for(let n of Object.values(this.keys))if(!(n.altKey||n.shiftKey||n.ctrlKey||n.metaKey))switch(n.key){case this.inputBinding.keyButtonUp:e--;break;case this.inputBinding.keyButtonDown:e++;break;case this.inputBinding.keyButtonLeft:t--;break;case this.inputBinding.keyButtonRight:t++;break;case this.inputBinding.keyButtonZoomIn:i++;break;case this.inputBinding.keyButtonZoomOut:i--;break;case this.inputBinding.keyButtonEmote:this.emote(this.me.id,this.currentEmoji)}const n=navigator.getGamepads()[this.gamepadIndex];if(n){iB.has(this)||iB.set(this,new Mv(n));const s=iB.get(this);s.update(n),s.buttons[this.inputBinding.gpButtonEmote].pressed&&this.emote(this.me.id,this.currentEmoji),!s.lastButtons[this.inputBinding.gpButtonToggleAudio].pressed&&s.buttons[this.inputBinding.gpButtonToggleAudio].pressed&&this.toggleMyAudio(),s.buttons[this.inputBinding.gpButtonUp].pressed?--e:s.buttons[this.inputBinding.gpButtonDown].pressed&&++e,s.buttons[this.inputBinding.gpButtonLeft].pressed?--t:s.buttons[this.inputBinding.gpButtonRight].pressed&&++t,t+=Math.round(s.axes[this.inputBinding.gpAxisLeftRight]),e+=Math.round(s.axes[this.inputBinding.gpAxisUpDown]),i+=2*(s.buttons[this.inputBinding.gpButtonZoomIn].value-s.buttons[this.inputBinding.gpButtonZoomOut].value),this.targetOffsetCameraX+=-50*Math.round(2*s.axes[2]),this.targetOffsetCameraY+=-50*Math.round(2*s.axes[3]),this.dispatchEvent(Xw)}t=Ft(t,-1,1),e=Ft(e,-1,1),0===t&&0===e||(this.moveMeBy(t,e),Jt(this.waypoints)),0!==i&&(this.zoom+=i,this.dispatchEvent(Xw)),this.lastMove=0}if(this.lastWalk+=t,this.lastWalk>=this.transitionSpeed){if(this.waypoints.length>0){const t=this.waypoints.shift();this.moveMeTo(t.x,t.y)}this.lastWalk=0}for(let e of this.emotes)e.update(t);this.emotes=this.emotes.filter((t=>!t.isDead()));for(let t of this.users.values())t.update(this.map,this.users);this.render()}}render(){const t=-this.me.x*this.map.tileWidth,e=-this.me.y*this.map.tileHeight;this.cameraZ=Mf(this.cameraZ,this.targetCameraZ,Vw*this.cameraZ),this.cameraX=Mf(this.cameraX,t,Vw*this.cameraZ),this.cameraY=Mf(this.cameraY,e,Vw*this.cameraZ),this.offsetCameraX=Mf(this.offsetCameraX,this.targetOffsetCameraX,Vw),this.offsetCameraY=Mf(this.offsetCameraY,this.targetOffsetCameraY,Vw),this.gFront.resetTransform(),this.gFront.imageSmoothingEnabled=!1,this.gFront.clearRect(0,0,this.element.width,this.element.height),this.gFront.save(),this.gFront.translate(this.gridOffsetX+this.offsetCameraX,this.gridOffsetY+this.offsetCameraY),this.gFront.scale(this.cameraZ,this.cameraZ),this.gFront.translate(this.cameraX,this.cameraY),this.map.draw(this.gFront);for(let t of this.users.values())t.drawShadow(this.gFront,this.map);for(let t of this.emotes)t.drawShadow(this.gFront,this.map);for(let t of this.users.values())t.drawAvatar(this.gFront,this.map);this.drawCursor();for(let t of this.users.values())t.drawName(this.gFront,this.map,this.fontSize);this.drawHearing&&this.me.drawHearingRange(this.gFront,this.map,this.audioDistanceMin,this.audioDistanceMax);for(let t of this.emotes)t.drawEmote(this.gFront,this.map);this.gFront.restore()}drawCursor(){const t=this.screenControls.primaryPointer;if(t){const e=this.getTileAt(t);this.gFront.strokeStyle=this.map.isClear(e.x,e.y,this.me.avatar)?"green":"red",this.gFront.strokeRect(e.x*this.map.tileWidth,e.y*this.map.tileHeight,this.map.tileWidth,this.map.tileHeight)}}}(sB,.5,20),hB=new class extends Av{constructor(){super("login"),this._ready=!1,this._connecting=!1,this._connected=!1,this.addEventListener("shown",(()=>this._ready=!0)),this.roomSelectControl=$(M("roomSelectorControl")),this.roomEntryControl=$(M("roomEntryControl"));const t=new Array,e=this.element.querySelectorAll("#roomSelector option");for(let i=0;i<e.length;++i){const n=e[i];t.push({ShortName:n.value,Name:n.textContent||n.innerText})}this.roomSelect=av("roomSelector","No rooms available",(t=>t.ShortName),(t=>t.Name)),this.roomSelect.addEventListener("input",(()=>this.validate())),this.roomSelect.emptySelectionEnabled=!1,this.roomSelect.values=t,this.roomSelect.selectedIndex=0,this.roomInput=ht(M("roomName")),this.roomInput.addEventListener("input",(()=>this.validate())),this.roomInput.addEventListener("keypress",(t=>{"Enter"===t.key&&(0===this.userName.length?this.userNameInput.focus():0===this.email.length&&this.emailInput.focus())})),this.userNameInput=ht(M("userName")),this.userNameInput.addEventListener("input",(()=>this.validate())),this.userNameInput.addEventListener("keypress",(t=>{"Enter"===t.key&&(0===this.userName.length?this.userNameInput.focus():0===this.roomName.length&&(this.roomSelectMode?this.roomSelect.focus():this.roomInput.focus()))})),this.emailInput=function(...t){return et(R("email"),...t)}(M("email")),this.emailInput.addEventListener("keypress",(t=>{"Enter"===t.key&&(0===this.userName.length?this.userNameInput.focus():0===this.roomName.length&&(this.roomSelectMode?this.roomSelect.focus():this.roomInput.focus()))}));K(M("createNewRoom")).addEventListener("click",(()=>{this.roomSelectMode=!1}));K(M("selectRoom")).addEventListener("click",(()=>{this.roomSelectMode=!0})),this.connectButton=K(M("connect"));const i=t=>{!t.shiftKey&&!t.ctrlKey&&!t.altKey&&!t.metaKey&&"Enter"===t.key&&this.userName.length>0&&this.roomName.length>0&&this.dispatchEvent(Dv)};this.connectButton.addEventListener("click",(()=>this.dispatchEvent(Dv))),this.roomInput.addEventListener("keypress",i),this.userNameInput.addEventListener("keypress",i),this.addEventListener("login",(()=>{this.connecting=!0})),this.roomSelectMode=!0,this.validate()}validate(){const t=this.roomName.length>0&&this.userName.length>0;Gf(this.connectButton,!this.ready||this.connecting||this.connected||!t),this.connectButton.innerHTML=this.connected?"Connected":this.connecting?"Connecting...":this.ready?"Connect":"Loading..."}get roomSelectMode(){return"none"!==this.roomSelectControl.style.display}set roomSelectMode(t){Of(this.roomSelectControl,t),Of(this.roomEntryControl,!t),t?this.roomSelect.selectedValue={ShortName:this.roomInput.value}:this.roomSelect.selectedIndex>=0&&(this.roomInput.value=this.roomSelect.selectedValue.ShortName),this.validate()}get roomName(){return(this.roomSelectMode?this.roomSelect.selectedValue&&this.roomSelect.selectedValue.ShortName:this.roomInput.value)||""}set roomName(t){null!=t&&0!==t.length||(t=this.roomSelect.values[0].ShortName),this.roomInput.value=t,this.roomSelect.selectedValue={ShortName:t},this.roomSelectMode=this.roomSelect.selectedIndex>-1,this.validate()}set userName(t){this.userNameInput.value=t,this.validate()}get userName(){return this.userNameInput.value}set email(t){this.emailInput.value=t}get email(){return this.emailInput.value}get connectButtonText(){return this.connectButton.innerText||this.connectButton.textContent}set connectButtonText(t){this.connectButton.innerHTML=t}get ready(){return this._ready}set ready(t){this._ready=t,this.validate()}get connecting(){return this._connecting}set connecting(t){this._connecting=t,this.validate()}get connected(){return this._connected}set connected(t){this._connected=t,this.connecting=!1}},AB=new class extends Av{constructor(){super("users"),this.roomName=null,this.userName=null,this.rows=new Map,this.users=new Map,this.avatarGs=new Map,this.lastUser=null,this.usersList=$(M("chatUsers")),Object.seal(this)}async startAsync(t,e){this.roomName=t,this.userName=e}update(){if(Tf(this))for(let t of this.users.entries()){const[e,i]=t;if(this.avatarGs.has(e)&&i.avatar){const t=this.avatarGs.get(e);t.clearRect(0,0,t.canvas.width,t.canvas.height),i.avatar.draw(t,t.canvas.width,t.canvas.height,i.isMe)}}}set(t){const e=!this.rows.has(t.id);this.delete(t.id);const i=this.rows.size+1;if(e){const e=$(dv(1,i,2,1),V(-1),hw);setTimeout((()=>{this.usersList.removeChild(e)}),3e3),this.usersList.append(e),this.users.set(t.id,t),this.avatarGs.set(t.id,q(Q(32),I(32)).getContext("2d"))}const n=this.avatarGs.get(t.id).canvas,s=$(H(dv(1,i,2,1),V(1),cw),new Sf("mouseover",(t=>{Aw.apply(s.style)}),a),function(t,e){return new Sf("mouseout",t,e)}((()=>cw.apply(s.style))),kf((()=>{Qf(this),uw.id=t.id,this.dispatchEvent(uw)})));var a;const o=[$(H(dv(1,i),V(0)),n),$(H(dv(2,i),V(0)),t.displayName),s];this.rows.set(t.id,o),this.usersList.append(...o)}delete(t){if(this.rows.has(t)){const e=this.rows.get(t);this.rows.delete(t);for(let t of e)this.usersList.removeChild(t);let i=1;for(let t of this.rows.values()){const e=gv(i++);for(let i of t)e.apply(i)}}}clear(){for(let t of this.rows.keys())this.delete(t)}warn(...t){const e=$(H(dv(1,this.rows.size+1,2,1),z("yellow")),...t.map((t=>t.toString())));this.usersList.append(e),setTimeout((()=>{this.usersList.removeChild(e)}),5e3)}},cB=new class extends m{constructor(t,e){super(),this._audioEnabled=!0,this._videoEnabled=!1;const i=t=>{this.zoom+=t,this.dispatchEvent(ev)};this.element=$(M("controls")),this.element.append(this.optionsButton=K(M("optionsButton"),O("Show/hide options"),kf((()=>this.dispatchEvent(jf))),ct(hp.value),ct("Options")),this.instructionsButton=K(M("instructionsButton"),O("Show/hide instructions"),kf((()=>this.dispatchEvent(Yf))),ct(Hm.value),ct("Info")),this.shareButton=K(M("shareButton"),O("Share your current room to twitter"),kf((()=>this.dispatchEvent(Wf))),function(...t){return Y("img",...t)}(L("https://cdn2.iconfinder.com/data/icons/minimalism/512/twitter.png"),function(t){return new B("alt",t,"applet","area","img","input")}("icon"),function(t){return new B("role",t)}("presentation"),I("25px"),W("2px auto -2px auto")),ct("Tweet")),this.showUsersButton=K(M("showUsersButton"),O("View user directory"),kf((()=>this.dispatchEvent(Xf))),ct(xA.value),ct("Users")),this.fullscreenButton=K(M("fullscreenButton"),O("Toggle fullscreen"),kf((()=>this.dispatchEvent(Zf))),kf((()=>this.isFullscreen=!this.isFullscreen)),ct(qm.value),ct("Expand")),this.leaveButton=K(M("leaveButton"),O("Leave the room"),kf((()=>this.dispatchEvent(Vf))),ct(Mm.value),ct("Leave")),$(M("toggleAudioControl"),y("comboButton"),this.toggleAudioButton=K(M("toggleAudioButton"),O("Toggle audio mute/unmute"),kf((()=>this.dispatchEvent(Jf))),this.toggleAudioLabel=ct(Zp.value),ct("Audio")),this.toggleVideoButton=K(M("toggleVideoButton"),O("Toggle video mute/unmute"),kf((()=>this.dispatchEvent(Kf))),this.toggleVideoLabel=ct(Lp.value),ct("Video")),this.changeDevicesButton=K(M("changeDevicesButton"),O("Change devices"),kf((()=>this.dispatchEvent(qf))),ct(Dg.value),ct("Change"))),$(M("emojiControl"),y("comboButton"),new B("textAlign","center"),K(M("emoteButton"),O("Emote"),kf((()=>this.dispatchEvent($f))),this.emoteButton=ct(gu.value),ct("Emote")),K(M("selectEmoteButton"),O("Select Emoji"),kf((()=>this.dispatchEvent(tv))),ct(Dg.value),ct("Change"))),this.zoomInButton=K(M("zoomInButton"),O("Zoom in"),kf((()=>i(.5))),ct(Jp.value),ct("+")),$(M("zoomSliderContainer"),this.slider=function(...t){return et(R("range"),...t)}(M("zoomSlider"),O("Zoom"),E(t),x(e),T(.1),U("0"),Lf((()=>this.dispatchEvent(ev))))),this.zoomOutButton=K(M("zoomOutButton"),O("Zoom out"),kf((()=>i(-.5))),ct(Kp.value),ct("-"))),Object.seal(this)}get isFullscreen(){return null!==document.fullscreenElement}set isFullscreen(t){t?document.body.requestFullscreen():document.exitFullscreen(),Nf(this.fullscreenButton,t,Ud.value,qm.value)}get style(){return this.element.style}isOpen(){return"none"!==this.style.display}setOpen(t,e){this.style.display=t?e||"":"none"}toggleOpen(t){this.setOpen(!this.isOpen(),t)}hide(){this.setOpen(!1)}show(){this.setOpen(!0)}get enabled(){return!this.instructionsButton.disabled}set enabled(t){const e=this.element.querySelectorAll("button");for(let i=0;i<e.length;++i)e[i].disabled=!t}get audioEnabled(){return this._audioEnabled}set audioEnabled(t){this._audioEnabled=t,Nf(this.toggleAudioLabel,t,Zp.value,jp.value)}get videoEnabled(){return this._videoEnabled}set videoEnabled(t){this._videoEnabled=t,Nf(this.toggleVideoLabel,t,Rp.value,Lp.value)}setEmojiButton(t){this.emoteButton.innerHTML=t.value}get zoom(){return parseFloat(this.slider.value)}set zoom(t){this.slider.value=t.toFixed(3)}}(.5,20),lB=new class extends Av{constructor(){super("devices"),this.videoInputSelect=av("videoInputDevices","No video input",(t=>t.deviceId),(t=>t.label),Lf((()=>this.dispatchEvent(uv)))),this.audioInputSelect=av("audioInputDevices","No audio input",(t=>t.deviceId),(t=>t.label),Lf((()=>this.dispatchEvent(cv)))),this.audioOutputSelect=av("audioOutputDevices","No audio output",(t=>t.deviceId),(t=>t.label),Lf((()=>this.dispatchEvent(lv)))),this.audioInputDevices=[],this.audioOutputDevices=[],this.videoInputDevices=[],Object.seal(this)}get audioInputDevices(){return this.audioInputSelect.values}set audioInputDevices(t){this.audioInputSelect.values=t}get currentAudioInputDevice(){return this.audioInputSelect.selectedValue}set currentAudioInputDevice(t){this.audioInputSelect.selectedValue=t}get audioOutputDevices(){return this.audioOutputSelect.values}set audioOutputDevices(t){this.audioOutputSelect.values=t}get currentAudioOutputDevice(){return this.audioOutputSelect.selectedValue}set currentAudioOutputDevice(t){this.audioOutputSelect.selectedValue=t}get videoInputDevices(){return this.videoInputSelect.values}set videoInputDevices(t){this.videoInputSelect.values=t}get currentVideoInputDevice(){return this.videoInputSelect.selectedValue}set currentVideoInputDevice(t){this.videoInputSelect.selectedValue=t}},uB=new class extends Av{constructor(){super("options"),this._drawHearing=!1,this._inputBinding=new Sv,this.user=null;const t=t=>()=>this.dispatchEvent(t),e=Lf(t(ew)),i=(t,e)=>{const i=Lv(t,"text",e,Yv,new Sf("keyup",(e=>{const i=e;"Tab"!==i.key&&"Shift"!==i.key&&(this._inputBinding.set(t,i.key),this.dispatchEvent(tw))}),n));var n;return i.value=this._inputBinding.get(t).toString(),i},n=(t,e)=>{const i=Lv(t,"text",e,Xv);return this.addEventListener("gamepadButtonUp",(e=>{document.activeElement===i.input&&(this._inputBinding.set(t,e.button),this.dispatchEvent(tw))})),i.value=this._inputBinding.get(t).toString(),i},s=(t,e)=>{const i=Lv(t,"text",e,Xv);return this.addEventListener("gamepadAxisMaxed",(e=>{document.activeElement===i.input&&(this._inputBinding.set(t,e.axis),this.dispatchEvent(tw))})),i.value=this._inputBinding.get(t).toString(),i},a=[Ov("avatar","Avatar",$(it(b("selectAvatarEmoji"),"Emoji: "),K(M("selectAvatarEmoji"),"Select",kf(t(qv))))," or ",$(it(b("setAvatarURL"),"Photo: "),this.avatarURLInput=At(S("https://example.com/me.png")),K(M("setAvatarURL"),"Set",kf((()=>{this.avatarURL=this.avatarURLInput.value,this.dispatchEvent(Jv)}))),this.clearAvatarURLButton=K(C,"Clear",kf((()=>{this.avatarURL=null,this.dispatchEvent(Jv)}))))," or ",$(it(b("videoAvatarButton"),"Video: "),this.useVideoAvatarButton=K(M("videoAvatarButton"),"Use video",kf(t(nw)))),this.avatarPreview=q(Q(256),I(256))),Ov("interface","Interface",this.fontSizeInput=Lv("fontSize","number","Font size: ",U("10"),E(5),x(32),Xv,Lf(t($v))),at(this.drawHearingCheck=Lv("drawHearing","checkbox","Draw hearing range: ",Lf((()=>{this.drawHearing=!this.drawHearing,this.dispatchEvent(iw)}))),this.audioMinInput=Lv("minAudio","number","Min: ",U("1"),E(0),x(100),Xv,e),this.audioMaxInput=Lv("maxAudio","number","Min: ",U("10"),E(0),x(100),Xv,e),this.audioRolloffInput=Lv("rollof","number","Rollof: ",U("1"),E(.1),x(10),T(.1),Xv,e))),Ov("keyboard","Keyboard",this.keyButtonUpInput=i("keyButtonUp","Up: "),this.keyButtonDownInput=i("keyButtonDown","Down: "),this.keyButtonLeftInput=i("keyButtonLeft","Left: "),this.keyButtonRightInput=i("keyButtonRight","Right: "),this.keyButtonEmoteInput=i("keyButtonEmote","Emote: "),this.keyButtonToggleAudioInput=i("keyButtonToggleAudio","Toggle audio: "),this.keyButtonZoomInInput=i("keyButtonZoomIn","Zoom in: "),this.keyButtonZoomOutInput=i("keyButtonZoomOut","Zoom out: ")),Ov("gamepad","Gamepad",$(it(b("gamepads"),"Use gamepad: "),this.gpSelect=av("gamepads","No gamepad",(t=>t.id),(t=>t.id),Lf(t(Kv)))),this.gpAxisLeftRightInput=s("gpAxisLeftRight","Left/Right axis:"),this.gpAxisUpDownInput=s("gpAxisUpDown","Up/Down axis:"),this.gpButtonUpInput=n("gpButtonUp","Up button: "),this.gpButtonDownInput=n("gpButtonDown","Down button: "),this.gpButtonLeftInput=n("gpButtonLeft","Left button: "),this.gpButtonRightInput=n("gpButtonRight","Right button: "),this.gpButtonEmoteInput=n("gpButtonEmote","Emote button: "),this.gpButtonToggleAudioInput=n("gpButtonToggleAudio","Toggle audio button: "),this.gpButtonZoomInInput=n("gpButtonZoomIn","Zoom in: "),this.gpButtonZoomOutInput=n("gpButtonZoomOut","Zoom out: "))],o=[];for(let t=0;t<a.length;++t)o[t]="1fr",a[t].style.gridColumnStart=(t+1).toFixed(0);mv(...o).apply(this.header),this.header.append(...a.map((t=>t.button))),this.content.append(...a.map((t=>t.element)));const r=t=>()=>{for(let e=0;e<a.length;++e)a[e].visible=e===t};for(let t=0;t<a.length;++t)a[t].visible=0===t,a[t].addEventListener("select",r(t));this._inputBinding.addEventListener("inputBindingChanged",(()=>{this.keyButtonUp=this._inputBinding.keyButtonUp,this.keyButtonDown=this._inputBinding.keyButtonDown,this.keyButtonLeft=this._inputBinding.keyButtonLeft,this.keyButtonRight=this._inputBinding.keyButtonRight,this.keyButtonEmote=this._inputBinding.keyButtonEmote,this.keyButtonToggleAudio=this._inputBinding.keyButtonToggleAudio,this.keyButtonZoomOut=this._inputBinding.keyButtonZoomOut,this.keyButtonZoomIn=this._inputBinding.keyButtonZoomIn,this.gpAxisLeftRight=this._inputBinding.gpAxisLeftRight,this.gpAxisUpDown=this._inputBinding.gpAxisUpDown,this.gpButtonUp=this._inputBinding.gpButtonUp,this.gpButtonDown=this._inputBinding.gpButtonDown,this.gpButtonLeft=this._inputBinding.gpButtonLeft,this.gpButtonRight=this._inputBinding.gpButtonRight,this.gpButtonEmote=this._inputBinding.gpButtonEmote,this.gpButtonToggleAudio=this._inputBinding.gpButtonToggleAudio,this.gpButtonZoomOut=this._inputBinding.gpButtonZoomOut,this.gpButtonZoomIn=this._inputBinding.gpButtonZoomIn})),this.gamepads=[],this._avatarG=this.avatarPreview.getContext("2d"),Object.seal(this)}update(){if(Tf(this)){const t=this.currentGamepad;t&&(this._pad?this._pad.update(t):(this._pad=new Mv(t),this._pad.addEventListener("gamepadbuttonup",(t=>{sw.button=t.button,this.dispatchEvent(sw)})),this._pad.addEventListener("gamepadaxismaxed",(t=>{aw.axis=t.axis,this.dispatchEvent(aw)})))),this.user&&this.user.avatar&&(this._avatarG.clearRect(0,0,this.avatarPreview.width,this.avatarPreview.height),this.user.avatar.draw(this._avatarG,this.avatarPreview.width,this.avatarPreview.height,!0))}}get avatarURL(){return 0===this.avatarURLInput.value.length?null:this.avatarURLInput.value}set avatarURL(t){s(t)?(this.avatarURLInput.value=t,rw.apply(this.clearAvatarURLButton)):(this.avatarURLInput.value="",ow.apply(this.clearAvatarURLButton))}setAvatarVideo(t){this.useVideoAvatarButton.innerHTML=null!==t?"Remove video":"Use video"}get inputBinding(){return this._inputBinding.toJSON()}set inputBinding(t){this._inputBinding.copy(t)}get gamepads(){return this.gpSelect.values}set gamepads(t){const e=0===t.length;this.gpSelect.values=t,Gf(this.gpAxisLeftRightInput,e),Gf(this.gpAxisUpDownInput,e),Gf(this.gpButtonUpInput,e),Gf(this.gpButtonDownInput,e),Gf(this.gpButtonLeftInput,e),Gf(this.gpButtonRightInput,e),Gf(this.gpButtonEmoteInput,e),Gf(this.gpButtonToggleAudioInput,e)}get currentGamepadIndex(){return this.gpSelect.selectedIndex}get currentGamepad(){return this.currentGamepadIndex<0?null:navigator.getGamepads()[this.currentGamepadIndex]}get gamepadIndex(){return this.gpSelect.selectedIndex}set gamepadIndex(t){this.gpSelect.selectedIndex=t}get drawHearing(){return this._drawHearing}set drawHearing(t){this._drawHearing=t,this.drawHearingCheck.checked=t}get audioDistanceMin(){const t=parseFloat(this.audioMinInput.value);return l(t)?t:1}set audioDistanceMin(t){l(t)&&t>0&&(this.audioMinInput.value=t.toFixed(3),this.audioDistanceMin>this.audioDistanceMax&&(this.audioDistanceMax=this.audioDistanceMin))}get audioDistanceMax(){const t=parseFloat(this.audioMaxInput.value);return l(t)?t:10}set audioDistanceMax(t){l(t)&&t>0&&(this.audioMaxInput.value=t.toFixed(3),this.audioDistanceMin>this.audioDistanceMax&&(this.audioDistanceMin=this.audioDistanceMax))}get audioRolloff(){const t=parseFloat(this.audioRolloffInput.value);return l(t)?t:1}set audioRolloff(t){l(t)&&t>0&&(this.audioRolloffInput.value=t.toFixed(3))}get fontSize(){const t=parseFloat(this.fontSizeInput.value);return l(t)?t:16}set fontSize(t){l(t)&&t>0&&(this.fontSizeInput.value=t.toFixed(3))}get keyButtonUp(){return this.keyButtonUpInput.value}set keyButtonUp(t){this.keyButtonUpInput.value=t}get keyButtonDown(){return this.keyButtonDownInput.value}set keyButtonDown(t){this.keyButtonDownInput.value=t}get keyButtonLeft(){return this.keyButtonLeftInput.value}set keyButtonLeft(t){this.keyButtonLeftInput.value=t}get keyButtonRight(){return this.keyButtonRightInput.value}set keyButtonRight(t){this.keyButtonRightInput.value=t}get keyButtonEmote(){return this.keyButtonEmoteInput.value}set keyButtonEmote(t){this.keyButtonEmoteInput.value=t}get keyButtonToggleAudio(){return this.keyButtonToggleAudioInput.value}set keyButtonToggleAudio(t){this.keyButtonToggleAudioInput.value=t}get keyButtonZoomOut(){return this.keyButtonZoomOutInput.value}set keyButtonZoomOut(t){this.keyButtonZoomOutInput.value=t}get keyButtonZoomIn(){return this.keyButtonZoomInInput.value}set keyButtonZoomIn(t){this.keyButtonZoomInInput.value=t}getInteger(t){return t&&/^\d+$/.test(t)?parseInt(t,10):-1}get gpAxisLeftRight(){return this.getInteger(this.gpAxisLeftRightInput.value)}set gpAxisLeftRight(t){t&&(this.gpAxisLeftRightInput.value=t.toFixed(0))}get gpAxisUpDown(){return this.getInteger(this.gpAxisUpDownInput.value)}set gpAxisUpDown(t){t&&(this.gpAxisUpDownInput.value=t.toFixed(0))}get gpButtonUp(){return this.getInteger(this.gpButtonUpInput.value)}set gpButtonUp(t){t&&(this.gpButtonUpInput.value=t.toFixed(0))}get gpButtonDown(){return this.getInteger(this.gpButtonDownInput.value)}set gpButtonDown(t){t&&(this.gpButtonDownInput.value=t.toFixed(0))}get gpButtonLeft(){return this.getInteger(this.gpButtonLeftInput.value)}set gpButtonLeft(t){t&&(this.gpButtonLeftInput.value=t.toFixed(0))}get gpButtonRight(){return this.getInteger(this.gpButtonRightInput.value)}set gpButtonRight(t){t&&(this.gpButtonRightInput.value=t.toFixed(0))}get gpButtonEmote(){return this.getInteger(this.gpButtonEmoteInput.value)}set gpButtonEmote(t){t&&(this.gpButtonEmoteInput.value=t.toFixed(0))}get gpButtonToggleAudio(){return this.getInteger(this.gpButtonToggleAudioInput.value)}set gpButtonToggleAudio(t){t&&(this.gpButtonToggleAudioInput.value=t.toFixed(0))}get gpButtonZoomOut(){return this.getInteger(this.gpButtonZoomOutInput.value)}set gpButtonZoomOut(t){t&&(this.gpButtonZoomOutInput.value=t.toFixed(0))}get gpButtonZoomIn(){return this.getInteger(this.gpButtonZoomInInput.value)}set gpButtonZoomIn(t){t&&(this.gpButtonZoomInInput.value=t.toFixed(0))}},dB=new Av("instructions"),gB=new class extends Av{constructor(){super("emoji"),this.header.append(function(...t){return Y("h2",...t)}("Recent"),this.recent=at("(None)"));const t=new Array,e=new Array;let i=null,n=0;function s(t,e){let i=t.value,n=i.indexOf(Us.value);return-1===n&&(n=i.indexOf(Rs.value)),n>=0&&(i=i.substring(0,n)),new En(i+e.value,t.desc+"/"+e.desc)}const a=(t,o,r)=>{const A=h(t)&&t||!h(t)&&t.alts;for(let t of A){let h=null;const A=K(O(t.desc),kf((e=>{i=i&&e.ctrlKey?s(i,t):t,this.preview.innerHTML=`${i.value} - ${i.desc}`,vv.apply(this.confirmButton),h&&(Rf(h),A.innerHTML=t.value+(Tf(h)?"-":"+"))})),t.value);let c=null;r?(A.id="emoji-with-alt-"+n++,c=rt(nt(A,it(b(A.id),t.desc)))):c=ot(A),t.alts&&(h=$(),e.push(h),a(t,h,!0),Qf(h),c.appendChild(h),A.style.width="3em",A.innerHTML+="+"),t.width&&(A.style.width=t.width),t.color&&(A.style.color=t.color),o.appendChild(c)}};for(let t of Object.values(Cf))if(t instanceof Is){const e=tt(),i=at(),n=X(P("javascript:undefined"),O(t.desc),kf((()=>{Rf(i),n.innerHTML=t.value+(Tf(i)?" -":" +")})),t.value+" -");a(t,i,!1),e.appendChild(n),this.content.appendChild(e),this.content.appendChild(i)}this.footer.append(this.confirmButton=K(y("confirm"),"OK",kf((()=>{-1===t.indexOf(i)&&(t.push(i),this.recent.innerHTML="",a(t,this.recent,!1)),this.dispatchEvent(new wv(i)),Qf(this)}))),K(y("cancel"),"Cancel",kf((()=>{fv.apply(this.confirmButton),this.dispatchEvent(Bv),Qf(this)}))),this.preview=ot(dv(1,4,3,1))),fv.apply(this.confirmButton),this.selectAsync=()=>new Promise(((t,i)=>{let n=null,s=null;const a=()=>{this.removeEventListener("emojiSelected",n),this.removeEventListener("emojiCanceled",s),this.removeEventListener("hidden",s)};n=e=>{a();try{t(e.emoji)}catch(t){i(t)}},s=()=>{a(),t(null)},this.addEventListener("emojiSelected",n),this.addEventListener("emojiCanceled",s),this.addEventListener("hidden",s),(()=>{for(let t of e)Qf(t)})(),Uf(this)}))}},pB=new class extends Ef{constructor(){super(120)}start(){const t=e=>{this._timer=requestAnimationFrame(t),this._onTick(e)};this._timer=requestAnimationFrame(t)}stop(){this._timer&&(cancelAnimationFrame(this._timer),super.stop())}},mB=C(!0),fB=C(!1);let vB=!1;function wB(t){return()=>BB(t)}function BB(t){vB||(Qf(hB),Qf(AB),Qf(uB),Qf(lB),Qf(gB),Qf(dB),Uf(t))}async function DB(t){if(!Tf(gB)){vB=!0,mB.apply(cB.optionsButton),mB.apply(cB.instructionsButton),mB.apply(cB.changeDevicesButton),Qf(uB);const e=await gB.selectAsync();e&&t(e),fB.apply(cB.optionsButton),fB.apply(cB.instructionsButton),fB.apply(cB.changeDevicesButton),vB=!1}}async function yB(){await DB((t=>{rB.emote(oB.localUserID,t),cB.setEmojiButton(t)}))}function CB(){oB.audio.setAudioProperties(nB.audioDistanceMin=rB.audioDistanceMin=uB.audioDistanceMin,nB.audioDistanceMax=rB.audioDistanceMax=uB.audioDistanceMax,nB.audioRolloff=uB.audioRolloff,oB.audio.algorithm,nB.transitionSpeed)}function bB(){uB.gamepads=navigator.getGamepads(),uB.gamepadIndex=rB.gamepadIndex}function IB(t){rB.withUser("list user in directory",t,(t=>AB.set(t)))}Object.assign(window,{settings:nB,fetcher:sB,client:oB,game:rB,login:hB,directory:AB,controls:cB,devices:lB,options:uB,emoji:gB,instructions:dB}),window.addEventListener("gamepadconnected",bB),window.addEventListener("gamepaddisconnected",bB),window.addEventListener("resize",(()=>rB.resize())),cB.addEventListener("toggleOptions",wB(uB)),cB.addEventListener("toggleInstructions",wB(dB)),cB.addEventListener("toggleUserDirectory",wB(AB)),cB.addEventListener("changeDevices",wB(lB)),cB.addEventListener("tweet",(()=>{const t="https://twitter.com/intent/tweet?text="+encodeURIComponent(`Join my #TeleParty ${document.location.href}`);window.open(t)})),cB.addEventListener("leave",(async()=>{AB.clear(),await oB.leave()})),cB.addEventListener("selectEmoji",yB),cB.addEventListener("emote",(()=>{rB.emote(oB.localUserID,rB.currentEmoji)})),cB.addEventListener("toggleAudio",(async()=>{await oB.toggleAudioMuted()})),cB.addEventListener("toggleVideo",(async()=>{await oB.toggleVideoMuted()})),cB.addEventListener("zoomChanged",(()=>{nB.zoom=rB.zoom=cB.zoom})),hB.addEventListener("login",(async()=>{await oB.audio.createClip("join",!1,!1,!1,.5,"audio/door-open.mp3"),await oB.audio.createClip("leave",!1,!1,!0,.5,"audio/door-close.mp3"),CB();let t=hB.roomName;hB.roomSelectMode||(t=await async function(t){return await sB.postObjectForText("/Game/Rooms",t)}(t)),await async function(t,e,i){await sB.postObject("/Contacts",{Name:t,Email:e,Room:i})}(nB.userName=hB.userName,nB.email=hB.email,nB.roomName=t);const e=`Calla - chatting in ${t}`,i=`${window.location.pathname}#${t}`;window.history.replaceState({},e,i),await AB.startAsync(t,hB.userName),await oB.join(t),await oB.identify(hB.userName)})),uB.addEventListener("audioPropertiesChanged",CB),uB.addEventListener("selectAvatar",(async()=>{await DB((t=>{nB.avatarEmoji=t.value,oB.setAvatarEmoji(t),rB.me.setAvatarEmoji(t.value),IB(oB.localUserID)}))})),uB.addEventListener("avatarURLChanged",(()=>{nB.avatarURL=uB.avatarURL,oB.setAvatarURL(uB.avatarURL),rB.me.setAvatarImage(uB.avatarURL),IB(oB.localUserID)})),uB.addEventListener("toggleDrawHearing",(()=>{nB.drawHearing=rB.drawHearing=uB.drawHearing})),uB.addEventListener("fontSizeChanged",(()=>{nB.fontSize=rB.fontSize=uB.fontSize})),uB.addEventListener("gamepadChanged",(()=>{nB.gamepadIndex=rB.gamepadIndex=uB.gamepadIndex})),uB.addEventListener("inputBindingChanged",(()=>{nB.inputBinding=rB.inputBinding=uB.inputBinding})),uB.addEventListener("toggleVideo",(async()=>{await oB.toggleVideoMuted()})),lB.addEventListener("audioInputChanged",(async()=>{const t=lB.currentAudioInputDevice;await oB.setAudioInputDevice(t),nB.preferredAudioInputID=oB.preferredAudioInputID})),lB.addEventListener("audioOutputChanged",(async()=>{const t=lB.currentAudioOutputDevice;await oB.setAudioOutputDevice(t),nB.preferredAudioOutputID=oB.preferredAudioOutputID})),lB.addEventListener("videoInputChanged",(async()=>{const t=lB.currentVideoInputDevice;await oB.setVideoInputDevice(t),nB.preferredVideoInputID=oB.preferredVideoInputID})),rB.addEventListener("emojiNeeded",yB),rB.addEventListener("emote",(t=>{oB.emote(t.emoji)})),rB.addEventListener("userJoined",(t=>{IB(t.user.id)})),rB.addEventListener("toggleAudio",(async()=>{await oB.toggleAudioMuted(),nB.preferredAudioInputID=oB.preferredAudioInputID})),rB.addEventListener("toggleVideo",(async()=>{await oB.toggleVideoMuted(),nB.preferredVideoInputID=oB.preferredVideoInputID}));const PB=new En(null,"");rB.addEventListener("gameStarted",(()=>{rB.resize(),Qf(hB),Uf(cB),uB.user=rB.me,cB.enabled=!0,nB.avatarEmoji=nB.avatarEmoji||Dr.random().value,PB.value=nB.avatarEmoji,oB.setAvatarEmoji(PB),rB.me.setAvatarEmoji(nB.avatarEmoji),IB(oB.localUserID)})),rB.addEventListener("userMoved",(t=>{oB.setLocalPose(t.x,0,t.y,0,0,-1,0,1,0)})),rB.addEventListener("gameEnded",(()=>{hB.connected=!1,BB(hB)})),rB.addEventListener("zoomChanged",(()=>{nB.zoom=cB.zoom=rB.zoom})),AB.addEventListener("warpTo",(t=>{rB.visit(t.id)})),oB.addEventListener("conferenceJoined",(async t=>{hB.connected=!0,await rB.startAsync(t.id,hB.userName,t.pose,null,hB.roomName),uB.avatarURL=nB.avatarURL,oB.setAvatarURL(nB.avatarURL),rB.me.setAvatarImage(nB.avatarURL),lB.audioInputDevices=await oB.getAudioInputDevices(!0),lB.audioOutputDevices=await oB.getAudioOutputDevices(!0),lB.videoInputDevices=await oB.getVideoInputDevices(!0),nB.preferredAudioInputID=oB.preferredAudioInputID,nB.preferredAudioOutputID=oB.preferredAudioOutputID,nB.preferredVideoInputID=oB.preferredVideoInputID,lB.currentAudioInputDevice=await oB.getCurrentAudioInputDevice(),lB.currentAudioOutputDevice=await oB.getCurrentAudioOutputDevice(),lB.currentVideoInputDevice=await oB.getCurrentVideoInputDevice();const e=oB.isAudioMuted;rB.muteUserAudio(oB.localUserID,e),cB.audioEnabled=!e;const i=oB.isVideoMuted;rB.muteUserVideo(oB.localUserID,i),cB.videoEnabled=!i})),oB.addEventListener("conferenceLeft",(()=>{rB.end()})),oB.addEventListener("participantJoined",(t=>{oB.audio.playClip("join"),rB.addUser(t.id,t.displayName,t.source.pose)})),oB.addEventListener("participantLeft",(t=>{oB.audio.playClip("leave"),rB.removeUser(t.id),AB.delete(t.id)})),oB.addEventListener("audioAdded",(t=>IB(t.id))),oB.addEventListener("audioRemoved",(t=>IB(t.id))),oB.addEventListener("videoAdded",(t=>{rB.setAvatarVideo(t.id,t.stream),IB(t.id)})),oB.addEventListener("videoRemoved",(t=>{rB.setAvatarVideo(t.id,null),IB(t.id)})),oB.addEventListener("avatarChanged",(t=>{rB.setAvatarURL(t.id,t.url),IB(t.id)})),oB.addEventListener("userNameChanged",(t=>{rB.changeUserName(t.id,t.displayName),IB(t.id)})),oB.addEventListener("audioMuteStatusChanged",(async t=>{t.id===oB.localUserID&&(cB.audioEnabled=!t.muted,lB.currentAudioInputDevice=await oB.getCurrentAudioInputDevice(),nB.preferredAudioInputID=oB.preferredAudioInputID),rB.muteUserAudio(t.id,t.muted)})),oB.addEventListener("videoMuteStatusChanged",(async t=>{t.id===oB.localUserID&&(cB.videoEnabled=!t.muted,t.muted?uB.setAvatarVideo(null):uB.setAvatarVideo(rB.me.avatarVideo.element),lB.currentVideoInputDevice=await oB.getCurrentVideoInputDevice()),rB.muteUserVideo(t.id,t.muted),nB.preferredVideoInputID=oB.preferredVideoInputID}));const MB=new En(null,"");oB.addEventListener("emote",(t=>{MB.value=t.emoji,rB.emote(t.id,MB)}));const xB=new En(null,"");oB.addEventListener("setAvatarEmoji",(t=>{xB.value=t.emoji,rB.setAvatarEmoji(t.id,xB),IB(t.id)})),oB.addEventListener("audioActivity",(t=>{rB.updateAudioActivity(t.id,t.isActive)})),pB.addEventListener("tick",(t=>{oB.update(),uB.update(),AB.update(),rB.update(t.dt)})),uB.drawHearing=rB.drawHearing=nB.drawHearing,uB.audioDistanceMin=rB.audioDistanceMin=nB.audioDistanceMin,uB.audioDistanceMax=rB.audioDistanceMax=nB.audioDistanceMax,uB.audioRolloff=nB.audioRolloff,uB.fontSize=rB.fontSize=nB.fontSize,uB.gamepads=navigator.getGamepads(),uB.gamepadIndex=rB.gamepadIndex=nB.gamepadIndex,uB.inputBinding=rB.inputBinding=nB.inputBinding,cB.zoom=rB.zoom=nB.zoom,rB.cameraZ=rB.targetCameraZ,rB.transitionSpeed=nB.transitionSpeed=.5,hB.userName=nB.userName,hB.roomName=nB.roomName,hB.email=nB.email,cB.enabled=!1,BB(hB),hB.ready=!0,pB.start(),async function(){await Pf(If({fontFamily:"Noto Color Emoji",fontSize:100})),await oB.getMediaPermissions(),await oB.prepare(Ff,"tele.calla.chat","conference.tele.calla.chat"),await oB.connect()}()}();
//# sourceMappingURL=game.min.js.map
